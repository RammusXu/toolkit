<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="It's Rammus Toolkit. A collection of snippets, examples and solutions."><meta name=author content="Rammus Xu"><link href=https://rammusxu.github.io/toolkit/Today-I-Learned/2020/ rel=canonical><link href=../2019/ rel=prev><link href=../2021/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.28"><title>2020 - Rammus Toolkit</title><link rel=stylesheet href=../../assets/stylesheets/main.6543a935.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-E7VTEXK0WQ"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-E7VTEXK0WQ",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-E7VTEXK0WQ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#2020-12-17 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Rammus Toolkit" class="md-header__button md-logo" aria-label="Rammus Toolkit" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16h-2v-1H8v1H6v-1H2v5h20v-5h-4v1m2-8h-3V6c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v4h4v-2h2v2h8v-2h2v2h4v-4c0-1.1-.9-2-2-2m-5 0H9V6h6v2Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Rammus Toolkit </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 2020 </span> </div> </div> </div> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/RammusXu/toolkit title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Rammus Toolkit" class="md-nav__button md-logo" aria-label="Rammus Toolkit" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16h-2v-1H8v1H6v-1H2v5h20v-5h-4v1m2-8h-3V6c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v4h4v-2h2v2h8v-2h2v2h4v-4c0-1.1-.9-2-2-2m-5 0H9V6h6v2Z"/></svg> </a> Rammus Toolkit </label> <div class=md-nav__source> <a href=https://github.com/RammusXu/toolkit title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> 👋 Welcome </span> </a> </li> <li class=md-nav__item> <a href=../../help/ class=md-nav__link> <span class=md-ellipsis> 🌈 Help </span> </a> </li> <li class=md-nav__item> <a href=../../writing-tools/ class=md-nav__link> <span class=md-ellipsis> 寫作工具 </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Today I Learned </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Today I Learned </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../2019/ class=md-nav__link> <span class=md-ellipsis> 2019 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 2020 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 2020 </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#2020-12-17 class=md-nav__link> <span class=md-ellipsis> 2020-12-17 </span> </a> <nav class=md-nav aria-label=2020-12-17> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-brotli-behavior class=md-nav__link> <span class=md-ellipsis> Nginx - brotli behavior </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-12-04 class=md-nav__link> <span class=md-ellipsis> 2020-12-04 </span> </a> <nav class=md-nav aria-label=2020-12-04> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gcp-internal-load-balancer-behavior class=md-nav__link> <span class=md-ellipsis> GCP - Internal Load Balancer Behavior </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-12-03 class=md-nav__link> <span class=md-ellipsis> 2020-12-03 </span> </a> <nav class=md-nav aria-label=2020-12-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cn2-network-go-out-from-china class=md-nav__link> <span class=md-ellipsis> CN2 network - go out from China </span> </a> </li> <li class=md-nav__item> <a href=#curl-get-current-ip-and-geo-location-in-china class=md-nav__link> <span class=md-ellipsis> curl - get current ip and geo location in China </span> </a> </li> <li class=md-nav__item> <a href=#kubernetes-resourcememory-mi-vs-m class=md-nav__link> <span class=md-ellipsis> Kubernetes - resource.memory Mi vs M </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-20 class=md-nav__link> <span class=md-ellipsis> 2020-11-20 </span> </a> <nav class=md-nav aria-label=2020-11-20> <ul class=md-nav__list> <li class=md-nav__item> <a href=#k9s-install-k9s-on-ubuntu-linux class=md-nav__link> <span class=md-ellipsis> k9s - Install k9s on Ubuntu Linux </span> </a> </li> <li class=md-nav__item> <a href=#k3sup class=md-nav__link> <span class=md-ellipsis> k3sup </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-12 class=md-nav__link> <span class=md-ellipsis> 2020-11-12 </span> </a> <nav class=md-nav aria-label=2020-11-12> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kuberntes-pod-injecthijackdebug class=md-nav__link> <span class=md-ellipsis> Kuberntes - Pod inject/hijack/debug </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-10 class=md-nav__link> <span class=md-ellipsis> 2020-11-10 </span> </a> <nav class=md-nav aria-label=2020-11-10> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mongodb-not-master-and-slaveokfalse class=md-nav__link> <span class=md-ellipsis> MongoDB - not master and slaveOk=false </span> </a> </li> <li class=md-nav__item> <a href=#mongodb-could-not-find-host-matching-read-preference-mode-primary-for-set-rs0 class=md-nav__link> <span class=md-ellipsis> MongoDB - Could not find host matching read preference { mode: \"primary\" } for set rs0 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-08 class=md-nav__link> <span class=md-ellipsis> 2020-11-08 </span> </a> <nav class=md-nav aria-label=2020-11-08> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-node-auto-repair class=md-nav__link> <span class=md-ellipsis> GKE - Node auto repair </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-06 class=md-nav__link> <span class=md-ellipsis> 2020-11-06 </span> </a> <nav class=md-nav aria-label=2020-11-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubernetes-cusotmize-a-hostname class=md-nav__link> <span class=md-ellipsis> Kubernetes - Cusotmize a hostname </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-03 class=md-nav__link> <span class=md-ellipsis> 2020-11-03 </span> </a> <nav class=md-nav aria-label=2020-11-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-node-auto-repair-notes class=md-nav__link> <span class=md-ellipsis> GKE node auto repair notes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-30 class=md-nav__link> <span class=md-ellipsis> 2020-10-30 </span> </a> <nav class=md-nav aria-label=2020-10-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sign-a-gcs-object class=md-nav__link> <span class=md-ellipsis> Sign a GCS object </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-22 class=md-nav__link> <span class=md-ellipsis> 2020-10-22 </span> </a> <nav class=md-nav aria-label=2020-10-22> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubernetes-install-godaddy-ssl-certificate-into-secrets-kubernetesiotls class=md-nav__link> <span class=md-ellipsis> Kubernetes - Install godaddy ssl certificate into secrets kubernetes.io/tls </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-19 class=md-nav__link> <span class=md-ellipsis> 2020-10-19 </span> </a> <nav class=md-nav aria-label=2020-10-19> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-cache-static-with-cache-control class=md-nav__link> <span class=md-ellipsis> Nginx - Cache static with Cache-Control </span> </a> </li> <li class=md-nav__item> <a href=#nginx-react-app-serve-spa-htmls class=md-nav__link> <span class=md-ellipsis> Nginx - React app serve SPA htmls </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-16 class=md-nav__link> <span class=md-ellipsis> 2020-10-16 </span> </a> <nav class=md-nav aria-label=2020-10-16> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-automatical-content-type class=md-nav__link> <span class=md-ellipsis> Nginx - automatical content type </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-07 class=md-nav__link> <span class=md-ellipsis> 2020-10-07 </span> </a> <nav class=md-nav aria-label=2020-10-07> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mongodb-install-mongo-cli-on-mac class=md-nav__link> <span class=md-ellipsis> MongoDB - Install mongo cli on Mac </span> </a> </li> <li class=md-nav__item> <a href=#mongodb-dump-and-restore class=md-nav__link> <span class=md-ellipsis> MongoDB - dump and restore </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-30 class=md-nav__link> <span class=md-ellipsis> 2020-09-30 </span> </a> <nav class=md-nav aria-label=2020-09-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-nodes-had-volume-node-affinity-conflict class=md-nav__link> <span class=md-ellipsis> 1 node(s) had volume node affinity conflict. </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-29 class=md-nav__link> <span class=md-ellipsis> 2020-09-29 </span> </a> <nav class=md-nav aria-label=2020-09-29> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-dont-enable-podpreset class=md-nav__link> <span class=md-ellipsis> GKE don’t enable podpreset </span> </a> </li> <li class=md-nav__item> <a href=#kubernetes-taint-and-tolerations class=md-nav__link> <span class=md-ellipsis> kubernetes - Taint and Tolerations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-17 class=md-nav__link> <span class=md-ellipsis> 2020-09-17 </span> </a> <nav class=md-nav aria-label=2020-09-17> <ul class=md-nav__list> <li class=md-nav__item> <a href=#give-a-set-of-files-a-hash-key class=md-nav__link> <span class=md-ellipsis> Give a set of files a hash key </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-10 class=md-nav__link> <span class=md-ellipsis> 2020-09-10 </span> </a> <nav class=md-nav aria-label=2020-09-10> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubernetes-verticalpodautoscaler class=md-nav__link> <span class=md-ellipsis> Kubernetes - VerticalPodAutoscaler </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-09 class=md-nav__link> <span class=md-ellipsis> 2020-09-09 </span> </a> <nav class=md-nav aria-label=2020-09-09> <ul class=md-nav__list> <li class=md-nav__item> <a href=#disable-gke-release-channel class=md-nav__link> <span class=md-ellipsis> Disable GKE release channel </span> </a> </li> <li class=md-nav__item> <a href=#fatal-error-linuxversionh-no-such-file-or-directory class=md-nav__link> <span class=md-ellipsis> fatal error: linux/version.h: No such file or directory </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-06 class=md-nav__link> <span class=md-ellipsis> 2020-09-06 </span> </a> <nav class=md-nav aria-label=2020-09-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#upgrade-buildx-version-on-mac class=md-nav__link> <span class=md-ellipsis> Upgrade buildx version on Mac </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-03 class=md-nav__link> <span class=md-ellipsis> 2020-09-03 </span> </a> <nav class=md-nav aria-label=2020-09-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-change-host-not-found-response-status-and-content class=md-nav__link> <span class=md-ellipsis> Nginx - Change host not found response status and content </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-27 class=md-nav__link> <span class=md-ellipsis> 2020-08-27 </span> </a> <nav class=md-nav aria-label=2020-08-27> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2020-cert-manager-request-a-certificate-with-ingress-in-place class=md-nav__link> <span class=md-ellipsis> 2020 cert-manager request a certificate with ingress in place </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-21 class=md-nav__link> <span class=md-ellipsis> 2020-08-21 </span> </a> <nav class=md-nav aria-label=2020-08-21> <ul class=md-nav__list> <li class=md-nav__item> <a href=#copy-docker-image-to-another-registry class=md-nav__link> <span class=md-ellipsis> Copy docker image to another registry </span> </a> </li> <li class=md-nav__item> <a href=#nginx-cors-with-map-example class=md-nav__link> <span class=md-ellipsis> Nginx - CORS with map example </span> </a> </li> <li class=md-nav__item> <a href=#docker-registry-gitlab-registry class=md-nav__link> <span class=md-ellipsis> Docker Registry - Gitlab Registry </span> </a> </li> <li class=md-nav__item> <a href=#docker-registry-github-registry class=md-nav__link> <span class=md-ellipsis> Docker Registry - Github Registry </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-19 class=md-nav__link> <span class=md-ellipsis> 2020-08-19 </span> </a> <nav class=md-nav aria-label=2020-08-19> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerhub-is-rate-limiting-download-layers class=md-nav__link> <span class=md-ellipsis> Dockerhub is rate limiting download layers </span> </a> </li> <li class=md-nav__item> <a href=#wheres-disk-storage-locationpath-of-gke-emptydir class=md-nav__link> <span class=md-ellipsis> Where's disk storage location(path) of GKE emptyDir </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-12 class=md-nav__link> <span class=md-ellipsis> 2020-08-12 </span> </a> <nav class=md-nav aria-label=2020-08-12> <ul class=md-nav__list> <li class=md-nav__item> <a href=#markdown class=md-nav__link> <span class=md-ellipsis> markdown 文件製作 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-10 class=md-nav__link> <span class=md-ellipsis> 2020-08-10 </span> </a> <nav class=md-nav aria-label=2020-08-10> <ul class=md-nav__list> <li class=md-nav__item> <a href=#istio-on-k3d class=md-nav__link> <span class=md-ellipsis> istio on k3d </span> </a> </li> <li class=md-nav__item> <a href=#configure-k3d-on-mac-zsh class=md-nav__link> <span class=md-ellipsis> Configure k3d on Mac zsh </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-07 class=md-nav__link> <span class=md-ellipsis> 2020-08-07 </span> </a> <nav class=md-nav aria-label=2020-08-07> <ul class=md-nav__list> <li class=md-nav__item> <a href=#testing-websocket class=md-nav__link> <span class=md-ellipsis> Testing websocket </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-06 class=md-nav__link> <span class=md-ellipsis> 2020-08-06 </span> </a> <nav class=md-nav aria-label=2020-08-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gcp-monitoring-response-throughput-is-including-cdn-hit class=md-nav__link> <span class=md-ellipsis> GCP Monitoring - Response Throughput is including CDN hit </span> </a> </li> <li class=md-nav__item> <a href=#nginx-add_header-is-not-working-on-indexhtml class=md-nav__link> <span class=md-ellipsis> Nginx - add_header is not working on index.html </span> </a> </li> <li class=md-nav__item> <a href=#cc-40 class=md-nav__link> <span class=md-ellipsis> CC 4.0 著作權懶人包 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-05 class=md-nav__link> <span class=md-ellipsis> 2020-08-05 </span> </a> <nav class=md-nav aria-label=2020-08-05> <ul class=md-nav__list> <li class=md-nav__item> <a href=#no-more-google-google-alternatives class=md-nav__link> <span class=md-ellipsis> No more google - Google alternatives </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-03 class=md-nav__link> <span class=md-ellipsis> 2020-08-03 </span> </a> <nav class=md-nav aria-label=2020-08-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#service-mesh class=md-nav__link> <span class=md-ellipsis> Service mesh </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-30 class=md-nav__link> <span class=md-ellipsis> 2020-07-30 </span> </a> <nav class=md-nav aria-label=2020-07-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#grouped-bar-chart-online class=md-nav__link> <span class=md-ellipsis> 製作 grouped bar chart online </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-24 class=md-nav__link> <span class=md-ellipsis> 2020-07-24 </span> </a> <nav class=md-nav aria-label=2020-07-24> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ab-load-testing-in-alpine-linux class=md-nav__link> <span class=md-ellipsis> AB load testing in Alpine Linux </span> </a> </li> <li class=md-nav__item> <a href=#to-generate-ecdsa-p-256-certificate-with-step-cli class=md-nav__link> <span class=md-ellipsis> To generate ECDSA P-256 certificate with step-cli </span> </a> </li> <li class=md-nav__item> <a href=#import-ssl-cert-to-kubernetes-secret class=md-nav__link> <span class=md-ellipsis> Import ssl cert to kubernetes secret </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-22 class=md-nav__link> <span class=md-ellipsis> 2020-07-22 </span> </a> <nav class=md-nav aria-label=2020-07-22> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-access-control-allow-origin class=md-nav__link> <span class=md-ellipsis> Nginx - Access-Control-Allow-Origin: * </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-14 class=md-nav__link> <span class=md-ellipsis> 2020-07-14 </span> </a> <nav class=md-nav aria-label=2020-07-14> <ul class=md-nav__list> <li class=md-nav__item> <a href=#is-possible-to-use-ip-address-in-managedcertificate-in-gke class=md-nav__link> <span class=md-ellipsis> Is possible to use ip address in ManagedCertificate in GKE? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-06 class=md-nav__link> <span class=md-ellipsis> 2020-07-06 </span> </a> <nav class=md-nav aria-label=2020-07-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-as-an-forward-proxy-server class=md-nav__link> <span class=md-ellipsis> Nginx - as an forward proxy server </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-30 class=md-nav__link> <span class=md-ellipsis> 2020-06-30 </span> </a> <nav class=md-nav aria-label=2020-06-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#github-api-delete-branch-with-personal-access-token class=md-nav__link> <span class=md-ellipsis> Github API - Delete branch with Personal Access Token </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-24 class=md-nav__link> <span class=md-ellipsis> 2020-06-24 </span> </a> <nav class=md-nav aria-label=2020-06-24> <ul class=md-nav__list> <li class=md-nav__item> <a href=#linux-get-geo-infomation-in-curl class=md-nav__link> <span class=md-ellipsis> Linux - Get Geo infomation in curl </span> </a> </li> <li class=md-nav__item> <a href=#nginx-ingress-will-use-default-fake-certificate class=md-nav__link> <span class=md-ellipsis> Nginx Ingress will use default fake certificate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-23 class=md-nav__link> <span class=md-ellipsis> 2020-06-23 </span> </a> <nav class=md-nav aria-label=2020-06-23> <ul class=md-nav__list> <li class=md-nav__item> <a href=#intall-google-cloud-sdk-in-docker-image class=md-nav__link> <span class=md-ellipsis> Intall Google Cloud SDK in docker image </span> </a> </li> <li class=md-nav__item> <a href=#linux-get-external-ip-in-curl-cli class=md-nav__link> <span class=md-ellipsis> Linux - Get external ip in curl cli </span> </a> </li> <li class=md-nav__item> <a href=#kubernetes-gkegcp-proxy-to-internal-load-balancer class=md-nav__link> <span class=md-ellipsis> Kubernetes - GKE/GCP proxy to internal load balancer </span> </a> </li> <li class=md-nav__item> <a href=#gke-internal-load-balancer-dont-need-extra-firewalls class=md-nav__link> <span class=md-ellipsis> GKE - Internal Load Balancer don't need extra firewalls </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-18 class=md-nav__link> <span class=md-ellipsis> 2020-06-18 </span> </a> <nav class=md-nav aria-label=2020-06-18> <ul class=md-nav__list> <li class=md-nav__item> <a href=#linux-adduser-without-prompts class=md-nav__link> <span class=md-ellipsis> Linux - adduser without prompts </span> </a> </li> <li class=md-nav__item> <a href=#linux-add-sudoer-group-to-user class=md-nav__link> <span class=md-ellipsis> Linux - Add sudoer group to user </span> </a> </li> <li class=md-nav__item> <a href=#github-action-runner-fix-gifsicle-command-failed class=md-nav__link> <span class=md-ellipsis> Github Action Runner - Fix gifsicle: Command failed </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-11 class=md-nav__link> <span class=md-ellipsis> 2020-06-11 </span> </a> <nav class=md-nav aria-label=2020-06-11> <ul class=md-nav__list> <li class=md-nav__item> <a href=#failed-to-determine-a-valid-solver-configuration-for-the-set-of-domains-on-the-order-no-configured-challenge-solvers-can-be-used-for-this-challenge class=md-nav__link> <span class=md-ellipsis> Failed to determine a valid solver configuration for the set of domains on the Order: no configured challenge solvers can be used for this challenge </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-05 class=md-nav__link> <span class=md-ellipsis> 2020-06-05 </span> </a> <nav class=md-nav aria-label=2020-06-05> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gsutil-verify-a-google-service-account-with-docker-and-a-environment-variable class=md-nav__link> <span class=md-ellipsis> gsutil - Verify a google service account with docker and a environment variable </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-02 class=md-nav__link> <span class=md-ellipsis> 2020-06-02 </span> </a> <nav class=md-nav aria-label=2020-06-02> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubernetes-get-client-ip-from-google-network-load-balancer class=md-nav__link> <span class=md-ellipsis> Kubernetes - Get client ip from Google Network Load Balancer </span> </a> </li> <li class=md-nav__item> <a href=#direct-server-return-dsr class=md-nav__link> <span class=md-ellipsis> Direct server return (DSR) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-26 class=md-nav__link> <span class=md-ellipsis> 2020-05-26 </span> </a> <nav class=md-nav aria-label=2020-05-26> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-get-request-connection-id class=md-nav__link> <span class=md-ellipsis> Nginx - get request connection id </span> </a> </li> <li class=md-nav__item> <a href=#nginx-proxy_set_header-will-diable-persistent-connection class=md-nav__link> <span class=md-ellipsis> Nginx - proxy_set_header will diable persistent connection </span> </a> </li> <li class=md-nav__item> <a href=#html-expires-and-cache-control class=md-nav__link> <span class=md-ellipsis> HTML - Expires and Cache-Control </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-22 class=md-nav__link> <span class=md-ellipsis> 2020-05-22 </span> </a> <nav class=md-nav aria-label=2020-05-22> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-use-http-header-as-variable class=md-nav__link> <span class=md-ellipsis> Nginx - use http header as variable </span> </a> </li> <li class=md-nav__item> <a href=#nginx-ssl_do_handshake-failed-ssl-error1408f10bssl-routinesssl3_get_recordwrong-version-number-while-ssl-handshaking-to-upstream class=md-nav__link> <span class=md-ellipsis> Nginx - SSL_do_handshake() failed (SSL: error:1408F10B:SSL routines:SSL3_GET_RECORD:wrong version number) while SSL handshaking to upstream </span> </a> </li> <li class=md-nav__item> <a href=#nginx-server-listen-80-default-deferred class=md-nav__link> <span class=md-ellipsis> Nginx - server listen 80 default deferred </span> </a> </li> <li class=md-nav__item> <a href=#nginx-print-cache-status-log class=md-nav__link> <span class=md-ellipsis> Nginx - Print cache status log </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-20 class=md-nav__link> <span class=md-ellipsis> 2020-05-20 </span> </a> <nav class=md-nav aria-label=2020-05-20> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-proxy_pass-cache-prority class=md-nav__link> <span class=md-ellipsis> Nginx - proxy_pass cache prority </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-13 class=md-nav__link> <span class=md-ellipsis> 2020-05-13 </span> </a> <nav class=md-nav aria-label=2020-05-13> <ul class=md-nav__list> <li class=md-nav__item> <a href=#probot-update-file-and-create-pull-request class=md-nav__link> <span class=md-ellipsis> Probot - update file and create pull request </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-05 class=md-nav__link> <span class=md-ellipsis> 2020-05-05 </span> </a> <nav class=md-nav aria-label=2020-05-05> <ul class=md-nav__list> <li class=md-nav__item> <a href=#got-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket-at-unixvarrundockersock-get-http2fvar2frun2fdockersockv140containersjson-dial-unix-varrundockersock-connect-permission-denied class=md-nav__link> <span class=md-ellipsis> Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.40/containers/json: dial unix /var/run/docker.sock: connect: permission denied </span> </a> </li> <li class=md-nav__item> <a href=#install-docker-on-debian-linux class=md-nav__link> <span class=md-ellipsis> Install docker on Debian Linux </span> </a> </li> <li class=md-nav__item> <a href=#ab-benchmark-is-using-1-core class=md-nav__link> <span class=md-ellipsis> ab benchmark is using 1 core </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-04 class=md-nav__link> <span class=md-ellipsis> 2020-05-04 </span> </a> <nav class=md-nav aria-label=2020-05-04> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pemission-denied-when-volumemounts-configmap-as-file class=md-nav__link> <span class=md-ellipsis> Pemission denied when volumeMounts configmap as file </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-04-30 class=md-nav__link> <span class=md-ellipsis> 2020-04-30 </span> </a> <nav class=md-nav aria-label=2020-04-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#generate-an-unique-sha-from-multiple-file-in-mac class=md-nav__link> <span class=md-ellipsis> Generate an unique sha from multiple file in Mac </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-04-24 class=md-nav__link> <span class=md-ellipsis> 2020-04-24 </span> </a> <nav class=md-nav aria-label=2020-04-24> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-could-not-find-named-location class=md-nav__link> <span class=md-ellipsis> Nginx: could not find named location </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-04-17 class=md-nav__link> <span class=md-ellipsis> 2020-04-17 </span> </a> <nav class=md-nav aria-label=2020-04-17> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-ingress-with-managed-certificates class=md-nav__link> <span class=md-ellipsis> GKE ingress with managed-certificates </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-04-07 class=md-nav__link> <span class=md-ellipsis> 2020-04-07 </span> </a> <nav class=md-nav aria-label=2020-04-07> <ul class=md-nav__list> <li class=md-nav__item> <a href=#test-a-website-speed class=md-nav__link> <span class=md-ellipsis> Test a website speed </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-14 class=md-nav__link> <span class=md-ellipsis> 2020-03-14 </span> </a> <nav class=md-nav aria-label=2020-03-14> <ul class=md-nav__list> <li class=md-nav__item> <a href=#find-other-lan-users-ip class=md-nav__link> <span class=md-ellipsis> Find other LAN user's IP </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-13 class=md-nav__link> <span class=md-ellipsis> 2020-03-13 </span> </a> <nav class=md-nav aria-label=2020-03-13> <ul class=md-nav__list> <li class=md-nav__item> <a href=#httpswww17cecom class=md-nav__link> <span class=md-ellipsis> 中國的測速網站 https://www.17ce.com/ </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-12 class=md-nav__link> <span class=md-ellipsis> 2020-03-12 </span> </a> <nav class=md-nav aria-label=2020-03-12> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dnsmasq-unsupported-option-check-that-dnsmasq-was-compiled-with-dhcptftpdnssecdbus-support class=md-nav__link> <span class=md-ellipsis> dnsmasq: unsupported option (check that dnsmasq was compiled with DHCP/TFTP/DNSSEC/DBus support) </span> </a> </li> <li class=md-nav__item> <a href=#parsing-dnssec-anchors-in-shell-scriptbash class=md-nav__link> <span class=md-ellipsis> Parsing dnssec anchors in shell script(bash) </span> </a> </li> <li class=md-nav__item> <a href=#commands-of-testing-domain class=md-nav__link> <span class=md-ellipsis> Commands of testing domain </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-11 class=md-nav__link> <span class=md-ellipsis> 2020-03-11 </span> </a> <nav class=md-nav aria-label=2020-03-11> <ul class=md-nav__list> <li class=md-nav__item> <a href=#check-multiple-variables-are-not-none-in-python class=md-nav__link> <span class=md-ellipsis> Check multiple variables are not None in Python </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-10 class=md-nav__link> <span class=md-ellipsis> 2020-03-10 </span> </a> <nav class=md-nav aria-label=2020-03-10> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gcs-roles class=md-nav__link> <span class=md-ellipsis> GCS roles </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-09 class=md-nav__link> <span class=md-ellipsis> 2020-03-09 </span> </a> <nav class=md-nav aria-label=2020-03-09> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-nth-line-of-stdout-on-linux class=md-nav__link> <span class=md-ellipsis> Get nth line of stdout on linux </span> </a> </li> <li class=md-nav__item> <a href=#sort-gcs-google-cloud-storage-objects-by-date class=md-nav__link> <span class=md-ellipsis> Sort GCS (google cloud storage) objects by date </span> </a> </li> <li class=md-nav__item> <a href=#measuring-kubernetes-dns class=md-nav__link> <span class=md-ellipsis> Measuring kubernetes dns </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-06 class=md-nav__link> <span class=md-ellipsis> 2020-03-06 </span> </a> <nav class=md-nav aria-label=2020-03-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-does-udp-request-receiving-responses class=md-nav__link> <span class=md-ellipsis> How does UDP request receiving responses. </span> </a> </li> <li class=md-nav__item> <a href=#weave-scope-kubernetes class=md-nav__link> <span class=md-ellipsis> Weave Scope - 監控 kubernetes 的工具 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-05 class=md-nav__link> <span class=md-ellipsis> 2020-03-05 </span> </a> <nav class=md-nav aria-label=2020-03-05> <ul class=md-nav__list> <li class=md-nav__item> <a href=#try-to-resolve-a-domain-in-kubernetes class=md-nav__link> <span class=md-ellipsis> Try to resolve a domain in kubernetes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-04 class=md-nav__link> <span class=md-ellipsis> 2020-03-04 </span> </a> <nav class=md-nav aria-label=2020-03-04> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-perform-ddos-test-as-a-pentester class=md-nav__link> <span class=md-ellipsis> how-to-perform-ddos-test-as-a-pentester </span> </a> </li> <li class=md-nav__item> <a href=#install-netstress-on-kali-linux class=md-nav__link> <span class=md-ellipsis> Install netstress on kali linux </span> </a> </li> <li class=md-nav__item> <a href=#run-kali-linux-on-kubernetes class=md-nav__link> <span class=md-ellipsis> Run kali linux on Kubernetes </span> </a> </li> <li class=md-nav__item> <a href=#gke-nodelocal-dnscache class=md-nav__link> <span class=md-ellipsis> GKE NodeLocal DNSCache </span> </a> </li> <li class=md-nav__item> <a href=#install-dnsperf-on-alpine class=md-nav__link> <span class=md-ellipsis> Install dnsperf on alpine </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-03 class=md-nav__link> <span class=md-ellipsis> 2020-03-03 </span> </a> <nav class=md-nav aria-label=2020-03-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#open-google-chrome-browser-in-mac-terminal class=md-nav__link> <span class=md-ellipsis> Open Google Chrome browser in Mac terminal </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-02 class=md-nav__link> <span class=md-ellipsis> 2020-03-02 </span> </a> <nav class=md-nav aria-label=2020-03-02> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-temporary-pod-to-debug-and-kill-itself-after-an-hour class=md-nav__link> <span class=md-ellipsis> Create a temporary pod to debug and kill itself after an hour </span> </a> </li> <li class=md-nav__item> <a href=#dns-load-testing-in-alpine class=md-nav__link> <span class=md-ellipsis> DNS load testing in Alpine </span> </a> </li> <li class=md-nav__item> <a href=#gke-v113x-uses-kube-dns-rather-than-core-dns class=md-nav__link> <span class=md-ellipsis> GKE v1.13.x uses kube-dns rather than core-dns. </span> </a> </li> <li class=md-nav__item> <a href=#install-gcc-compiler-in-alpine class=md-nav__link> <span class=md-ellipsis> Install gcc compiler in Alpine </span> </a> </li> <li class=md-nav__item> <a href=#echo-n class=md-nav__link> <span class=md-ellipsis> echo -n </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-27 class=md-nav__link> <span class=md-ellipsis> 2020-02-27 </span> </a> <nav class=md-nav aria-label=2020-02-27> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-github-user-info class=md-nav__link> <span class=md-ellipsis> Get GitHub user info </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-26 class=md-nav__link> <span class=md-ellipsis> 2020-02-26 </span> </a> <nav class=md-nav aria-label=2020-02-26> <ul class=md-nav__list> <li class=md-nav__item> <a href=#use-cloudflare-warp-as-vpn-on-macpc class=md-nav__link> <span class=md-ellipsis> Use CloudFlare WARP as VPN on Mac/PC </span> </a> </li> <li class=md-nav__item> <a href=#refreshclean-cdn-cache-on-tencent-cloud class=md-nav__link> <span class=md-ellipsis> Refresh/Clean CDN cache on Tencent Cloud </span> </a> </li> <li class=md-nav__item> <a href=#you-might-have-to-verify-by-doing-a-request-from-a-location-with-a-cloudflare-edge class=md-nav__link> <span class=md-ellipsis> You might have to verify by doing a request from a location with a Cloudflare edge </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-24 class=md-nav__link> <span class=md-ellipsis> 2020-02-24 </span> </a> <nav class=md-nav aria-label=2020-02-24> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cloudflare-worker-cant-resovlefind-domain class=md-nav__link> <span class=md-ellipsis> CloudFlare worker - Can't resovle/find domain </span> </a> </li> <li class=md-nav__item> <a href=#cloudflare-worker-how-to-handle-spa class=md-nav__link> <span class=md-ellipsis> CloudFlare worker - how to handle SPA </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-21 class=md-nav__link> <span class=md-ellipsis> 2020-02-21 </span> </a> <nav class=md-nav aria-label=2020-02-21> <ul class=md-nav__list> <li class=md-nav__item> <a href=#multiple-static-ip-in-a-load-balancer class=md-nav__link> <span class=md-ellipsis> Multiple static IP in a load balancer </span> </a> </li> <li class=md-nav__item> <a href=#testing-hpa-high-memory class=md-nav__link> <span class=md-ellipsis> Testing HPA high memory </span> </a> </li> <li class=md-nav__item> <a href=#about-kubernetes-hpahorizontal-pod-autoscaler class=md-nav__link> <span class=md-ellipsis> About Kubernetes HPA(Horizontal Pod Autoscaler) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-19 class=md-nav__link> <span class=md-ellipsis> 2020-02-19 </span> </a> <nav class=md-nav aria-label=2020-02-19> <ul class=md-nav__list> <li class=md-nav__item> <a href=#use-environment-from-parent-process-in-nginxopenresty class=md-nav__link> <span class=md-ellipsis> Use environment from parent process in Nginx(OpenResty) </span> </a> </li> <li class=md-nav__item> <a href=#cannot-create-an-external-load-balancer-with-mix-protocols class=md-nav__link> <span class=md-ellipsis> cannot create an external load balancer with mix protocols </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-18 class=md-nav__link> <span class=md-ellipsis> 2020-02-18 </span> </a> <nav class=md-nav aria-label=2020-02-18> <ul class=md-nav__list> <li class=md-nav__item> <a href=#try-docker-compose-health-check class=md-nav__link> <span class=md-ellipsis> Try docker-compose health check </span> </a> </li> <li class=md-nav__item> <a href=#docker-docker-credential-osxkeychain-ci-db class=md-nav__link> <span class=md-ellipsis> Docker 更新後跳出 docker-credential-osxkeychain 想使用鑰匙圈 ci-db </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-cc-by-sa-license class=md-nav__link> <span class=md-ellipsis> How to use cc-by-sa license </span> </a> </li> <li class=md-nav__item> <a href=#print-a-colorful-text-in-terminal class=md-nav__link> <span class=md-ellipsis> Print a colorful text in terminal </span> </a> </li> <li class=md-nav__item> <a href=#render-a-chart-inside-markdown-with-canvasjs class=md-nav__link> <span class=md-ellipsis> Render a chart inside markdown with canvasjs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-15 class=md-nav__link> <span class=md-ellipsis> 2020-02-15 </span> </a> <nav class=md-nav aria-label=2020-02-15> <ul class=md-nav__list> <li class=md-nav__item> <a href=#restart-a-kubernetes-resource-without-down-time-and-using-same-configyaml class=md-nav__link> <span class=md-ellipsis> Restart a kubernetes resource without down time and using same config(yaml) </span> </a> </li> <li class=md-nav__item> <a href=#run-commnad-withoutignoring-output class=md-nav__link> <span class=md-ellipsis> Run commnad without(ignoring) output </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-13 class=md-nav__link> <span class=md-ellipsis> 2020-02-13 </span> </a> <nav class=md-nav aria-label=2020-02-13> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker-compose class=md-nav__link> <span class=md-ellipsis> 在 docker-compose 中的容器互相溝通 </span> </a> </li> <li class=md-nav__item> <a href=#mkdocs-minify-html-got-error class=md-nav__link> <span class=md-ellipsis> mkdocs minify html got error </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../2021/ class=md-nav__link> <span class=md-ellipsis> 2021 </span> </a> </li> <li class=md-nav__item> <a href=../2022/ class=md-nav__link> <span class=md-ellipsis> 2022 </span> </a> </li> <li class=md-nav__item> <a href=../2023/ class=md-nav__link> <span class=md-ellipsis> 2023 </span> </a> </li> <li class=md-nav__item> <a href=../2024/ class=md-nav__link> <span class=md-ellipsis> 2024 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Snippets </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Snippets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../snippets/alpine-linux/ class=md-nav__link> <span class=md-ellipsis> Alpine linux </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/aws/ class=md-nav__link> <span class=md-ellipsis> AWS </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/bash/ class=md-nav__link> <span class=md-ellipsis> Bash </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/docker-compose/ class=md-nav__link> <span class=md-ellipsis> Docker Compose </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/docker/ class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/dockerfiles/ class=md-nav__link> <span class=md-ellipsis> Dockerfiles </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/elasticsearch/ class=md-nav__link> <span class=md-ellipsis> Elasticsearch </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/fun-markdown/ class=md-nav__link> <span class=md-ellipsis> Fun markdown </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/gcp/ class=md-nav__link> <span class=md-ellipsis> GCP </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/git/ class=md-nav__link> <span class=md-ellipsis> Git </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/github-action/ class=md-nav__link> <span class=md-ellipsis> Github Action </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/gitlabci/ class=md-nav__link> <span class=md-ellipsis> Gitlab CI </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/http/ class=md-nav__link> <span class=md-ellipsis> http </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/jenkins/ class=md-nav__link> <span class=md-ellipsis> Jenkins </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/kubernetes/ class=md-nav__link> <span class=md-ellipsis> Kubernetes </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/linux/ class=md-nav__link> <span class=md-ellipsis> Linux commands </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/lua/ class=md-nav__link> <span class=md-ellipsis> Lua </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/mac-setup/ class=md-nav__link> <span class=md-ellipsis> Mac Setup </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/make/ class=md-nav__link> <span class=md-ellipsis> Make </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/mongo/ class=md-nav__link> <span class=md-ellipsis> Mongo </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/nginx/ class=md-nav__link> <span class=md-ellipsis> Nginx </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/prometheus/ class=md-nav__link> <span class=md-ellipsis> Prometheus </span> </a> </li> <li class=md-nav__item> <a href=../../snippets/visual-studio/ class=md-nav__link> <span class=md-ellipsis> Visual Studio </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#2020-12-17 class=md-nav__link> <span class=md-ellipsis> 2020-12-17 </span> </a> <nav class=md-nav aria-label=2020-12-17> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-brotli-behavior class=md-nav__link> <span class=md-ellipsis> Nginx - brotli behavior </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-12-04 class=md-nav__link> <span class=md-ellipsis> 2020-12-04 </span> </a> <nav class=md-nav aria-label=2020-12-04> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gcp-internal-load-balancer-behavior class=md-nav__link> <span class=md-ellipsis> GCP - Internal Load Balancer Behavior </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-12-03 class=md-nav__link> <span class=md-ellipsis> 2020-12-03 </span> </a> <nav class=md-nav aria-label=2020-12-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cn2-network-go-out-from-china class=md-nav__link> <span class=md-ellipsis> CN2 network - go out from China </span> </a> </li> <li class=md-nav__item> <a href=#curl-get-current-ip-and-geo-location-in-china class=md-nav__link> <span class=md-ellipsis> curl - get current ip and geo location in China </span> </a> </li> <li class=md-nav__item> <a href=#kubernetes-resourcememory-mi-vs-m class=md-nav__link> <span class=md-ellipsis> Kubernetes - resource.memory Mi vs M </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-20 class=md-nav__link> <span class=md-ellipsis> 2020-11-20 </span> </a> <nav class=md-nav aria-label=2020-11-20> <ul class=md-nav__list> <li class=md-nav__item> <a href=#k9s-install-k9s-on-ubuntu-linux class=md-nav__link> <span class=md-ellipsis> k9s - Install k9s on Ubuntu Linux </span> </a> </li> <li class=md-nav__item> <a href=#k3sup class=md-nav__link> <span class=md-ellipsis> k3sup </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-12 class=md-nav__link> <span class=md-ellipsis> 2020-11-12 </span> </a> <nav class=md-nav aria-label=2020-11-12> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kuberntes-pod-injecthijackdebug class=md-nav__link> <span class=md-ellipsis> Kuberntes - Pod inject/hijack/debug </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-10 class=md-nav__link> <span class=md-ellipsis> 2020-11-10 </span> </a> <nav class=md-nav aria-label=2020-11-10> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mongodb-not-master-and-slaveokfalse class=md-nav__link> <span class=md-ellipsis> MongoDB - not master and slaveOk=false </span> </a> </li> <li class=md-nav__item> <a href=#mongodb-could-not-find-host-matching-read-preference-mode-primary-for-set-rs0 class=md-nav__link> <span class=md-ellipsis> MongoDB - Could not find host matching read preference { mode: \"primary\" } for set rs0 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-08 class=md-nav__link> <span class=md-ellipsis> 2020-11-08 </span> </a> <nav class=md-nav aria-label=2020-11-08> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-node-auto-repair class=md-nav__link> <span class=md-ellipsis> GKE - Node auto repair </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-06 class=md-nav__link> <span class=md-ellipsis> 2020-11-06 </span> </a> <nav class=md-nav aria-label=2020-11-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubernetes-cusotmize-a-hostname class=md-nav__link> <span class=md-ellipsis> Kubernetes - Cusotmize a hostname </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-11-03 class=md-nav__link> <span class=md-ellipsis> 2020-11-03 </span> </a> <nav class=md-nav aria-label=2020-11-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-node-auto-repair-notes class=md-nav__link> <span class=md-ellipsis> GKE node auto repair notes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-30 class=md-nav__link> <span class=md-ellipsis> 2020-10-30 </span> </a> <nav class=md-nav aria-label=2020-10-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sign-a-gcs-object class=md-nav__link> <span class=md-ellipsis> Sign a GCS object </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-22 class=md-nav__link> <span class=md-ellipsis> 2020-10-22 </span> </a> <nav class=md-nav aria-label=2020-10-22> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubernetes-install-godaddy-ssl-certificate-into-secrets-kubernetesiotls class=md-nav__link> <span class=md-ellipsis> Kubernetes - Install godaddy ssl certificate into secrets kubernetes.io/tls </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-19 class=md-nav__link> <span class=md-ellipsis> 2020-10-19 </span> </a> <nav class=md-nav aria-label=2020-10-19> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-cache-static-with-cache-control class=md-nav__link> <span class=md-ellipsis> Nginx - Cache static with Cache-Control </span> </a> </li> <li class=md-nav__item> <a href=#nginx-react-app-serve-spa-htmls class=md-nav__link> <span class=md-ellipsis> Nginx - React app serve SPA htmls </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-16 class=md-nav__link> <span class=md-ellipsis> 2020-10-16 </span> </a> <nav class=md-nav aria-label=2020-10-16> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-automatical-content-type class=md-nav__link> <span class=md-ellipsis> Nginx - automatical content type </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-10-07 class=md-nav__link> <span class=md-ellipsis> 2020-10-07 </span> </a> <nav class=md-nav aria-label=2020-10-07> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mongodb-install-mongo-cli-on-mac class=md-nav__link> <span class=md-ellipsis> MongoDB - Install mongo cli on Mac </span> </a> </li> <li class=md-nav__item> <a href=#mongodb-dump-and-restore class=md-nav__link> <span class=md-ellipsis> MongoDB - dump and restore </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-30 class=md-nav__link> <span class=md-ellipsis> 2020-09-30 </span> </a> <nav class=md-nav aria-label=2020-09-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-nodes-had-volume-node-affinity-conflict class=md-nav__link> <span class=md-ellipsis> 1 node(s) had volume node affinity conflict. </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-29 class=md-nav__link> <span class=md-ellipsis> 2020-09-29 </span> </a> <nav class=md-nav aria-label=2020-09-29> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-dont-enable-podpreset class=md-nav__link> <span class=md-ellipsis> GKE don’t enable podpreset </span> </a> </li> <li class=md-nav__item> <a href=#kubernetes-taint-and-tolerations class=md-nav__link> <span class=md-ellipsis> kubernetes - Taint and Tolerations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-17 class=md-nav__link> <span class=md-ellipsis> 2020-09-17 </span> </a> <nav class=md-nav aria-label=2020-09-17> <ul class=md-nav__list> <li class=md-nav__item> <a href=#give-a-set-of-files-a-hash-key class=md-nav__link> <span class=md-ellipsis> Give a set of files a hash key </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-10 class=md-nav__link> <span class=md-ellipsis> 2020-09-10 </span> </a> <nav class=md-nav aria-label=2020-09-10> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubernetes-verticalpodautoscaler class=md-nav__link> <span class=md-ellipsis> Kubernetes - VerticalPodAutoscaler </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-09 class=md-nav__link> <span class=md-ellipsis> 2020-09-09 </span> </a> <nav class=md-nav aria-label=2020-09-09> <ul class=md-nav__list> <li class=md-nav__item> <a href=#disable-gke-release-channel class=md-nav__link> <span class=md-ellipsis> Disable GKE release channel </span> </a> </li> <li class=md-nav__item> <a href=#fatal-error-linuxversionh-no-such-file-or-directory class=md-nav__link> <span class=md-ellipsis> fatal error: linux/version.h: No such file or directory </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-06 class=md-nav__link> <span class=md-ellipsis> 2020-09-06 </span> </a> <nav class=md-nav aria-label=2020-09-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#upgrade-buildx-version-on-mac class=md-nav__link> <span class=md-ellipsis> Upgrade buildx version on Mac </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-09-03 class=md-nav__link> <span class=md-ellipsis> 2020-09-03 </span> </a> <nav class=md-nav aria-label=2020-09-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-change-host-not-found-response-status-and-content class=md-nav__link> <span class=md-ellipsis> Nginx - Change host not found response status and content </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-27 class=md-nav__link> <span class=md-ellipsis> 2020-08-27 </span> </a> <nav class=md-nav aria-label=2020-08-27> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2020-cert-manager-request-a-certificate-with-ingress-in-place class=md-nav__link> <span class=md-ellipsis> 2020 cert-manager request a certificate with ingress in place </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-21 class=md-nav__link> <span class=md-ellipsis> 2020-08-21 </span> </a> <nav class=md-nav aria-label=2020-08-21> <ul class=md-nav__list> <li class=md-nav__item> <a href=#copy-docker-image-to-another-registry class=md-nav__link> <span class=md-ellipsis> Copy docker image to another registry </span> </a> </li> <li class=md-nav__item> <a href=#nginx-cors-with-map-example class=md-nav__link> <span class=md-ellipsis> Nginx - CORS with map example </span> </a> </li> <li class=md-nav__item> <a href=#docker-registry-gitlab-registry class=md-nav__link> <span class=md-ellipsis> Docker Registry - Gitlab Registry </span> </a> </li> <li class=md-nav__item> <a href=#docker-registry-github-registry class=md-nav__link> <span class=md-ellipsis> Docker Registry - Github Registry </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-19 class=md-nav__link> <span class=md-ellipsis> 2020-08-19 </span> </a> <nav class=md-nav aria-label=2020-08-19> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerhub-is-rate-limiting-download-layers class=md-nav__link> <span class=md-ellipsis> Dockerhub is rate limiting download layers </span> </a> </li> <li class=md-nav__item> <a href=#wheres-disk-storage-locationpath-of-gke-emptydir class=md-nav__link> <span class=md-ellipsis> Where's disk storage location(path) of GKE emptyDir </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-12 class=md-nav__link> <span class=md-ellipsis> 2020-08-12 </span> </a> <nav class=md-nav aria-label=2020-08-12> <ul class=md-nav__list> <li class=md-nav__item> <a href=#markdown class=md-nav__link> <span class=md-ellipsis> markdown 文件製作 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-10 class=md-nav__link> <span class=md-ellipsis> 2020-08-10 </span> </a> <nav class=md-nav aria-label=2020-08-10> <ul class=md-nav__list> <li class=md-nav__item> <a href=#istio-on-k3d class=md-nav__link> <span class=md-ellipsis> istio on k3d </span> </a> </li> <li class=md-nav__item> <a href=#configure-k3d-on-mac-zsh class=md-nav__link> <span class=md-ellipsis> Configure k3d on Mac zsh </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-07 class=md-nav__link> <span class=md-ellipsis> 2020-08-07 </span> </a> <nav class=md-nav aria-label=2020-08-07> <ul class=md-nav__list> <li class=md-nav__item> <a href=#testing-websocket class=md-nav__link> <span class=md-ellipsis> Testing websocket </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-06 class=md-nav__link> <span class=md-ellipsis> 2020-08-06 </span> </a> <nav class=md-nav aria-label=2020-08-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gcp-monitoring-response-throughput-is-including-cdn-hit class=md-nav__link> <span class=md-ellipsis> GCP Monitoring - Response Throughput is including CDN hit </span> </a> </li> <li class=md-nav__item> <a href=#nginx-add_header-is-not-working-on-indexhtml class=md-nav__link> <span class=md-ellipsis> Nginx - add_header is not working on index.html </span> </a> </li> <li class=md-nav__item> <a href=#cc-40 class=md-nav__link> <span class=md-ellipsis> CC 4.0 著作權懶人包 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-05 class=md-nav__link> <span class=md-ellipsis> 2020-08-05 </span> </a> <nav class=md-nav aria-label=2020-08-05> <ul class=md-nav__list> <li class=md-nav__item> <a href=#no-more-google-google-alternatives class=md-nav__link> <span class=md-ellipsis> No more google - Google alternatives </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-08-03 class=md-nav__link> <span class=md-ellipsis> 2020-08-03 </span> </a> <nav class=md-nav aria-label=2020-08-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#service-mesh class=md-nav__link> <span class=md-ellipsis> Service mesh </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-30 class=md-nav__link> <span class=md-ellipsis> 2020-07-30 </span> </a> <nav class=md-nav aria-label=2020-07-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#grouped-bar-chart-online class=md-nav__link> <span class=md-ellipsis> 製作 grouped bar chart online </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-24 class=md-nav__link> <span class=md-ellipsis> 2020-07-24 </span> </a> <nav class=md-nav aria-label=2020-07-24> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ab-load-testing-in-alpine-linux class=md-nav__link> <span class=md-ellipsis> AB load testing in Alpine Linux </span> </a> </li> <li class=md-nav__item> <a href=#to-generate-ecdsa-p-256-certificate-with-step-cli class=md-nav__link> <span class=md-ellipsis> To generate ECDSA P-256 certificate with step-cli </span> </a> </li> <li class=md-nav__item> <a href=#import-ssl-cert-to-kubernetes-secret class=md-nav__link> <span class=md-ellipsis> Import ssl cert to kubernetes secret </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-22 class=md-nav__link> <span class=md-ellipsis> 2020-07-22 </span> </a> <nav class=md-nav aria-label=2020-07-22> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-access-control-allow-origin class=md-nav__link> <span class=md-ellipsis> Nginx - Access-Control-Allow-Origin: * </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-14 class=md-nav__link> <span class=md-ellipsis> 2020-07-14 </span> </a> <nav class=md-nav aria-label=2020-07-14> <ul class=md-nav__list> <li class=md-nav__item> <a href=#is-possible-to-use-ip-address-in-managedcertificate-in-gke class=md-nav__link> <span class=md-ellipsis> Is possible to use ip address in ManagedCertificate in GKE? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-07-06 class=md-nav__link> <span class=md-ellipsis> 2020-07-06 </span> </a> <nav class=md-nav aria-label=2020-07-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-as-an-forward-proxy-server class=md-nav__link> <span class=md-ellipsis> Nginx - as an forward proxy server </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-30 class=md-nav__link> <span class=md-ellipsis> 2020-06-30 </span> </a> <nav class=md-nav aria-label=2020-06-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#github-api-delete-branch-with-personal-access-token class=md-nav__link> <span class=md-ellipsis> Github API - Delete branch with Personal Access Token </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-24 class=md-nav__link> <span class=md-ellipsis> 2020-06-24 </span> </a> <nav class=md-nav aria-label=2020-06-24> <ul class=md-nav__list> <li class=md-nav__item> <a href=#linux-get-geo-infomation-in-curl class=md-nav__link> <span class=md-ellipsis> Linux - Get Geo infomation in curl </span> </a> </li> <li class=md-nav__item> <a href=#nginx-ingress-will-use-default-fake-certificate class=md-nav__link> <span class=md-ellipsis> Nginx Ingress will use default fake certificate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-23 class=md-nav__link> <span class=md-ellipsis> 2020-06-23 </span> </a> <nav class=md-nav aria-label=2020-06-23> <ul class=md-nav__list> <li class=md-nav__item> <a href=#intall-google-cloud-sdk-in-docker-image class=md-nav__link> <span class=md-ellipsis> Intall Google Cloud SDK in docker image </span> </a> </li> <li class=md-nav__item> <a href=#linux-get-external-ip-in-curl-cli class=md-nav__link> <span class=md-ellipsis> Linux - Get external ip in curl cli </span> </a> </li> <li class=md-nav__item> <a href=#kubernetes-gkegcp-proxy-to-internal-load-balancer class=md-nav__link> <span class=md-ellipsis> Kubernetes - GKE/GCP proxy to internal load balancer </span> </a> </li> <li class=md-nav__item> <a href=#gke-internal-load-balancer-dont-need-extra-firewalls class=md-nav__link> <span class=md-ellipsis> GKE - Internal Load Balancer don't need extra firewalls </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-18 class=md-nav__link> <span class=md-ellipsis> 2020-06-18 </span> </a> <nav class=md-nav aria-label=2020-06-18> <ul class=md-nav__list> <li class=md-nav__item> <a href=#linux-adduser-without-prompts class=md-nav__link> <span class=md-ellipsis> Linux - adduser without prompts </span> </a> </li> <li class=md-nav__item> <a href=#linux-add-sudoer-group-to-user class=md-nav__link> <span class=md-ellipsis> Linux - Add sudoer group to user </span> </a> </li> <li class=md-nav__item> <a href=#github-action-runner-fix-gifsicle-command-failed class=md-nav__link> <span class=md-ellipsis> Github Action Runner - Fix gifsicle: Command failed </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-11 class=md-nav__link> <span class=md-ellipsis> 2020-06-11 </span> </a> <nav class=md-nav aria-label=2020-06-11> <ul class=md-nav__list> <li class=md-nav__item> <a href=#failed-to-determine-a-valid-solver-configuration-for-the-set-of-domains-on-the-order-no-configured-challenge-solvers-can-be-used-for-this-challenge class=md-nav__link> <span class=md-ellipsis> Failed to determine a valid solver configuration for the set of domains on the Order: no configured challenge solvers can be used for this challenge </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-05 class=md-nav__link> <span class=md-ellipsis> 2020-06-05 </span> </a> <nav class=md-nav aria-label=2020-06-05> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gsutil-verify-a-google-service-account-with-docker-and-a-environment-variable class=md-nav__link> <span class=md-ellipsis> gsutil - Verify a google service account with docker and a environment variable </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-06-02 class=md-nav__link> <span class=md-ellipsis> 2020-06-02 </span> </a> <nav class=md-nav aria-label=2020-06-02> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubernetes-get-client-ip-from-google-network-load-balancer class=md-nav__link> <span class=md-ellipsis> Kubernetes - Get client ip from Google Network Load Balancer </span> </a> </li> <li class=md-nav__item> <a href=#direct-server-return-dsr class=md-nav__link> <span class=md-ellipsis> Direct server return (DSR) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-26 class=md-nav__link> <span class=md-ellipsis> 2020-05-26 </span> </a> <nav class=md-nav aria-label=2020-05-26> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-get-request-connection-id class=md-nav__link> <span class=md-ellipsis> Nginx - get request connection id </span> </a> </li> <li class=md-nav__item> <a href=#nginx-proxy_set_header-will-diable-persistent-connection class=md-nav__link> <span class=md-ellipsis> Nginx - proxy_set_header will diable persistent connection </span> </a> </li> <li class=md-nav__item> <a href=#html-expires-and-cache-control class=md-nav__link> <span class=md-ellipsis> HTML - Expires and Cache-Control </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-22 class=md-nav__link> <span class=md-ellipsis> 2020-05-22 </span> </a> <nav class=md-nav aria-label=2020-05-22> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-use-http-header-as-variable class=md-nav__link> <span class=md-ellipsis> Nginx - use http header as variable </span> </a> </li> <li class=md-nav__item> <a href=#nginx-ssl_do_handshake-failed-ssl-error1408f10bssl-routinesssl3_get_recordwrong-version-number-while-ssl-handshaking-to-upstream class=md-nav__link> <span class=md-ellipsis> Nginx - SSL_do_handshake() failed (SSL: error:1408F10B:SSL routines:SSL3_GET_RECORD:wrong version number) while SSL handshaking to upstream </span> </a> </li> <li class=md-nav__item> <a href=#nginx-server-listen-80-default-deferred class=md-nav__link> <span class=md-ellipsis> Nginx - server listen 80 default deferred </span> </a> </li> <li class=md-nav__item> <a href=#nginx-print-cache-status-log class=md-nav__link> <span class=md-ellipsis> Nginx - Print cache status log </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-20 class=md-nav__link> <span class=md-ellipsis> 2020-05-20 </span> </a> <nav class=md-nav aria-label=2020-05-20> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-proxy_pass-cache-prority class=md-nav__link> <span class=md-ellipsis> Nginx - proxy_pass cache prority </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-13 class=md-nav__link> <span class=md-ellipsis> 2020-05-13 </span> </a> <nav class=md-nav aria-label=2020-05-13> <ul class=md-nav__list> <li class=md-nav__item> <a href=#probot-update-file-and-create-pull-request class=md-nav__link> <span class=md-ellipsis> Probot - update file and create pull request </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-05 class=md-nav__link> <span class=md-ellipsis> 2020-05-05 </span> </a> <nav class=md-nav aria-label=2020-05-05> <ul class=md-nav__list> <li class=md-nav__item> <a href=#got-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket-at-unixvarrundockersock-get-http2fvar2frun2fdockersockv140containersjson-dial-unix-varrundockersock-connect-permission-denied class=md-nav__link> <span class=md-ellipsis> Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.40/containers/json: dial unix /var/run/docker.sock: connect: permission denied </span> </a> </li> <li class=md-nav__item> <a href=#install-docker-on-debian-linux class=md-nav__link> <span class=md-ellipsis> Install docker on Debian Linux </span> </a> </li> <li class=md-nav__item> <a href=#ab-benchmark-is-using-1-core class=md-nav__link> <span class=md-ellipsis> ab benchmark is using 1 core </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-05-04 class=md-nav__link> <span class=md-ellipsis> 2020-05-04 </span> </a> <nav class=md-nav aria-label=2020-05-04> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pemission-denied-when-volumemounts-configmap-as-file class=md-nav__link> <span class=md-ellipsis> Pemission denied when volumeMounts configmap as file </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-04-30 class=md-nav__link> <span class=md-ellipsis> 2020-04-30 </span> </a> <nav class=md-nav aria-label=2020-04-30> <ul class=md-nav__list> <li class=md-nav__item> <a href=#generate-an-unique-sha-from-multiple-file-in-mac class=md-nav__link> <span class=md-ellipsis> Generate an unique sha from multiple file in Mac </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-04-24 class=md-nav__link> <span class=md-ellipsis> 2020-04-24 </span> </a> <nav class=md-nav aria-label=2020-04-24> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-could-not-find-named-location class=md-nav__link> <span class=md-ellipsis> Nginx: could not find named location </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-04-17 class=md-nav__link> <span class=md-ellipsis> 2020-04-17 </span> </a> <nav class=md-nav aria-label=2020-04-17> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-ingress-with-managed-certificates class=md-nav__link> <span class=md-ellipsis> GKE ingress with managed-certificates </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-04-07 class=md-nav__link> <span class=md-ellipsis> 2020-04-07 </span> </a> <nav class=md-nav aria-label=2020-04-07> <ul class=md-nav__list> <li class=md-nav__item> <a href=#test-a-website-speed class=md-nav__link> <span class=md-ellipsis> Test a website speed </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-14 class=md-nav__link> <span class=md-ellipsis> 2020-03-14 </span> </a> <nav class=md-nav aria-label=2020-03-14> <ul class=md-nav__list> <li class=md-nav__item> <a href=#find-other-lan-users-ip class=md-nav__link> <span class=md-ellipsis> Find other LAN user's IP </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-13 class=md-nav__link> <span class=md-ellipsis> 2020-03-13 </span> </a> <nav class=md-nav aria-label=2020-03-13> <ul class=md-nav__list> <li class=md-nav__item> <a href=#httpswww17cecom class=md-nav__link> <span class=md-ellipsis> 中國的測速網站 https://www.17ce.com/ </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-12 class=md-nav__link> <span class=md-ellipsis> 2020-03-12 </span> </a> <nav class=md-nav aria-label=2020-03-12> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dnsmasq-unsupported-option-check-that-dnsmasq-was-compiled-with-dhcptftpdnssecdbus-support class=md-nav__link> <span class=md-ellipsis> dnsmasq: unsupported option (check that dnsmasq was compiled with DHCP/TFTP/DNSSEC/DBus support) </span> </a> </li> <li class=md-nav__item> <a href=#parsing-dnssec-anchors-in-shell-scriptbash class=md-nav__link> <span class=md-ellipsis> Parsing dnssec anchors in shell script(bash) </span> </a> </li> <li class=md-nav__item> <a href=#commands-of-testing-domain class=md-nav__link> <span class=md-ellipsis> Commands of testing domain </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-11 class=md-nav__link> <span class=md-ellipsis> 2020-03-11 </span> </a> <nav class=md-nav aria-label=2020-03-11> <ul class=md-nav__list> <li class=md-nav__item> <a href=#check-multiple-variables-are-not-none-in-python class=md-nav__link> <span class=md-ellipsis> Check multiple variables are not None in Python </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-10 class=md-nav__link> <span class=md-ellipsis> 2020-03-10 </span> </a> <nav class=md-nav aria-label=2020-03-10> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gcs-roles class=md-nav__link> <span class=md-ellipsis> GCS roles </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-09 class=md-nav__link> <span class=md-ellipsis> 2020-03-09 </span> </a> <nav class=md-nav aria-label=2020-03-09> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-nth-line-of-stdout-on-linux class=md-nav__link> <span class=md-ellipsis> Get nth line of stdout on linux </span> </a> </li> <li class=md-nav__item> <a href=#sort-gcs-google-cloud-storage-objects-by-date class=md-nav__link> <span class=md-ellipsis> Sort GCS (google cloud storage) objects by date </span> </a> </li> <li class=md-nav__item> <a href=#measuring-kubernetes-dns class=md-nav__link> <span class=md-ellipsis> Measuring kubernetes dns </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-06 class=md-nav__link> <span class=md-ellipsis> 2020-03-06 </span> </a> <nav class=md-nav aria-label=2020-03-06> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-does-udp-request-receiving-responses class=md-nav__link> <span class=md-ellipsis> How does UDP request receiving responses. </span> </a> </li> <li class=md-nav__item> <a href=#weave-scope-kubernetes class=md-nav__link> <span class=md-ellipsis> Weave Scope - 監控 kubernetes 的工具 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-05 class=md-nav__link> <span class=md-ellipsis> 2020-03-05 </span> </a> <nav class=md-nav aria-label=2020-03-05> <ul class=md-nav__list> <li class=md-nav__item> <a href=#try-to-resolve-a-domain-in-kubernetes class=md-nav__link> <span class=md-ellipsis> Try to resolve a domain in kubernetes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-04 class=md-nav__link> <span class=md-ellipsis> 2020-03-04 </span> </a> <nav class=md-nav aria-label=2020-03-04> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-perform-ddos-test-as-a-pentester class=md-nav__link> <span class=md-ellipsis> how-to-perform-ddos-test-as-a-pentester </span> </a> </li> <li class=md-nav__item> <a href=#install-netstress-on-kali-linux class=md-nav__link> <span class=md-ellipsis> Install netstress on kali linux </span> </a> </li> <li class=md-nav__item> <a href=#run-kali-linux-on-kubernetes class=md-nav__link> <span class=md-ellipsis> Run kali linux on Kubernetes </span> </a> </li> <li class=md-nav__item> <a href=#gke-nodelocal-dnscache class=md-nav__link> <span class=md-ellipsis> GKE NodeLocal DNSCache </span> </a> </li> <li class=md-nav__item> <a href=#install-dnsperf-on-alpine class=md-nav__link> <span class=md-ellipsis> Install dnsperf on alpine </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-03 class=md-nav__link> <span class=md-ellipsis> 2020-03-03 </span> </a> <nav class=md-nav aria-label=2020-03-03> <ul class=md-nav__list> <li class=md-nav__item> <a href=#open-google-chrome-browser-in-mac-terminal class=md-nav__link> <span class=md-ellipsis> Open Google Chrome browser in Mac terminal </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-03-02 class=md-nav__link> <span class=md-ellipsis> 2020-03-02 </span> </a> <nav class=md-nav aria-label=2020-03-02> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-temporary-pod-to-debug-and-kill-itself-after-an-hour class=md-nav__link> <span class=md-ellipsis> Create a temporary pod to debug and kill itself after an hour </span> </a> </li> <li class=md-nav__item> <a href=#dns-load-testing-in-alpine class=md-nav__link> <span class=md-ellipsis> DNS load testing in Alpine </span> </a> </li> <li class=md-nav__item> <a href=#gke-v113x-uses-kube-dns-rather-than-core-dns class=md-nav__link> <span class=md-ellipsis> GKE v1.13.x uses kube-dns rather than core-dns. </span> </a> </li> <li class=md-nav__item> <a href=#install-gcc-compiler-in-alpine class=md-nav__link> <span class=md-ellipsis> Install gcc compiler in Alpine </span> </a> </li> <li class=md-nav__item> <a href=#echo-n class=md-nav__link> <span class=md-ellipsis> echo -n </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-27 class=md-nav__link> <span class=md-ellipsis> 2020-02-27 </span> </a> <nav class=md-nav aria-label=2020-02-27> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-github-user-info class=md-nav__link> <span class=md-ellipsis> Get GitHub user info </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-26 class=md-nav__link> <span class=md-ellipsis> 2020-02-26 </span> </a> <nav class=md-nav aria-label=2020-02-26> <ul class=md-nav__list> <li class=md-nav__item> <a href=#use-cloudflare-warp-as-vpn-on-macpc class=md-nav__link> <span class=md-ellipsis> Use CloudFlare WARP as VPN on Mac/PC </span> </a> </li> <li class=md-nav__item> <a href=#refreshclean-cdn-cache-on-tencent-cloud class=md-nav__link> <span class=md-ellipsis> Refresh/Clean CDN cache on Tencent Cloud </span> </a> </li> <li class=md-nav__item> <a href=#you-might-have-to-verify-by-doing-a-request-from-a-location-with-a-cloudflare-edge class=md-nav__link> <span class=md-ellipsis> You might have to verify by doing a request from a location with a Cloudflare edge </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-24 class=md-nav__link> <span class=md-ellipsis> 2020-02-24 </span> </a> <nav class=md-nav aria-label=2020-02-24> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cloudflare-worker-cant-resovlefind-domain class=md-nav__link> <span class=md-ellipsis> CloudFlare worker - Can't resovle/find domain </span> </a> </li> <li class=md-nav__item> <a href=#cloudflare-worker-how-to-handle-spa class=md-nav__link> <span class=md-ellipsis> CloudFlare worker - how to handle SPA </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-21 class=md-nav__link> <span class=md-ellipsis> 2020-02-21 </span> </a> <nav class=md-nav aria-label=2020-02-21> <ul class=md-nav__list> <li class=md-nav__item> <a href=#multiple-static-ip-in-a-load-balancer class=md-nav__link> <span class=md-ellipsis> Multiple static IP in a load balancer </span> </a> </li> <li class=md-nav__item> <a href=#testing-hpa-high-memory class=md-nav__link> <span class=md-ellipsis> Testing HPA high memory </span> </a> </li> <li class=md-nav__item> <a href=#about-kubernetes-hpahorizontal-pod-autoscaler class=md-nav__link> <span class=md-ellipsis> About Kubernetes HPA(Horizontal Pod Autoscaler) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-19 class=md-nav__link> <span class=md-ellipsis> 2020-02-19 </span> </a> <nav class=md-nav aria-label=2020-02-19> <ul class=md-nav__list> <li class=md-nav__item> <a href=#use-environment-from-parent-process-in-nginxopenresty class=md-nav__link> <span class=md-ellipsis> Use environment from parent process in Nginx(OpenResty) </span> </a> </li> <li class=md-nav__item> <a href=#cannot-create-an-external-load-balancer-with-mix-protocols class=md-nav__link> <span class=md-ellipsis> cannot create an external load balancer with mix protocols </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-18 class=md-nav__link> <span class=md-ellipsis> 2020-02-18 </span> </a> <nav class=md-nav aria-label=2020-02-18> <ul class=md-nav__list> <li class=md-nav__item> <a href=#try-docker-compose-health-check class=md-nav__link> <span class=md-ellipsis> Try docker-compose health check </span> </a> </li> <li class=md-nav__item> <a href=#docker-docker-credential-osxkeychain-ci-db class=md-nav__link> <span class=md-ellipsis> Docker 更新後跳出 docker-credential-osxkeychain 想使用鑰匙圈 ci-db </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-cc-by-sa-license class=md-nav__link> <span class=md-ellipsis> How to use cc-by-sa license </span> </a> </li> <li class=md-nav__item> <a href=#print-a-colorful-text-in-terminal class=md-nav__link> <span class=md-ellipsis> Print a colorful text in terminal </span> </a> </li> <li class=md-nav__item> <a href=#render-a-chart-inside-markdown-with-canvasjs class=md-nav__link> <span class=md-ellipsis> Render a chart inside markdown with canvasjs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-15 class=md-nav__link> <span class=md-ellipsis> 2020-02-15 </span> </a> <nav class=md-nav aria-label=2020-02-15> <ul class=md-nav__list> <li class=md-nav__item> <a href=#restart-a-kubernetes-resource-without-down-time-and-using-same-configyaml class=md-nav__link> <span class=md-ellipsis> Restart a kubernetes resource without down time and using same config(yaml) </span> </a> </li> <li class=md-nav__item> <a href=#run-commnad-withoutignoring-output class=md-nav__link> <span class=md-ellipsis> Run commnad without(ignoring) output </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2020-02-13 class=md-nav__link> <span class=md-ellipsis> 2020-02-13 </span> </a> <nav class=md-nav aria-label=2020-02-13> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker-compose class=md-nav__link> <span class=md-ellipsis> 在 docker-compose 中的容器互相溝通 </span> </a> </li> <li class=md-nav__item> <a href=#mkdocs-minify-html-got-error class=md-nav__link> <span class=md-ellipsis> mkdocs minify html got error </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>2020</h1> <p>What I learned in 2020.</p> <h2 id=2020-12-17>2020-12-17<a class=headerlink href=#2020-12-17 title="Permanent link">&para;</a></h2> <h3 id=nginx-brotli-behavior>Nginx - brotli behavior<a class=headerlink href=#nginx-brotli-behavior title="Permanent link">&para;</a></h3> <p><code>gzip_vary on;</code> will affect <code>brotli_static</code>. <code>brotli_static</code> will look this config.</p> <h2 id=2020-12-04>2020-12-04<a class=headerlink href=#2020-12-04 title="Permanent link">&para;</a></h2> <h3 id=gcp-internal-load-balancer-behavior>GCP - Internal Load Balancer Behavior<a class=headerlink href=#gcp-internal-load-balancer-behavior title="Permanent link">&para;</a></h3> <p>Internal Load Balancer 192.168.0.101 have a Instance Group contains</p> <ul> <li>192.168.0.3</li> <li>192.168.0.4</li> </ul> <p>in 192.168.0.3 curl 192.168.0.101, will always request to 192.168.0.3</p> <p>in 192.168.0.4 curl 192.168.0.101, will always request to 192.168.0.4</p> <h2 id=2020-12-03>2020-12-03<a class=headerlink href=#2020-12-03 title="Permanent link">&para;</a></h2> <h3 id=cn2-network-go-out-from-china>CN2 network - go out from China<a class=headerlink href=#cn2-network-go-out-from-china title="Permanent link">&para;</a></h3> <ul> <li>59.43.<em>.</em> is CN2 GIA better</li> <li>202.97.<em>.</em> is CN2 GT</li> </ul> <p>Traceroute from China: <a href=https://tools.ipip.net/traceroute.php>https://tools.ipip.net/traceroute.php</a></p> <h3 id=curl-get-current-ip-and-geo-location-in-china>curl - get current ip and geo location in China<a class=headerlink href=#curl-get-current-ip-and-geo-location-in-china title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>curl https://myip.ipip.net\?json
当前 IP：183.240.8.10  来自于：中国 广东 广州  移动
</code></pre></div> <h3 id=kubernetes-resourcememory-mi-vs-m>Kubernetes - resource.memory Mi vs M<a class=headerlink href=#kubernetes-resourcememory-mi-vs-m title="Permanent link">&para;</a></h3> <p>Mi = 1024*1024 = 1048576</p> <p>M = 1000*1000 = 1000000</p> <h2 id=2020-11-20>2020-11-20<a class=headerlink href=#2020-11-20 title="Permanent link">&para;</a></h2> <h3 id=k9s-install-k9s-on-ubuntu-linux>k9s - Install k9s on Ubuntu Linux<a class=headerlink href=#k9s-install-k9s-on-ubuntu-linux title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>/bin/bash<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;</span><span class=k>$(</span>curl<span class=w> </span>-fsSL<span class=w> </span>https://raw.githubusercontent.com/Homebrew/install/master/install.sh<span class=k>)</span><span class=s2>&quot;</span>
<span class=c1># brew install derailed/k9s/k9s</span>
brew<span class=w> </span>install<span class=w> </span>k9s
</code></pre></div> <p>ref:</p> <ul> <li><a href=https://brew.sh/ >https://brew.sh/</a></li> <li><a href=https://k9scli.io/topics/install/ >https://k9scli.io/topics/install/</a></li> </ul> <h3 id=k3sup>k3sup<a class=headerlink href=#k3sup title="Permanent link">&para;</a></h3> <p><a href=https://github.com/alexellis/k3sup>https://github.com/alexellis/k3sup</a> <div class=highlight><pre><span></span><code>curl -sLS https://get.k3sup.dev | sh
sudo install k3sup /usr/local/bin/

k3sup --help
</code></pre></div></p> <div class=highlight><pre><span></span><code>ssh-keygen -f ~/.ssh/k3s -N &quot;&quot;
</code></pre></div> <p>Add ssh-rsa.pub <a href=https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys#block-project-keys>https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys#block-project-keys</a> <a href=https://console.cloud.google.com/compute/metadata/sshKeys>https://console.cloud.google.com/compute/metadata/sshKeys</a></p> <div class=highlight><pre><span></span><code>export SSH_USER=rammus
export MASTER_IP=10.0.0.2
k3sup install --ip $MASTER_IP --user $SSH_USER --ssh-key ~/.ssh/k3s

export KUBECONFIG=/home/rammus_xu/kubeconfig
kubectl get node -o wide

export AGENT_IP=10.0.0.3
k3sup join --ip $AGENT_IP --server-ip $MASTER_IP --user $SSH_USER --ssh-key ~/.ssh/k3s
</code></pre></div> <h2 id=2020-11-12>2020-11-12<a class=headerlink href=#2020-11-12 title="Permanent link">&para;</a></h2> <h3 id=kuberntes-pod-injecthijackdebug>Kuberntes - Pod inject/hijack/debug<a class=headerlink href=#kuberntes-pod-injecthijackdebug title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;/bin/sh&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;-c&quot;</span><span class="p p-Indicator">]</span>
<span class=w>        </span><span class=nt>args</span><span class=p>:</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="p p-Indicator">|</span>
<span class=w>          </span><span class=no>tail -f /dev/null</span>
</code></pre></div> <h2 id=2020-11-10>2020-11-10<a class=headerlink href=#2020-11-10 title="Permanent link">&para;</a></h2> <h3 id=mongodb-not-master-and-slaveokfalse>MongoDB - not master and slaveOk=false<a class=headerlink href=#mongodb-not-master-and-slaveokfalse title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>rs0:SECONDARY&gt; show dbs
...
    &quot;errmsg&quot; : &quot;not master and slaveOk=false&quot;,
    &quot;code&quot; : 13435,
    &quot;codeName&quot; : &quot;NotMasterNoSlaveOk&quot;,
...
</code></pre></div> <div class=highlight><pre><span></span><code>rs0:SECONDARY&gt; rs.slaveOk()
rs0:SECONDARY&gt; show dbs
admin   0.000GB
config  0.000GB
demo    0.000GB
local   0.000GB
</code></pre></div> <h3 id=mongodb-could-not-find-host-matching-read-preference-mode-primary-for-set-rs0>MongoDB - Could not find host matching read preference { mode: \"primary\" } for set rs0<a class=headerlink href=#mongodb-could-not-find-host-matching-read-preference-mode-primary-for-set-rs0 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=err>mo</span><span class=kc>n</span><span class=err>gos&gt;</span><span class=w> </span><span class=err>sh.addShard(</span><span class=w> </span><span class=s2>&quot;rs0/mongo-rs0-0.mongo-rs0.testing-mongo.svc.cluster.local:27017,mongo-rs0-1.mongo-rs0.testing-mongo.svc.cluster.local:27017,mongo-rs0-2.mongo-rs0.testing-mongo.svc.cluster.local:27017&quot;</span><span class=err>)</span>
<span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;ok&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;errmsg&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Could not find host matching read preference { mode: \&quot;primary\&quot; } for set rs0&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;code&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>133</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;codeName&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;FailedToSatisfyReadPreference&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;operationTime&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=err>Times</span><span class=kc>ta</span><span class=err>mp(</span><span class=mi>1604989375</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=err>)</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;$clusterTime&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;clusterTime&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=err>Times</span><span class=kc>ta</span><span class=err>mp(</span><span class=mi>1604989377</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=err>)</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;signature&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>&quot;hash&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=err>Bi</span><span class=kc>n</span><span class=err>Da</span><span class=kc>ta</span><span class=err>(</span><span class=mi>0</span><span class=p>,</span><span class=s2>&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAA=&quot;</span><span class=err>)</span><span class=p>,</span>
<span class=w>            </span><span class=nt>&quot;keyId&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=err>NumberLo</span><span class=kc>n</span><span class=err>g(</span><span class=mi>0</span><span class=err>)</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>Debug:</p> <ul> <li>config rs seems ok. not error log on mongos</li> <li>mongo mongo-rs0-0.mongo-rs0.testing-mongo.svc.cluster.local:27017 rs0-0, rs0-1 rs0-2 are ok</li> <li>rs0-0 is primary, read/write ok</li> </ul> <div class="admonition solution"> <p class=admonition-title>Solution</p> <p>mongos version and replica set version should be same.</p> </div> <p>This error occurs when:</p> <ul> <li>shardsvr 4.0.20 + mongos 4.0.20 + configsvr 4.0.20 <img alt=✅ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2705.svg title=:white_check_mark:></li> <li>shardsvr 4.0.20 + mongos 4.0.20 + configsvr 4.4 <img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg title=:x:></li> <li>shardsvr 4.0.20 + mongos 4.4 + configsvr 4.4 <img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg title=:x:></li> <li>shardsvr 4.0.20, 3.6.6 mixed + mongos 4.0.20 + configsvr 4.0.20 <img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg title=:x:></li> </ul> <h2 id=2020-11-08>2020-11-08<a class=headerlink href=#2020-11-08 title="Permanent link">&para;</a></h2> <h3 id=gke-node-auto-repair>GKE - Node auto repair<a class=headerlink href=#gke-node-auto-repair title="Permanent link">&para;</a></h3> <p><a href=https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-repair>https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-repair</a></p> <p>GKE 會定期檢查 nodes，如果發生持續性的不健康， GKE 將會開始進行修復的程序。</p> <p>以 Status:<code>Ready</code> 當作基準，以下情況會視為不健康: - 連續 10 分鐘 Status:<code>NotReady</code> - 連續 10 分鐘沒有任何狀態 - boot disk 用完硬碟空間，超過 30 分鐘</p> <p>檢查最近的 operations，可以看到有沒有 <code>auto repair</code>。 <div class=highlight><pre><span></span><code>gcloud<span class=w> </span>container<span class=w> </span>operations<span class=w> </span>list
</code></pre></div></p> <h2 id=2020-11-06>2020-11-06<a class=headerlink href=#2020-11-06 title="Permanent link">&para;</a></h2> <h3 id=kubernetes-cusotmize-a-hostname>Kubernetes - Cusotmize a hostname<a class=headerlink href=#kubernetes-cusotmize-a-hostname title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">testing-mongo</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus-cf</span>
<span class=w>  </span><span class=nt>labels</span><span class=p>:</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus-cf</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>hostname</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus</span>
<span class=w>  </span><span class=nt>subdomain</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cf</span>
<span class=w>  </span><span class=nt>containers</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class=nn>---</span>
<span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cf</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>selector</span><span class=p>:</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus-cf</span>
<span class=w>  </span><span class=nt>clusterIP</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">None</span>
</code></pre></div> <p>在 cluster 裡面可以用 <div class=highlight><pre><span></span><code>curl rammus.cf
</code></pre></div></p> <h2 id=2020-11-03>2020-11-03<a class=headerlink href=#2020-11-03 title="Permanent link">&para;</a></h2> <h3 id=gke-node-auto-repair-notes>GKE node auto repair notes<a class=headerlink href=#gke-node-auto-repair-notes title="Permanent link">&para;</a></h3> <p><a href=https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-repair>https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-repair</a></p> <p>GKE 會定期檢查 nodes，如果發生持續性的不健康， GKE 將會開始進行修復的程序。</p> <p>以 Status:<code>Ready</code> 當作基準，以下情況會視為不健康: - 連續 10 分鐘 Status:<code>NotReady</code> - 連續 10 分鐘沒有任何狀態 - boot disk 用完硬碟空間，超過 30 分鐘</p> <p>Checking command: <div class=highlight><pre><span></span><code>gcloud<span class=w> </span>container<span class=w> </span>operations<span class=w> </span>list
</code></pre></div></p> <h2 id=2020-10-30>2020-10-30<a class=headerlink href=#2020-10-30 title="Permanent link">&para;</a></h2> <h3 id=sign-a-gcs-object>Sign a GCS object<a class=headerlink href=#sign-a-gcs-object title="Permanent link">&para;</a></h3> <p>This will use <code>gcs-service.json</code> to generate a URL with expired time <code>-d 1m</code>. You can give someone the URL to access <code>gs://rammus.cf/a-file.txt</code>. <div class=highlight><pre><span></span><code>gsutil signurl -d 1m gcs-service.json gs://rammus.cf/a-file.txt
</code></pre></div></p> <h2 id=2020-10-22>2020-10-22<a class=headerlink href=#2020-10-22 title="Permanent link">&para;</a></h2> <h3 id=kubernetes-install-godaddy-ssl-certificate-into-secrets-kubernetesiotls>Kubernetes - Install godaddy ssl certificate into secrets kubernetes.io/tls<a class=headerlink href=#kubernetes-install-godaddy-ssl-certificate-into-secrets-kubernetesiotls title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>cat 9faxxxxxxxxxxxxx.crt gd_bundle-g2-g1.crt &gt; chain.crt
kubectl create secret tls --cert chain.crt --key generated-private-key.txt rammusxu.tw-tls
</code></pre></div> <p>Test it on local:</p> <ol> <li>Add domain in /etc/hosts.</li> <li>Test it with CLI. <div class=highlight><pre><span></span><code>❌<span class=w> </span>curl<span class=w> </span>-kv<span class=w> </span>https://localhost/<span class=w> </span>-H<span class=w> </span><span class=s1>&#39;Host: rammusxu.tw&#39;</span>
👍<span class=w> </span>curl<span class=w> </span>-kv<span class=w> </span>https://rammusxu.tw

❌<span class=w> </span>openssl<span class=w> </span>s_client<span class=w> </span>-showcerts<span class=w> </span>-connect<span class=w> </span>rammusxu.tw:443
👍<span class=w> </span>openssl<span class=w> </span>s_client<span class=w> </span>-showcerts<span class=w> </span>-connect<span class=w> </span>rammusxu.tw:443<span class=w> </span>-servername<span class=w> </span>rammusxu.tw
</code></pre></div></li> </ol> <h2 id=2020-10-19>2020-10-19<a class=headerlink href=#2020-10-19 title="Permanent link">&para;</a></h2> <h3 id=nginx-cache-static-with-cache-control>Nginx - Cache static with Cache-Control<a class=headerlink href=#nginx-cache-static-with-cache-control title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>        expires max;
        add_header                      Cache-Control &quot;public&quot;;
</code></pre></div> <h3 id=nginx-react-app-serve-spa-htmls>Nginx - React app serve SPA htmls<a class=headerlink href=#nginx-react-app-serve-spa-htmls title="Permanent link">&para;</a></h3> <p>ref: <a href=https://stackoverflow.com/questions/51367160/nginx-tries-to-find-index-html-in-a-directory-according-to-the-uri>https://stackoverflow.com/questions/51367160/nginx-tries-to-find-index-html-in-a-directory-according-to-the-uri</a> <div class=highlight><pre><span></span><code>        root /app;
        index index.html;
        location / {
            try_files $uri $uri/ /index.html;
        }
</code></pre></div></p> <h2 id=2020-10-16>2020-10-16<a class=headerlink href=#2020-10-16 title="Permanent link">&para;</a></h2> <h3 id=nginx-automatical-content-type>Nginx - automatical content type<a class=headerlink href=#nginx-automatical-content-type title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=w>    </span><span class=k>include</span><span class=w>    </span><span class=n>mime.types</span>;
</code></pre></div> <p>path: - <code>/usr/local/openresty/nginx/conf/mime.types;</code> - <code>conf/mime.types;</code></p> <h2 id=2020-10-07>2020-10-07<a class=headerlink href=#2020-10-07 title="Permanent link">&para;</a></h2> <h3 id=mongodb-install-mongo-cli-on-mac>MongoDB - Install mongo cli on Mac<a class=headerlink href=#mongodb-install-mongo-cli-on-mac title="Permanent link">&para;</a></h3> <p>ref: <a href=https://dba.stackexchange.com/questions/196330/is-it-possible-to-install-just-the-mongo-shell>https://dba.stackexchange.com/questions/196330/is-it-possible-to-install-just-the-mongo-shell</a></p> <div class=highlight><pre><span></span><code>brew<span class=w> </span>tap<span class=w> </span>mongodb/brew
brew<span class=w> </span>install<span class=w> </span>mongodb-community-shell
</code></pre></div> <h3 id=mongodb-dump-and-restore>MongoDB - dump and restore<a class=headerlink href=#mongodb-dump-and-restore title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>mongodump<span class=w> </span>--gzip<span class=w> </span>--db<span class=o>=</span><span class=nb>test</span>
<span class=c1># mongorestore &lt;target&gt; &lt;folder&gt;</span>
mongorestore<span class=w> </span>mongodb://localhost:27017<span class=w> </span>dump
</code></pre></div> <h2 id=2020-09-30>2020-09-30<a class=headerlink href=#2020-09-30 title="Permanent link">&para;</a></h2> <h3 id=1-nodes-had-volume-node-affinity-conflict>1 node(s) had volume node affinity conflict.<a class=headerlink href=#1-nodes-had-volume-node-affinity-conflict title="Permanent link">&para;</a></h3> <p>ref: <a href=https://cloud.google.com/kubernetes-engine/docs/concepts/persistent-volumes#pd-zones>https://cloud.google.com/kubernetes-engine/docs/concepts/persistent-volumes#pd-zones</a></p> <p>Just add <code>volumeBindingMode: WaitForFirstConsumer</code></p> <div class="admonition solution"> <p class=admonition-title>Solution</p> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">storage.k8s.io/v1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">StorageClass</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">slow</span>
<span class=nt>provisioner</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/gce-pd</span>
<span class=nt>parameters</span><span class=p>:</span>
<span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pd-standard</span>
<span class=w>  </span><span class=nt>fstype</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ext4</span>
<span class=hll><span class=nt>volumeBindingMode</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">WaitForFirstConsumer</span>
</span></code></pre></div> </div> <h2 id=2020-09-29>2020-09-29<a class=headerlink href=#2020-09-29 title="Permanent link">&para;</a></h2> <h3 id=gke-dont-enable-podpreset>GKE don’t enable podpreset<a class=headerlink href=#gke-dont-enable-podpreset title="Permanent link">&para;</a></h3> <div class="admonition error"> <p class=admonition-title>no matches for kind "PodPreset" in version "settings.k8s.io/v1alpha1</p> <div class=highlight><pre><span></span><code>kubectl apply -f podpreset.yaml
error: unable to recognize &quot;podpreset.yaml&quot;: no matches for kind &quot;PodPreset&quot; in version &quot;settings.k8s.io/v1alpha1&quot;
</code></pre></div> </div> <p>no settings.k8s.io API <div class=highlight><pre><span></span><code>$ kubectl api-resources|grep settings.k8s.io
$ kubectl api-versions|grep settings.k8s.io
</code></pre></div></p> <h3 id=kubernetes-taint-and-tolerations>kubernetes - Taint and Tolerations<a class=headerlink href=#kubernetes-taint-and-tolerations title="Permanent link">&para;</a></h3> <p>ref: <a href=https://godleon.github.io/blog/Kubernetes/k8s-Taints-and-Tolerations/ >https://godleon.github.io/blog/Kubernetes/k8s-Taints-and-Tolerations/</a></p> <div class=highlight><pre><span></span><code>kubectl taint nodes gke-edge-tw-reserved-4c3f498d-068s preemptible=false:NoSchedule
kubectl taint nodes gke-edge-tw-reserved-4c3f498d-068s preemptible=false:NoExecute
</code></pre></div> <p><code>preemptible=false:NoExecute</code> will evicts all pod immediately</p> <p>this means the pod can tolerate a taint node, so it can be deploy <div class=highlight><pre><span></span><code><span class=w>  </span><span class=nt>nodeSelector</span><span class=p>:</span>
<span class=w>    </span><span class=nt>cloud.google.com/gke-nodepool</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">reserved</span>
<span class=w>  </span><span class=nt>tolerations</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=s>&quot;preemptible&quot;</span>
<span class=w>    </span><span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Equal&quot;</span>
<span class=w>    </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s>&quot;false&quot;</span>
</code></pre></div></p> <p>This can’t deploy <div class=highlight><pre><span></span><code><span class=w>  </span><span class=nt>nodeSelector</span><span class=p>:</span>
<span class=w>    </span><span class=nt>cloud.google.com/gke-nodepool</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">reserved</span>
<span class=w>  </span><span class=nt>tolerations</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=s>&quot;preemptible&quot;</span>
<span class=w>    </span><span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Equal&quot;</span>
<span class=w>    </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s>&quot;false&quot;</span>
<span class=w>    </span><span class=nt>effect</span><span class=p>:</span><span class=w> </span><span class=s>&quot;NoSchedule&quot;</span>
</code></pre></div></p> <div class="admonition error"> <p class=admonition-title>Error Message</p> <div class=highlight><pre><span></span><code><span class=w>  </span><span class=nt>conditions</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>lastProbeTime</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class=w>    </span><span class=nt>lastTransitionTime</span><span class=p>:</span><span class=w> </span><span class=s>&quot;2020-09-29T07:37:03Z&quot;</span>
<span class=w>    </span><span class=nt>message</span><span class=p>:</span><span class=w> </span><span class=s>&#39;0/4</span><span class=nv> </span><span class=s>nodes</span><span class=nv> </span><span class=s>are</span><span class=nv> </span><span class=s>available:</span><span class=nv> </span><span class=s>1</span><span class=nv> </span><span class=s>node(s)</span><span class=nv> </span><span class=s>had</span><span class=nv> </span><span class=s>taint</span><span class=nv> </span><span class=s>{preemptible:</span><span class=nv> </span><span class=s>false},</span><span class=nv> </span><span class=s>that</span>
<span class=w>      </span><span class=s>the</span><span class=nv> </span><span class=s>pod</span><span class=nv> </span><span class=s>didn</span><span class=se>&#39;&#39;</span><span class=s>t</span><span class=nv> </span><span class=s>tolerate,</span><span class=nv> </span><span class=s>3</span><span class=nv> </span><span class=s>node(s)</span><span class=nv> </span><span class=s>didn</span><span class=se>&#39;&#39;</span><span class=s>t</span><span class=nv> </span><span class=s>match</span><span class=nv> </span><span class=s>node</span><span class=nv> </span><span class=s>selector.&#39;</span>
<span class=w>    </span><span class=nt>reason</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Unschedulable</span>
<span class=w>    </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class=s>&quot;False&quot;</span>
<span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">PodScheduled</span>
</code></pre></div> </div> <h2 id=2020-09-17>2020-09-17<a class=headerlink href=#2020-09-17 title="Permanent link">&para;</a></h2> <h3 id=give-a-set-of-files-a-hash-key>Give a set of files a hash key<a class=headerlink href=#give-a-set-of-files-a-hash-key title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>~<span class=w> </span><span class=c1># md5sum a b</span>
d41d8cd98f00b204e9800998ecf8427e<span class=w>  </span>a
d41d8cd98f00b204e9800998ecf8427e<span class=w>  </span>b
~<span class=w> </span><span class=c1># md5sum a b | md5sum</span>
fe84858e5913eaed7bf248d8b25a77d7<span class=w>  </span>-
~<span class=w> </span><span class=c1># md5sum a b | md5sum | cut -b-32</span>
fe84858e5913eaed7bf248d8b25a77d7
~<span class=w> </span><span class=c1># echo a &gt; a</span>
~<span class=w> </span><span class=c1># md5sum a b | md5sum | cut -b-32</span>
e849952f425275e21c0d5c46ba2549f5
</code></pre></div> <h2 id=2020-09-10>2020-09-10<a class=headerlink href=#2020-09-10 title="Permanent link">&para;</a></h2> <h3 id=kubernetes-verticalpodautoscaler>Kubernetes - VerticalPodAutoscaler<a class=headerlink href=#kubernetes-verticalpodautoscaler title="Permanent link">&para;</a></h3> <p><a href=https://cloud.google.com/kubernetes-engine/docs/how-to/vertical-pod-autoscaling>https://cloud.google.com/kubernetes-engine/docs/how-to/vertical-pod-autoscaling</a></p> <div class="admonition warning"> <p class=admonition-title>Limitations</p> <p><a href=https://cloud.google.com/kubernetes-engine/docs/concepts/verticalpodautoscaler#limitations_for_vertical_pod_autoscaling>https://cloud.google.com/kubernetes-engine/docs/concepts/verticalpodautoscaler#limitations_for_vertical_pod_autoscaling</a></p> <ul> <li>Can’t use with HPA</li> </ul> </div> <div class=highlight><pre><span></span><code><span class=w>  </span><span class=nt>updatePolicy</span><span class=p>:</span>
<span class=w>    </span><span class=nt>updateMode</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Off&quot;</span>
</code></pre></div> <div class=highlight><pre><span></span><code>$<span class=w> </span>kubectl<span class=w> </span>get<span class=w> </span>vpa<span class=w> </span>my-vpa<span class=w> </span>--output<span class=w> </span>yaml
...
<span class=w>  </span>recommendation:
<span class=w>    </span>containerRecommendations:
<span class=w>    </span>-<span class=w> </span>containerName:<span class=w> </span>my-container
<span class=w>      </span>lowerBound:
<span class=w>        </span>cpu:<span class=w> </span>536m
<span class=w>        </span>memory:<span class=w> </span>262144k
<span class=w>      </span>target:
<span class=w>        </span>cpu:<span class=w> </span>587m
<span class=w>        </span>memory:<span class=w> </span>262144k
<span class=w>      </span>upperBound:
<span class=w>        </span>cpu:<span class=w> </span>27854m
<span class=w>        </span>memory:<span class=w> </span><span class=s2>&quot;545693548&quot;</span>
</code></pre></div> <h2 id=2020-09-09>2020-09-09<a class=headerlink href=#2020-09-09 title="Permanent link">&para;</a></h2> <h3 id=disable-gke-release-channel>Disable GKE release channel<a class=headerlink href=#disable-gke-release-channel title="Permanent link">&para;</a></h3> <blockquote> <p>ref: <a href=https://cloud.google.com/kubernetes-engine/docs/concepts/release-channels#updating_the_cluster_release_channel>https://cloud.google.com/kubernetes-engine/docs/concepts/release-channels#updating_the_cluster_release_channel</a></p> </blockquote> <p>It's not possible to exit RAPID channel for now.</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>gcloud<span class=w> </span>container<span class=w> </span>clusters<span class=w> </span>update<span class=w> </span>edge-tw<span class=w> </span>--release-channel<span class=w> </span>None<span class=w> </span>--region<span class=w> </span>asia-east1
ERROR:<span class=w> </span><span class=o>(</span>gcloud.container.clusters.update<span class=o>)</span><span class=w> </span>INVALID_ARGUMENT:<span class=w> </span>Migrating<span class=w> </span>off<span class=w> </span>of<span class=w> </span>releaseChannel<span class=w> </span>RAPID<span class=w> </span>is<span class=w> </span>not<span class=w> </span>supported.
</code></pre></div> <h3 id=fatal-error-linuxversionh-no-such-file-or-directory>fatal error: linux/version.h: No such file or directory<a class=headerlink href=#fatal-error-linuxversionh-no-such-file-or-directory title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>In<span class=w> </span>file<span class=w> </span>included<span class=w> </span>from<span class=w> </span>config.h:21,
<span class=w>                 </span>from<span class=w> </span>ae.c:45:
redis_config.h:38:10:<span class=w> </span>fatal<span class=w> </span>error:<span class=w> </span>linux/version.h:<span class=w> </span>No<span class=w> </span>such<span class=w> </span>file<span class=w> </span>or<span class=w> </span>directory
<span class=w>   </span><span class=m>38</span><span class=w> </span><span class=p>|</span><span class=w> </span><span class=c1>#include &lt;linux/version.h&gt;</span>
<span class=w>      </span><span class=p>|</span><span class=w>          </span>^~~~~~~~~~~~~~~~~
compilation<span class=w> </span>terminated.
make<span class=o>[</span><span class=m>1</span><span class=o>]</span>:<span class=w> </span>***<span class=w> </span><span class=o>[</span>Makefile:190:<span class=w> </span>ae.o<span class=o>]</span><span class=w> </span>Error<span class=w> </span><span class=m>1</span>
make<span class=o>[</span><span class=m>1</span><span class=o>]</span>:<span class=w> </span>Leaving<span class=w> </span>directory<span class=w> </span><span class=s1>&#39;/redis-cluster-proxy/src&#39;</span>
make:<span class=w> </span>***<span class=w> </span><span class=o>[</span>Makefile:4:<span class=w> </span>all<span class=o>]</span><span class=w> </span>Error<span class=w> </span><span class=m>2</span>
</code></pre></div> <div class="admonition solution"> <p class=admonition-title>Solution</p> <div class=highlight><pre><span></span><code>apk<span class=w> </span>add<span class=w> </span>linux-headers
</code></pre></div> </div> <h2 id=2020-09-06>2020-09-06<a class=headerlink href=#2020-09-06 title="Permanent link">&para;</a></h2> <h3 id=upgrade-buildx-version-on-mac>Upgrade buildx version on Mac<a class=headerlink href=#upgrade-buildx-version-on-mac title="Permanent link">&para;</a></h3> <p><a href=https://gist.github.com/RammusXu/8eb867e2a2dedd3c07149016829da5c3>https://gist.github.com/RammusXu/8eb867e2a2dedd3c07149016829da5c3</a> <div class=highlight><pre><span></span><code>docker<span class=w> </span>buildx<span class=w> </span>version

mkdir<span class=w> </span>-p<span class=w> </span>~/.docker/cli-plugins
<span class=nv>BUILDX_VERSION</span><span class=o>=</span><span class=s2>&quot;v0.4.2&quot;</span>
wget<span class=w> </span>https://github.com/docker/buildx/releases/download/<span class=si>${</span><span class=nv>BUILDX_VERSION</span><span class=si>}</span>/buildx-<span class=si>${</span><span class=nv>BUILDX_VERSION</span><span class=si>}</span>.darwin-amd64<span class=w> </span>-O<span class=w> </span>~/.docker/cli-plugins/docker-buildx
chmod<span class=w> </span>a+x<span class=w> </span>~/.docker/cli-plugins/docker-buildx

docker<span class=w> </span>buildx<span class=w> </span>version
</code></pre></div></p> <h2 id=2020-09-03>2020-09-03<a class=headerlink href=#2020-09-03 title="Permanent link">&para;</a></h2> <h3 id=nginx-change-host-not-found-response-status-and-content>Nginx - Change host not found response status and content<a class=headerlink href=#nginx-change-host-not-found-response-status-and-content title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>curl<span class=w> </span>localhost:8001/host<span class=w> </span><span class=s2>&quot;host:backend&quot;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>location</span><span class=w> </span><span class=s>/host</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kn>resolver</span><span class=w> </span><span class=mi>127</span><span class=s>.0.0.11</span><span class=p>;</span>
<span class=w>    </span><span class=kn>proxy_pass</span><span class=w>              </span><span class=s>http://</span><span class=nv>$http_host$uri</span><span class=p>;</span>

<span class=w>    </span><span class=kn>proxy_cache_key</span><span class=w>                 </span><span class=nv>$http_host$uri</span><span class=p>;</span>
<span class=w>    </span><span class=kn>proxy_cache_valid</span><span class=w>               </span><span class=mi>200</span><span class=w> </span><span class=s>60s</span><span class=p>;</span>

<span class=w>    </span><span class=kn>proxy_intercept_errors</span><span class=w>          </span><span class=no>on</span><span class=p>;</span>
<span class=w>    </span><span class=kn>error_page</span><span class=w> </span><span class=mi>502</span><span class=w> </span><span class=mi>503</span><span class=w> </span><span class=p>=</span><span class=mi>404</span><span class=w> </span><span class=s>/</span><span class=p>;</span>
<span class=p>}</span>

<span class=k>location</span><span class=w> </span><span class=s>@host_not_found</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kn>echo</span><span class=w> </span><span class=s>&quot;not</span><span class=w> </span><span class=s>found&quot;</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <p>Host not found <div class=highlight><pre><span></span><code>frontend_1<span class=w>  </span><span class=p>|</span><span class=w> </span><span class=m>172</span>.18.0.1<span class=w> </span>-<span class=w> </span>-<span class=w> </span>-<span class=w> </span>MISS<span class=w> </span><span class=o>[</span><span class=m>03</span>/Sep/2020:09:01:52<span class=w> </span>+0000<span class=o>]</span><span class=w> </span><span class=s2>&quot;GET /host HTTP/1.1&quot;</span><span class=w> </span><span class=m>404</span><span class=w> </span><span class=m>20</span><span class=w> </span><span class=s2>&quot;-&quot;</span><span class=w> </span><span class=s2>&quot;HTTPie/1.0.2&quot;</span><span class=w> </span><span class=s2>&quot;-&quot;</span>
frontend_1<span class=w>  </span><span class=p>|</span><span class=w> </span><span class=m>2020</span>/09/03<span class=w> </span><span class=m>09</span>:01:52<span class=w> </span><span class=o>[</span>error<span class=o>]</span><span class=w> </span><span class=m>6</span><span class=c1>#6: *12 backend2 could not be resolved (3: Host not found), client: 172.18.0.1, server: , request: &quot;GET /host HTTP/1.1&quot;, host: &quot;backend2&quot;</span>
frontend_1<span class=w>  </span><span class=p>|</span><span class=w> </span><span class=m>2020</span>/09/03<span class=w> </span><span class=m>09</span>:01:53<span class=w> </span><span class=o>[</span>error<span class=o>]</span><span class=w> </span><span class=m>6</span><span class=c1>#6: *13 backend2 could not be resolved (3: Host not found), client: 172.18.0.1, server: , request: &quot;GET /host HTTP/1.1&quot;, host: &quot;backend2&quot;</span>
frontend_1<span class=w>  </span><span class=p>|</span><span class=w> </span><span class=m>172</span>.18.0.1<span class=w> </span>-<span class=w> </span>-<span class=w> </span>-<span class=w> </span>MISS<span class=w> </span><span class=o>[</span><span class=m>03</span>/Sep/2020:09:01:53<span class=w> </span>+0000<span class=o>]</span><span class=w> </span><span class=s2>&quot;GET /host HTTP/1.1&quot;</span><span class=w> </span><span class=m>404</span><span class=w> </span><span class=m>20</span><span class=w> </span><span class=s2>&quot;-&quot;</span><span class=w> </span><span class=s2>&quot;HTTPie/1.0.2&quot;</span><span class=w> </span><span class=s2>&quot;-&quot;</span>
</code></pre></div></p> <p>Host found <div class=highlight><pre><span></span><code>backend_1<span class=w>   </span><span class=p>|</span><span class=w> </span><span class=m>172</span>.18.0.3<span class=w> </span>-<span class=w> </span>-<span class=w> </span><span class=o>[</span><span class=m>03</span>/Sep/2020:09:02:30<span class=w> </span>+0000<span class=o>]</span><span class=w> </span><span class=s2>&quot;GET /host HTTP/1.0&quot;</span><span class=w> </span><span class=m>200</span><span class=w> </span><span class=m>6</span><span class=w> </span><span class=s2>&quot;-&quot;</span><span class=w> </span><span class=s2>&quot;HTTPie/1.0.2&quot;</span><span class=w> </span><span class=s2>&quot;-&quot;</span>
frontend_1<span class=w>  </span><span class=p>|</span><span class=w> </span><span class=m>172</span>.18.0.1<span class=w> </span>-<span class=w> </span>-<span class=w> </span>-<span class=w> </span>MISS<span class=w> </span><span class=o>[</span><span class=m>03</span>/Sep/2020:09:02:30<span class=w> </span>+0000<span class=o>]</span><span class=w> </span><span class=s2>&quot;GET /host HTTP/1.1&quot;</span><span class=w> </span><span class=m>200</span><span class=w> </span><span class=m>16</span><span class=w> </span><span class=s2>&quot;-&quot;</span><span class=w> </span><span class=s2>&quot;HTTPie/1.0.2&quot;</span><span class=w> </span><span class=s2>&quot;-&quot;</span>
frontend_1<span class=w>  </span><span class=p>|</span><span class=w> </span><span class=m>172</span>.18.0.1<span class=w> </span>-<span class=w> </span>-<span class=w> </span>-<span class=w> </span>HIT<span class=w> </span><span class=o>[</span><span class=m>03</span>/Sep/2020:09:02:38<span class=w> </span>+0000<span class=o>]</span><span class=w> </span><span class=s2>&quot;GET /host HTTP/1.1&quot;</span><span class=w> </span><span class=m>200</span><span class=w> </span><span class=m>16</span><span class=w> </span><span class=s2>&quot;-&quot;</span><span class=w> </span><span class=s2>&quot;HTTPie/1.0.2&quot;</span><span class=w> </span><span class=s2>&quot;-&quot;</span>
</code></pre></div></p> <h2 id=2020-08-27>2020-08-27<a class=headerlink href=#2020-08-27 title="Permanent link">&para;</a></h2> <h3 id=2020-cert-manager-request-a-certificate-with-ingress-in-place>2020 cert-manager request a certificate with ingress in place<a class=headerlink href=#2020-cert-manager-request-a-certificate-with-ingress-in-place title="Permanent link">&para;</a></h3> <blockquote> <p>ref: <a href=https://kosyfrances.github.io/ingress-gce-letsencrypt/ >https://kosyfrances.github.io/ingress-gce-letsencrypt/</a></p> </blockquote> <div class="admonition info"> <p class=admonition-title>Environment</p> <ul> <li>kuberentes: v1.17.9-gke</li> <li>cert-manager: v0.15.0</li> </ul> </div> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cert-manager.io/v1alpha2</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIssuer</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ci-http01</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>acme</span><span class=p>:</span>
<span class=w>    </span><span class=nt>email</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus.xu@gmail.com</span>
<span class=w>    </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://acme-v02.api.letsencrypt.org/directory</span>
<span class=w>    </span><span class=nt>privateKeySecretRef</span><span class=p>:</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">issuer-account-key-rammus</span>
<span class=w>    </span><span class=nt>solvers</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>http01</span><span class=p>:</span>
<span class=w>          </span><span class=nt>ingress</span><span class=p>:</span>
<span class=w>            </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ingress-gce</span>
<span class=nn>---</span>
<span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1beta1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">china-landing</span>
<span class=w>  </span><span class=nt>annotations</span><span class=p>:</span>
<span class=w>    </span><span class=nt>kubernetes.io/ingress.class</span><span class=p>:</span><span class=w> </span><span class=s>&quot;gce&quot;</span>
<span class=w>    </span><span class=nt>cert-manager.io/cluster-issuer</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ci-http01</span>
<span class=w>    </span><span class=nt>acme.cert-manager.io/http01-edit-in-place</span><span class=p>:</span><span class=w> </span><span class=s>&quot;true&quot;</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>tls</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>hosts</span><span class=p>:</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus.dev</span>
<span class=w>      </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus-dev-tls</span>
<span class=w>  </span><span class=nt>rules</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus.dev</span>
<span class=w>      </span><span class=nt>http</span><span class=p>:</span>
<span class=w>        </span><span class=nt>paths</span><span class=p>:</span>
<span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>backend</span><span class=p>:</span>
<span class=w>              </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http-service-np</span>
<span class=w>              </span><span class=nt>servicePort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class=nn>---</span>
<span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http-service-np</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">NodePort</span>
<span class=w>  </span><span class=nt>ports</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class=w>  </span><span class=nt>selector</span><span class=p>:</span>
<span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http-app</span>
</code></pre></div> <h2 id=2020-08-21>2020-08-21<a class=headerlink href=#2020-08-21 title="Permanent link">&para;</a></h2> <h3 id=copy-docker-image-to-another-registry>Copy docker image to another registry<a class=headerlink href=#copy-docker-image-to-another-registry title="Permanent link">&para;</a></h3> <blockquote> <p>ref: <a href=https://cloud.google.com/artifact-registry/docs/docker/copy-from-gcr#copy-gcloud>https://cloud.google.com/artifact-registry/docs/docker/copy-from-gcr#copy-gcloud</a></p> </blockquote> <div class=highlight><pre><span></span><code>gcloud<span class=w> </span>container<span class=w> </span>images<span class=w> </span>add-tag<span class=w> </span>GCR-IMAGE<span class=w> </span>AR-IMAGE
</code></pre></div> <h3 id=nginx-cors-with-map-example>Nginx - CORS with map example<a class=headerlink href=#nginx-cors-with-map-example title="Permanent link">&para;</a></h3> <p>ref:</p> <ul> <li><a href=https://blog.51cto.com/tchuairen/2175525>https://blog.51cto.com/tchuairen/2175525</a></li> <li><a href=https://github.com/openresty/headers-more-nginx-module>https://github.com/openresty/headers-more-nginx-module</a> <div class=highlight><pre><span></span><code>map $http_origin $cors_origin {
    default               https://rammus.dev;
    &quot;~rammus2020.dev&quot;     $http_origin;
}

server {
    listen 80;
    location / {
        more_set_headers Access-Control-Allow-Origin $cors_origin;
    }
}
</code></pre></div></li> </ul> <h3 id=docker-registry-gitlab-registry>Docker Registry - Gitlab Registry<a class=headerlink href=#docker-registry-gitlab-registry title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>docker<span class=w> </span>pull<span class=w> </span>registry.gitlab.com/rammus.xu/docker-alpine:3.12.0
</code></pre></div> <ul> <li>Public git repo = Public docker registry</li> <li>No need to login to pull Gitlab public registry image</li> <li><a href=https://docs.gitlab.com/ee/user/packages/container_registry/#enable-the-container-registry-for-your-project>10GB storage, as part of the repository size limit</a></li> </ul> <div class=highlight><pre><span></span><code>docker<span class=w> </span>login<span class=w> </span>registry.gitlab.com<span class=w> </span>-u<span class=w> </span>rammus.xu<span class=w> </span>-p
docker<span class=w> </span>pull<span class=w> </span>nginx:1.19.2-alpine
docker<span class=w> </span>tag<span class=w> </span>nginx:1.19.2-alpine<span class=w> </span>registry.gitlab.com/rammus.xu/docker-alpine:nginx-1.19.2
docker<span class=w> </span>push<span class=w> </span>registry.gitlab.com/rammus.xu/docker-alpine:nginx-1.19.2

docker<span class=w> </span>pull<span class=w> </span>registry.gitlab.com/rammus.xu/docker-alpine:nginx-1.19.2
</code></pre></div> <h3 id=docker-registry-github-registry>Docker Registry - Github Registry<a class=headerlink href=#docker-registry-github-registry title="Permanent link">&para;</a></h3> <ul> <li>Can't pull without docker credential<ul> <li><code>docker login https://docker.pkg.github.com -u rammusxu -p</code></li> </ul> </li> </ul> <div class=highlight><pre><span></span><code>docker<span class=w> </span>login<span class=w> </span>https://docker.pkg.github.com<span class=w> </span>-u<span class=w> </span>rammusxu<span class=w> </span>-p
docker<span class=w> </span>pull<span class=w> </span>nginx:1.19.2-alpine
docker<span class=w> </span>tag<span class=w> </span>nginx:1.19.2-alpine<span class=w> </span>docker.pkg.github.com/rammusxu/docker-alpine/nginx:1.19.2-alpine
docker<span class=w> </span>push<span class=w> </span>docker.pkg.github.com/rammusxu/docker-alpine/nginx:1.19.2-alpine

docker<span class=w> </span>pull<span class=w> </span>docker.pkg.github.com/rammusxu/docker-alpine/nginx:1.19.2-alpine
Error<span class=w> </span>response<span class=w> </span>from<span class=w> </span>daemon:<span class=w> </span>Get<span class=w> </span>https://docker.pkg.github.com/v2/rammusxu/docker-alpine/nginx/manifests/1.19.2-alpine:<span class=w> </span>no<span class=w> </span>basic<span class=w> </span>auth<span class=w> </span>credentials
</code></pre></div> <h2 id=2020-08-19>2020-08-19<a class=headerlink href=#2020-08-19 title="Permanent link">&para;</a></h2> <h3 id=dockerhub-is-rate-limiting-download-layers>Dockerhub is rate limiting download layers<a class=headerlink href=#dockerhub-is-rate-limiting-download-layers title="Permanent link">&para;</a></h3> <ul> <li><a href=https://www.docker.com/pricing>https://www.docker.com/pricing</a></li> <li><a href=https://docs.docker.com/docker-hub/download-rate-limit/ >https://docs.docker.com/docker-hub/download-rate-limit/</a></li> <li><a href=https://www.docker.com/pricing/retentionfaq>https://www.docker.com/pricing/retentionfaq</a></li> <li><a href=https://github.com/testcontainers/testcontainers-java/issues/3099>https://github.com/testcontainers/testcontainers-java/issues/3099</a><blockquote> <p>As of 2020-08-13, Docker have updated their terms of service and pricing page, indicating that:</p> <ul> <li>unauthenticated pulls will be rate limited to 100 per 6h</li> <li>authenticated pulls will be rate limited to 200 per 6h</li> </ul> </blockquote> </li> </ul> <p>Community - <a href=https://www.reddit.com/r/docker/comments/i93bui/docker_terms_of_service_change/ >https://www.reddit.com/r/docker/comments/i93bui/docker_terms_of_service_change/</a> - <a href=https://www.reddit.com/r/docker/comments/i9lxq3/docker_reduces_image_retaining_to_6_months_for/ >https://www.reddit.com/r/docker/comments/i9lxq3/docker_reduces_image_retaining_to_6_months_for/</a></p> <h3 id=wheres-disk-storage-locationpath-of-gke-emptydir>Where's disk storage location(path) of GKE emptyDir<a class=headerlink href=#wheres-disk-storage-locationpath-of-gke-emptydir title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1># docker container inspect k8s_packager-public_stream-5ad4d9decc14623f43ed1325_default_247be3c5-227d-46cc-9f9c-7aad8cfaeb47_0 | grep Source</span>
<span class=w>                </span><span class=s2>&quot;Source&quot;</span>:<span class=w> </span><span class=s2>&quot;/var/lib/kubelet/pods/247be3c5-227d-46cc-9f9c-7aad8cfaeb47/volumes/kubernetes.io~empty-dir/dist&quot;</span>,
<span class=w>                </span><span class=s2>&quot;Source&quot;</span>:<span class=w> </span><span class=s2>&quot;/var/lib/kubelet/pods/247be3c5-227d-46cc-9f9c-7aad8cfaeb47/volume-subpaths/workdir/packager-public/1&quot;</span>,
<span class=w>                </span><span class=s2>&quot;Source&quot;</span>:<span class=w> </span><span class=s2>&quot;/var/lib/kubelet/pods/247be3c5-227d-46cc-9f9c-7aad8cfaeb47/volumes/kubernetes.io~secret/default-token-vvrzk&quot;</span>,
<span class=w>                </span><span class=s2>&quot;Source&quot;</span>:<span class=w> </span><span class=s2>&quot;/var/lib/kubelet/pods/247be3c5-227d-46cc-9f9c-7aad8cfaeb47/etc-hosts&quot;</span>,
<span class=w>                </span><span class=s2>&quot;Source&quot;</span>:<span class=w> </span><span class=s2>&quot;/var/lib/kubelet/pods/247be3c5-227d-46cc-9f9c-7aad8cfaeb47/containers/packager-public/0fa5ef38&quot;</span>,

<span class=c1># df /var/lib/kubelet/pods/247be3c5-227d-46cc-9f9c-7aad8cfaeb47 -h</span>
Filesystem<span class=w>      </span>Size<span class=w>  </span>Used<span class=w> </span>Avail<span class=w> </span>Use%<span class=w> </span>Mounted<span class=w> </span>on
/dev/sda1<span class=w>       </span><span class=m>2</span>.0T<span class=w>  </span>173G<span class=w>  </span><span class=m>1</span>.8T<span class=w>   </span><span class=m>9</span>%<span class=w> </span>/var/lib/kubelet
</code></pre></div> <h2 id=2020-08-12>2020-08-12<a class=headerlink href=#2020-08-12 title="Permanent link">&para;</a></h2> <h3 id=markdown>markdown 文件製作<a class=headerlink href=#markdown title="Permanent link">&para;</a></h3> <p><a href=https://docsify.js.org/#/ >https://docsify.js.org/#/</a></p> <h2 id=2020-08-10>2020-08-10<a class=headerlink href=#2020-08-10 title="Permanent link">&para;</a></h2> <h3 id=istio-on-k3d>istio on k3d<a class=headerlink href=#istio-on-k3d title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>curl<span class=w> </span>-L<span class=w> </span>https://istio.io/downloadIstio<span class=w> </span><span class=p>|</span><span class=w> </span>sh<span class=w> </span>-
cp<span class=w> </span>istio-1.6.7/bin/istioctl<span class=w> </span><span class=nv>$HOME</span>/bin/

<span class=c1># ~/.zshrc</span>
<span class=nb>export</span><span class=w> </span><span class=nv>PATH</span><span class=o>=</span><span class=nv>$HOME</span>/bin:/usr/local/bin:<span class=nv>$PATH</span>

~<span class=w> </span>istioctl<span class=w> </span>version
no<span class=w> </span>running<span class=w> </span>Istio<span class=w> </span>pods<span class=w> </span><span class=k>in</span><span class=w> </span><span class=s2>&quot;istio-system&quot;</span>
<span class=m>1</span>.6.7
</code></pre></div> <div class=highlight><pre><span></span><code>brew<span class=w> </span>install<span class=w> </span>k3d
</code></pre></div> <div class=highlight><pre><span></span><code>k3d<span class=w> </span>cluster<span class=w> </span>create<span class=w> </span>dc0<span class=w> </span>--k3s-server-arg<span class=w> </span>--disable<span class=o>=</span>traefik<span class=w> </span>--publish<span class=w> </span><span class=m>8080</span>:80
k3d<span class=w> </span>cluster<span class=w> </span>create<span class=w> </span>dc1<span class=w> </span>--port<span class=w> </span><span class=m>8081</span>:80<span class=w> </span>--no-lb<span class=w> </span>--k3s-server-arg<span class=w> </span>--disable<span class=o>=</span>traefik
</code></pre></div> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>create<span class=w> </span>namespace<span class=w> </span>istio-system
kubectl<span class=w> </span>create<span class=w> </span>secret<span class=w> </span>generic<span class=w> </span>cacerts<span class=w> </span>-n<span class=w> </span>istio-system<span class=w> </span><span class=se>\</span>
<span class=w>  </span>--from-file<span class=o>=</span>samples/certs/ca-cert.pem<span class=w> </span><span class=se>\</span>
<span class=w>  </span>--from-file<span class=o>=</span>samples/certs/ca-key.pem<span class=w> </span><span class=se>\</span>
<span class=w>  </span>--from-file<span class=o>=</span>samples/certs/root-cert.pem<span class=w> </span><span class=se>\</span>
<span class=w>  </span>--from-file<span class=o>=</span>samples/certs/cert-chain.pem

<span class=c1># Install istio</span>
istioctl<span class=w> </span>install<span class=w> </span><span class=se>\</span>
<span class=w>    </span>-f<span class=w> </span>manifests/examples/multicluster/values-istio-multicluster-gateways.yaml

<span class=c1># Update coreDNS</span>
kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>-<span class=w> </span><span class=s>&lt;&lt;EOF</span>
<span class=s>apiVersion: v1</span>
<span class=s>kind: ConfigMap</span>
<span class=s>metadata:</span>
<span class=s>  name: coredns</span>
<span class=s>  namespace: kube-system</span>
<span class=s>data:</span>
<span class=s>  Corefile: |</span>
<span class=s>    .:53 {</span>
<span class=s>        errors</span>
<span class=s>        health</span>
<span class=s>        ready</span>
<span class=s>        kubernetes cluster.local in-addr.arpa ip6.arpa {</span>
<span class=s>           pods insecure</span>
<span class=s>           upstream</span>
<span class=s>           fallthrough in-addr.arpa ip6.arpa</span>
<span class=s>        }</span>
<span class=s>        prometheus :9153</span>
<span class=s>        forward . /etc/resolv.conf</span>
<span class=s>        cache 30</span>
<span class=s>        loop</span>
<span class=s>        reload</span>
<span class=s>        loadbalance</span>
<span class=s>    }</span>
<span class=s>    global:53 {</span>
<span class=s>        errors</span>
<span class=s>        cache 30</span>
<span class=s>        forward . $(kubectl get svc -n istio-system istiocoredns -o jsonpath={.spec.clusterIP}):53</span>
<span class=s>    }</span>
<span class=s>EOF</span>
</code></pre></div> <p>ref: <a href=https://dev.to/bufferings/tried-k8s-istio-in-my-local-machine-with-k3d-52gg>https://dev.to/bufferings/tried-k8s-istio-in-my-local-machine-with-k3d-52gg</a></p> <h3 id=configure-k3d-on-mac-zsh>Configure k3d on Mac zsh<a class=headerlink href=#configure-k3d-on-mac-zsh title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>brew<span class=w> </span>instsall<span class=w> </span>k3d
mkdir<span class=w> </span>-p<span class=w> </span>~/.oh-my-zsh/custom/plugins/k3d/_k3d
k3d<span class=w> </span>completion<span class=w> </span>zsh<span class=w> </span>&gt;<span class=w> </span>~/.oh-my-zsh/custom/plugins/k3d/_k3d

vi<span class=w> </span>~/.zshrc
<span class=nv>plugins</span><span class=o>=(</span>...<span class=w> </span>k3d<span class=o>)</span>
</code></pre></div> <h2 id=2020-08-07>2020-08-07<a class=headerlink href=#2020-08-07 title="Permanent link">&para;</a></h2> <h3 id=testing-websocket>Testing websocket<a class=headerlink href=#testing-websocket title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>npm install -g wscat
docker run -it --rm  -p 10000:8080 jmalloc/echo-server
wscat -c ws://localhost:10000
</code></pre></div> <h2 id=2020-08-06>2020-08-06<a class=headerlink href=#2020-08-06 title="Permanent link">&para;</a></h2> <h3 id=gcp-monitoring-response-throughput-is-including-cdn-hit>GCP Monitoring - Response Throughput is including CDN hit<a class=headerlink href=#gcp-monitoring-response-throughput-is-including-cdn-hit title="Permanent link">&para;</a></h3> <ul> <li>Miss 0</li> <li>Hit 21688/s</li> </ul> <p><img alt src=../img/2020-08-06-gcp-lb-throughput-1.png> <img alt src=../img/2020-08-06-gcp-lb-throughput-2.png></p> <h3 id=nginx-add_header-is-not-working-on-indexhtml>Nginx - add_header is not working on index.html<a class=headerlink href=#nginx-add_header-is-not-working-on-indexhtml title="Permanent link">&para;</a></h3> <p><img alt=✅ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2705.svg title=:white_check_mark:> <div class=highlight><pre><span></span><code>      location / {
        add_header                      &quot;Cache-Control&quot; &quot;public, max-age=600000&quot;;
        index index.html;
      }
</code></pre></div></p> <p><img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/274c.svg title=:x:> <div class=highlight><pre><span></span><code>      location / {
        add_header                      &quot;Cache-Control&quot; &quot;public, max-age=600000&quot;;
        index index.html;
      }
</code></pre></div></p> <h3 id=cc-40>CC 4.0 著作權懶人包<a class=headerlink href=#cc-40 title="Permanent link">&para;</a></h3> <p>ref: <a href=https://xie.infoq.cn/copyright>https://xie.infoq.cn/copyright</a></p> <div class=highlight><pre><span></span><code>&lt;a rel=&quot;license&quot; href=&quot;http://creativecommons.org/licenses/by-nc-nd/4.0/&quot;&gt;&lt;img alt=&quot;Creative Commons License&quot; style=&quot;border-width:0&quot; src=&quot;https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png&quot; /&gt;&lt;/a&gt;&lt;br /&gt;This work is licensed under a &lt;a rel=&quot;license&quot; href=&quot;http://creativecommons.org/licenses/by-nc-nd/4.0/&quot;&gt;Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License&lt;/a&gt;.
</code></pre></div> <p><a href=http://creativecommons.org/licenses/by-nc-nd/4.0/ rel=license><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png></a><br>This work is licensed under a <a href=http://creativecommons.org/licenses/by-nc-nd/4.0/ rel=license>Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.</p> <p>基於 CC 4.0 協議進行如下類型授權：</p> <ul> <li>CC BY（署名）：只要在使用時署名，那麼使用者可以對本創作進行轉載、節選、混編、二次創作以及商業目的使用。</li> <li>CC BY-NC（署名+ 非盈利）：只要在使用、公開時進行署名，那麼使用者可以對本創作進行轉載、節選、混編、二次創作，但不得將本創作或由本創作衍生的創作運用於商業目的。</li> <li>CC BY-ND（署名 + 禁止演繹）：只要在使用、公開時進行署名，並且對創作不加任何改動，那麼使用者可以使用本創作，包括將其運用於商業目的。</li> <li><a href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh_TW>CC BY-NC-ND</a>（署名 + 非盈利 + 禁止演繹）：使用者可以對本創作進行轉載，但不得對本創作進行修改，亦不得依據本創作進行再創作，不得將本創作運用於商業用途。</li> <li>CC BY-SA（署名+ 繼承）：使用者可以對本創作進行轉載、節選、混編、二次創作，可以將其運用於商業用途，唯須署名作者，並且採用本創作的內容必須同樣採用本協議進行授權。</li> <li>CC BY-NC-SA（署名+ 非盈利+ 繼承）：使用者可以對本創作進行轉載、節選、混編、二次創作，但不得運用於商業目的，且使用時須進行署名，採用本創作的內容必須同樣採用本協議進行授權。</li> </ul> <h2 id=2020-08-05>2020-08-05<a class=headerlink href=#2020-08-05 title="Permanent link">&para;</a></h2> <h3 id=no-more-google-google-alternatives>No more google - Google alternatives<a class=headerlink href=#no-more-google-google-alternatives title="Permanent link">&para;</a></h3> <p><a href=https://nomoregoogle.com/ >https://nomoregoogle.com/</a></p> <blockquote> <p>Privacy-friendly alternatives to Google that don't track you</p> </blockquote> <h2 id=2020-08-03>2020-08-03<a class=headerlink href=#2020-08-03 title="Permanent link">&para;</a></h2> <h3 id=service-mesh>Service mesh<a class=headerlink href=#service-mesh title="Permanent link">&para;</a></h3> <p><a href="https://www.youtube.com/watch?v=-KWvlW9CSn8">https://www.youtube.com/watch?v=-KWvlW9CSn8</a></p> <ul> <li>Istio</li> <li>Linkerd</li> <li>Kuma</li> <li>Mosn</li> </ul> <h2 id=2020-07-30>2020-07-30<a class=headerlink href=#2020-07-30 title="Permanent link">&para;</a></h2> <h3 id=grouped-bar-chart-online>製作 grouped bar chart online<a class=headerlink href=#grouped-bar-chart-online title="Permanent link">&para;</a></h3> <p><a href="https://codepen.io/pen/?&editable=true=https%3A%2F%2Fwww.highcharts.com%2Fsamples%2Fhighcharts%2Fdemo%2Fcolumn-basic%3Fcodepen">https://codepen.io/pen/?&amp;editable=true=https%3A%2F%2Fwww.highcharts.com%2Fsamples%2Fhighcharts%2Fdemo%2Fcolumn-basic%3Fcodepen</a> <a href=https://www.highcharts.com/demo>https://www.highcharts.com/demo</a></p> <h2 id=2020-07-24>2020-07-24<a class=headerlink href=#2020-07-24 title="Permanent link">&para;</a></h2> <h3 id=ab-load-testing-in-alpine-linux>AB load testing in Alpine Linux<a class=headerlink href=#ab-load-testing-in-alpine-linux title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>apk<span class=w> </span>add<span class=w> </span>apache2-utils
ab<span class=w> </span>-n1000<span class=w> </span>-c10<span class=w> </span>-k<span class=w> </span>http://localhost/
</code></pre></div> <h3 id=to-generate-ecdsa-p-256-certificate-with-step-cli>To generate ECDSA P-256 certificate with step-cli<a class=headerlink href=#to-generate-ecdsa-p-256-certificate-with-step-cli title="Permanent link">&para;</a></h3> <p>step-cli: <a href=https://smallstep.com/cli/ >https://smallstep.com/cli/</a> <div class=highlight><pre><span></span><code>brew install step
</code></pre></div></p> <p>ref: <a href=https://linkerd.io/2/tasks/generate-certificates/#trust-anchor-certificate>https://linkerd.io/2/tasks/generate-certificates/#trust-anchor-certificate</a> <div class=highlight><pre><span></span><code>step certificate create identity.linkerd.cluster.local ca.crt ca.key \
--profile root-ca --no-password --insecure
</code></pre></div></p> <h3 id=import-ssl-cert-to-kubernetes-secret>Import ssl cert to kubernetes secret<a class=headerlink href=#import-ssl-cert-to-kubernetes-secret title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>cat<span class=w> </span>34_120_61_244.crt<span class=w> </span>IntermediateCA.crt<span class=w> </span>&gt;<span class=w> </span>ip.crt

kubectl<span class=w> </span>create<span class=w> </span>secret<span class=w> </span>tls<span class=w> </span>web-ip1<span class=w> </span><span class=se>\</span>
<span class=w>  </span>--cert<span class=w> </span>34_120_61_244.crt<span class=w> </span><span class=se>\</span>
<span class=w>  </span>--key<span class=w> </span>34_120_61_244.key<span class=w> </span><span class=se>\</span>
<span class=w>  </span>-n<span class=w> </span>web
</code></pre></div> <p>update cert <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>create<span class=w> </span>secret<span class=w> </span>tls<span class=w> </span>web-ip1<span class=w> </span><span class=se>\</span>
<span class=w>  </span>--cert<span class=w> </span>34_120_61_244.crt<span class=w> </span><span class=se>\</span>
<span class=w>  </span>--key<span class=w> </span>34_120_61_244.key<span class=w> </span><span class=se>\</span>
<span class=w>  </span>-n<span class=w> </span>web<span class=w> </span>--dry-run<span class=w> </span>-o<span class=w> </span>yaml<span class=w> </span><span class=se>\</span>
<span class=w>  </span><span class=p>|</span><span class=w> </span>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>-
</code></pre></div></p> <h2 id=2020-07-22>2020-07-22<a class=headerlink href=#2020-07-22 title="Permanent link">&para;</a></h2> <h3 id=nginx-access-control-allow-origin>Nginx - Access-Control-Allow-Origin: *<a class=headerlink href=#nginx-access-control-allow-origin title="Permanent link">&para;</a></h3> <p>Good <div class=highlight><pre><span></span><code>        more_set_headers                &quot;Access-Control-Allow-Origin: $http_origin&quot;;
</code></pre></div></p> <p>Bad <div class=highlight><pre><span></span><code>        more_set_headers                &quot;Access-Control-Allow-Origin: *&quot;;
</code></pre></div></p> <h2 id=2020-07-14>2020-07-14<a class=headerlink href=#2020-07-14 title="Permanent link">&para;</a></h2> <h3 id=is-possible-to-use-ip-address-in-managedcertificate-in-gke>Is possible to use ip address in ManagedCertificate in GKE?<a class=headerlink href=#is-possible-to-use-ip-address-in-managedcertificate-in-gke title="Permanent link">&para;</a></h3> <p>No.</p> <div class="admonition error"> <p class=admonition-title>Error</p> <div class=highlight><pre><span></span><code>The ManagedCertificate &quot;my-ip1&quot; is invalid: spec.domains: Invalid value: &quot;&quot;: spec.domains in body should match &#39;^(([a-zA-Z0-9]+|[a-zA-Z0-9][-a-zA-Z0-9]*[a-zA-Z0-9])\.)+[a-zA-Z][-a-zA-Z0-9]*[a-zA-Z0-9]\.?$&#39;
</code></pre></div> </div> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">networking.gke.io/v1beta2</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ManagedCertificate</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-ip1</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>domains</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;34.120.100.100&quot;</span>
</code></pre></div> <h2 id=2020-07-06>2020-07-06<a class=headerlink href=#2020-07-06 title="Permanent link">&para;</a></h2> <h3 id=nginx-as-an-forward-proxy-server>Nginx - as an forward proxy server<a class=headerlink href=#nginx-as-an-forward-proxy-server title="Permanent link">&para;</a></h3> <p><a href=https://www.alibabacloud.com/blog/how-to-use-nginx-as-an-https-forward-proxy-server_595799>https://www.alibabacloud.com/blog/how-to-use-nginx-as-an-https-forward-proxy-server_595799</a> <div class=highlight><pre><span></span><code>server {
     listen  443;

     # dns resolver used by forward proxying
     resolver  114.114.114.114;

     # forward proxy for CONNECT request
     proxy_connect;
     proxy_connect_allow            443;
     proxy_connect_connect_timeout  10s;
     proxy_connect_read_timeout     10s;
     proxy_connect_send_timeout     10s;

     # forward proxy for non-CONNECT request
     location / {
         proxy_pass http://$host;
         proxy_set_header Host $host;
     }
}
</code></pre></div></p> <div class=highlight><pre><span></span><code>curl<span class=w> </span>https://www.baidu.com<span class=w> </span>-svo<span class=w> </span>/dev/null<span class=w> </span>-x<span class=w> </span><span class=m>39</span>.105.196.164:443
</code></pre></div> <h2 id=2020-06-30>2020-06-30<a class=headerlink href=#2020-06-30 title="Permanent link">&para;</a></h2> <h3 id=github-api-delete-branch-with-personal-access-token>Github API - Delete branch with Personal Access Token<a class=headerlink href=#github-api-delete-branch-with-personal-access-token title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>export</span><span class=w> </span><span class=nv>INPUT_AUTH_TOKEN</span><span class=o>=</span>
<span class=nb>export</span><span class=w> </span><span class=nv>GITHUB_REPOSITORY</span><span class=o>=</span>
<span class=nb>export</span><span class=w> </span><span class=nv>GITHUB_HEAD_REF</span><span class=o>=</span>

http<span class=w> </span>DELETE<span class=w> </span><span class=s2>&quot;https://api.github.com/repos/</span><span class=nv>$GITHUB_REPOSITORY</span><span class=s2>/git/refs/heads/</span><span class=nv>$GITHUB_HEAD_REF</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<span class=w>    </span><span class=s2>&quot;Authorization: token </span><span class=nv>$INPUT_AUTH_TOKEN</span><span class=s2>&quot;</span>
</code></pre></div> <h2 id=2020-06-24>2020-06-24<a class=headerlink href=#2020-06-24 title="Permanent link">&para;</a></h2> <h3 id=linux-get-geo-infomation-in-curl>Linux - Get Geo infomation in curl<a class=headerlink href=#linux-get-geo-infomation-in-curl title="Permanent link">&para;</a></h3> <p><div class=highlight><pre><span></span><code>curl<span class=w> </span>https://ipinfo.io/
<span class=o>{</span>
<span class=w>  </span><span class=s2>&quot;ip&quot;</span>:<span class=w> </span><span class=s2>&quot;59.124.114.73&quot;</span>,
<span class=w>  </span><span class=s2>&quot;hostname&quot;</span>:<span class=w> </span><span class=s2>&quot;59-124-114-73.hinet-ip.hinet.net&quot;</span>,
<span class=w>  </span><span class=s2>&quot;city&quot;</span>:<span class=w> </span><span class=s2>&quot;Taipei&quot;</span>,
<span class=w>  </span><span class=s2>&quot;region&quot;</span>:<span class=w> </span><span class=s2>&quot;Taiwan&quot;</span>,
<span class=w>  </span><span class=s2>&quot;country&quot;</span>:<span class=w> </span><span class=s2>&quot;TW&quot;</span>,
<span class=w>  </span><span class=s2>&quot;loc&quot;</span>:<span class=w> </span><span class=s2>&quot;25.0478,121.5319&quot;</span>,
<span class=w>  </span><span class=s2>&quot;org&quot;</span>:<span class=w> </span><span class=s2>&quot;AS3462 Data Communication Business Group&quot;</span>,
<span class=w>  </span><span class=s2>&quot;timezone&quot;</span>:<span class=w> </span><span class=s2>&quot;Asia/Taipei&quot;</span>,
<span class=w>  </span><span class=s2>&quot;readme&quot;</span>:<span class=w> </span><span class=s2>&quot;https://ipinfo.io/missingauth&quot;</span>
<span class=o>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code>curl<span class=w> </span>ifconfig.co/json
<span class=o>{</span>
<span class=w>    </span><span class=s2>&quot;asn&quot;</span>:<span class=w> </span><span class=s2>&quot;AS3462&quot;</span>,
<span class=w>    </span><span class=s2>&quot;asn_org&quot;</span>:<span class=w> </span><span class=s2>&quot;Data Communication Business Group&quot;</span>,
<span class=w>    </span><span class=s2>&quot;city&quot;</span>:<span class=w> </span><span class=s2>&quot;Taipei&quot;</span>,
<span class=w>    </span><span class=s2>&quot;country&quot;</span>:<span class=w> </span><span class=s2>&quot;Taiwan&quot;</span>,
<span class=w>    </span><span class=s2>&quot;country_eu&quot;</span>:<span class=w> </span>false,
<span class=w>    </span><span class=s2>&quot;country_iso&quot;</span>:<span class=w> </span><span class=s2>&quot;TW&quot;</span>,
<span class=w>    </span><span class=s2>&quot;hostname&quot;</span>:<span class=w> </span><span class=s2>&quot;59-124-114-73.HINET-IP.hinet.net&quot;</span>,
<span class=w>    </span><span class=s2>&quot;ip&quot;</span>:<span class=w> </span><span class=s2>&quot;59.124.114.73&quot;</span>,
<span class=w>    </span><span class=s2>&quot;ip_decimal&quot;</span>:<span class=w> </span><span class=m>998011465</span>,
<span class=w>    </span><span class=s2>&quot;latitude&quot;</span>:<span class=w> </span><span class=m>25</span>.0478,
<span class=w>    </span><span class=s2>&quot;longitude&quot;</span>:<span class=w> </span><span class=m>121</span>.5318,
<span class=w>    </span><span class=s2>&quot;region_code&quot;</span>:<span class=w> </span><span class=s2>&quot;TPE&quot;</span>,
<span class=w>    </span><span class=s2>&quot;region_name&quot;</span>:<span class=w> </span><span class=s2>&quot;Taipei City&quot;</span>,
<span class=w>    </span><span class=s2>&quot;time_zone&quot;</span>:<span class=w> </span><span class=s2>&quot;Asia/Taipei&quot;</span>,
<span class=w>    </span><span class=s2>&quot;user_agent&quot;</span>:<span class=w> </span><span class=o>{</span>
<span class=w>        </span><span class=s2>&quot;product&quot;</span>:<span class=w> </span><span class=s2>&quot;HTTPie&quot;</span>,
<span class=w>        </span><span class=s2>&quot;raw_value&quot;</span>:<span class=w> </span><span class=s2>&quot;HTTPie/1.0.2&quot;</span>,
<span class=w>        </span><span class=s2>&quot;version&quot;</span>:<span class=w> </span><span class=s2>&quot;1.0.2&quot;</span>
<span class=w>    </span><span class=o>}</span>
<span class=o>}</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code>curl<span class=w> </span>-s<span class=w> </span>https://ipvigilante.com/<span class=k>$(</span>curl<span class=w> </span>-s<span class=w> </span>https://ipinfo.io/ip<span class=k>)</span>
<span class=o>{</span><span class=s2>&quot;status&quot;</span>:<span class=s2>&quot;success&quot;</span>,<span class=s2>&quot;data&quot;</span>:<span class=o>{</span><span class=s2>&quot;ipv4&quot;</span>:<span class=s2>&quot;59.124.114.73&quot;</span>,<span class=s2>&quot;continent_name&quot;</span>:<span class=s2>&quot;Asia&quot;</span>,<span class=s2>&quot;country_name&quot;</span>:<span class=s2>&quot;Taiwan&quot;</span>,<span class=s2>&quot;subdivision_1_name&quot;</span>:null,<span class=s2>&quot;subdivision_2_name&quot;</span>:null,<span class=s2>&quot;city_name&quot;</span>:null,<span class=s2>&quot;latitude&quot;</span>:<span class=s2>&quot;23.50000&quot;</span>,<span class=s2>&quot;longitude&quot;</span>:<span class=s2>&quot;121.00000&quot;</span><span class=o>}}</span>
</code></pre></div> <h3 id=nginx-ingress-will-use-default-fake-certificate>Nginx Ingress will use default fake certificate<a class=headerlink href=#nginx-ingress-will-use-default-fake-certificate title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1beta1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">staging</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">demo</span>
<span class=w>  </span><span class=nt>annotations</span><span class=p>:</span>
<span class=w>    </span><span class=nt>kubernetes.io/ingress.class</span><span class=p>:</span><span class=w> </span><span class=s>&quot;nginx&quot;</span>
<span class=w>    </span><span class=nt>nginx.ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span><span class=w> </span><span class=s>&quot;false&quot;</span><span class=w> </span><span class=c1># Default:true</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>tls</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">staging-tls</span>
<span class=w>  </span><span class=nt>rules</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>http</span><span class=p>:</span>
<span class=w>      </span><span class=nt>paths</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>backend</span><span class=p>:</span>
<span class=w>          </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">demo-web</span>
<span class=w>          </span><span class=nt>servicePort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
</code></pre></div> <div class=highlight><pre><span></span><code>curl<span class=w> </span>-kvL<span class=w> </span>https://api.r-live.swaggg.dev

*<span class=w> </span>Server<span class=w> </span>certificate:
*<span class=w>  </span>subject:<span class=w> </span><span class=nv>O</span><span class=o>=</span>Acme<span class=w> </span>Co<span class=p>;</span><span class=w> </span><span class=nv>CN</span><span class=o>=</span>Kubernetes<span class=w> </span>Ingress<span class=w> </span>Controller<span class=w> </span>Fake<span class=w> </span>Certificate
*<span class=w>  </span>start<span class=w> </span>date:<span class=w> </span>Jun<span class=w> </span><span class=m>24</span><span class=w> </span><span class=m>04</span>:25:00<span class=w> </span><span class=m>2020</span><span class=w> </span>GMT
*<span class=w>  </span>expire<span class=w> </span>date:<span class=w> </span>Jun<span class=w> </span><span class=m>24</span><span class=w> </span><span class=m>04</span>:25:00<span class=w> </span><span class=m>2021</span><span class=w> </span>GMT
*<span class=w>  </span>issuer:<span class=w> </span><span class=nv>O</span><span class=o>=</span>Acme<span class=w> </span>Co<span class=p>;</span><span class=w> </span><span class=nv>CN</span><span class=o>=</span>Kubernetes<span class=w> </span>Ingress<span class=w> </span>Controller<span class=w> </span>Fake<span class=w> </span>Certificate
*<span class=w>  </span>SSL<span class=w> </span>certificate<span class=w> </span>verify<span class=w> </span>result:<span class=w> </span>unable<span class=w> </span>to<span class=w> </span>get<span class=w> </span><span class=nb>local</span><span class=w> </span>issuer<span class=w> </span>certificate<span class=w> </span><span class=o>(</span><span class=m>20</span><span class=o>)</span>,<span class=w> </span>continuing<span class=w> </span>anyway.
</code></pre></div> <h2 id=2020-06-23>2020-06-23<a class=headerlink href=#2020-06-23 title="Permanent link">&para;</a></h2> <h3 id=intall-google-cloud-sdk-in-docker-image>Intall Google Cloud SDK in docker image<a class=headerlink href=#intall-google-cloud-sdk-in-docker-image title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=k>FROM</span><span class=w> </span><span class=s>docker:stable</span>

<span class=k>RUN</span><span class=w> </span><span class=se>\</span>
<span class=w>    </span>apk<span class=w> </span>add<span class=w> </span>curl<span class=w> </span>bash<span class=w> </span>python<span class=w> </span>git<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<span class=w>    </span>curl<span class=w> </span>https://sdk.cloud.google.com<span class=w> </span><span class=p>|</span><span class=w> </span>bash<span class=w> </span>-s<span class=w> </span>--<span class=w> </span>--disable-prompts

<span class=k>ENV</span><span class=w> </span>PATH<span class=w> </span><span class=nv>$PATH</span>:/root/google-cloud-sdk/bin
</code></pre></div> <h3 id=linux-get-external-ip-in-curl-cli>Linux - Get external ip in curl cli<a class=headerlink href=#linux-get-external-ip-in-curl-cli title="Permanent link">&para;</a></h3> <p>ref: <a href=https://www.tecmint.com/find-linux-server-public-ip-address/ >https://www.tecmint.com/find-linux-server-public-ip-address/</a> <div class=highlight><pre><span></span><code>$<span class=w> </span>curl<span class=w> </span>ifconfig.co
$<span class=w> </span>curl<span class=w> </span>ifconfig.me
$<span class=w> </span>curl<span class=w> </span>icanhazip.com
$<span class=w> </span>curl<span class=w> </span>https://ipinfo.io/ip
</code></pre></div></p> <h3 id=kubernetes-gkegcp-proxy-to-internal-load-balancer>Kubernetes - GKE/GCP proxy to internal load balancer<a class=headerlink href=#kubernetes-gkegcp-proxy-to-internal-load-balancer title="Permanent link">&para;</a></h3> <ul> <li><a href=https://cloud.google.com/kubernetes-engine/docs/how-to/internal-load-balancing>https://cloud.google.com/kubernetes-engine/docs/how-to/internal-load-balancing</a></li> <li><a href=https://cloud.google.com/kubernetes-engine/docs/how-to/internal-load-balancing#global_access>https://cloud.google.com/kubernetes-engine/docs/how-to/internal-load-balancing#global_access</a></li> </ul> <p>Internal load balancer <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ilb-api</span>
<span class=w>  </span><span class=nt>annotations</span><span class=p>:</span>
<span class=w>    </span><span class=nt>cloud.google.com/load-balancer-type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Internal&quot;</span>

<span class=w>    </span><span class=c1># This is beta. So it needs to follow this: https://stackoverflow.com/a/59658742/3854890</span>
<span class=w>    </span><span class=c1># gcloud beta compute forwarding-rules update xxxxx --region us-central1 --allow-global-access</span>
<span class=w>    </span><span class=c1># networking.gke.io/internal-load-balancer-allow-global-access: &quot;true&quot; # This is for same VPC different region.</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>externalTrafficPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Local</span>
<span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
<span class=w>  </span><span class=nt>selector</span><span class=p>:</span>
<span class=w>    </span><span class=nt>role</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">api</span>
<span class=w>  </span><span class=nt>ports</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class=w>    </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
</code></pre></div></p> <p>Proxy service to internal load balancer <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">api-proxy</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>ports</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>

<span class=nn>---</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Endpoints</span>
<span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">api-proxy</span>
<span class=nt>subsets</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>addresses</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>ip</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10.100.0.100</span>
<span class=w>    </span><span class=nt>ports</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div></p> <h3 id=gke-internal-load-balancer-dont-need-extra-firewalls>GKE - Internal Load Balancer don't need extra firewalls<a class=headerlink href=#gke-internal-load-balancer-dont-need-extra-firewalls title="Permanent link">&para;</a></h3> <p>ref: <a href=https://cloud.google.com/kubernetes-engine/docs/how-to/internal-load-balancing#global_access>https://cloud.google.com/kubernetes-engine/docs/how-to/internal-load-balancing#global_access</a></p> <p>no need to add additional firewalls. Default can access same region+project Internal Load Balancer.</p> <ul> <li>Without global access, traffic originating from clients in your VPC network must be in the same region as the load balancer.</li> <li>Global access is enabled per-Service using the following <code>annotation: networking.gke.io/internal-load-balancer-allow-global-access: "true".</code></li> <li>Global access is available in Beta on GKE clusters 1.16 and up.</li> </ul> <h2 id=2020-06-18>2020-06-18<a class=headerlink href=#2020-06-18 title="Permanent link">&para;</a></h2> <h3 id=linux-adduser-without-prompts>Linux - adduser without prompts<a class=headerlink href=#linux-adduser-without-prompts title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>adduser<span class=w> </span>runner<span class=w> </span>--disabled-password<span class=w>  </span>--gecos<span class=w> </span><span class=s2>&quot;&quot;</span>
</code></pre></div> <h3 id=linux-add-sudoer-group-to-user>Linux - Add sudoer group to user<a class=headerlink href=#linux-add-sudoer-group-to-user title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;runner ALL=(ALL) NOPASSWD: ALL&quot;</span><span class=w> </span>&gt;&gt;<span class=w> </span>/etc/sudoers<span class=w> </span><span class=o>&amp;&amp;</span><span class=se>\</span>
usermod<span class=w> </span>-aG<span class=w> </span>sudo<span class=w> </span>runner
</code></pre></div> <h3 id=github-action-runner-fix-gifsicle-command-failed>Github Action Runner - Fix gifsicle: Command failed<a class=headerlink href=#github-action-runner-fix-gifsicle-command-failed title="Permanent link">&para;</a></h3> <div class="admonition solution"> <p class=admonition-title>Solution</p> <p>ref: <a href=https://github.com/imagemin/imagemin-gifsicle/issues/37#issuecomment-577889854>https://github.com/imagemin/imagemin-gifsicle/issues/37#issuecomment-577889854</a> <div class=highlight><pre><span></span><code>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span>autoconf<span class=w> </span>automake<span class=w> </span>libtool<span class=w> </span>dh-autoreconf
</code></pre></div></p> </div> <div class=highlight><pre><span></span><code>error /home/runner/_work/runner-demo/node_modules/gifsicle: Command failed.
Exit code: 1
Command: node lib/install.js
info Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.
Arguments:
Directory: /home/runner/_work/runner-demo/node_modules/gifsicle
Output:
⚠ Response code 404 (Not Found)
  ⚠ gifsicle pre-build test failed
  ℹ compiling from source
  ✖ Error: Command failed: /bin/sh -c ./configure --disable-gifview --disable-gifdiff --prefix=&quot;/home/runner/_work/runner-demo/node_modules/gifsicle/vendor&quot; --bindir=&quot;/home/runner/_work/runner-demo/node_modules/gifsicle/vendor&quot;
config.status: error: in `/tmp/ee647f58-0c5e-49d4-995d-bf84ec21ed4e&#39;:
config.status: error: Something went wrong bootstrapping makefile fragments
</code></pre></div> <h2 id=2020-06-11>2020-06-11<a class=headerlink href=#2020-06-11 title="Permanent link">&para;</a></h2> <h3 id=failed-to-determine-a-valid-solver-configuration-for-the-set-of-domains-on-the-order-no-configured-challenge-solvers-can-be-used-for-this-challenge>Failed to determine a valid solver configuration for the set of domains on the Order: no configured challenge solvers can be used for this challenge<a class=headerlink href=#failed-to-determine-a-valid-solver-configuration-for-the-set-of-domains-on-the-order-no-configured-challenge-solvers-can-be-used-for-this-challenge title="Permanent link">&para;</a></h3> <p>That's because Let's encrypt HTTP01 doesn't support wildcard(*) domains.</p> <p>So, we can't use <code>*.rammus.cf</code> in</p> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cert-manager.io/v1alpha2</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Issuer</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>acme</span><span class=p>:</span>
<span class=w>    </span><span class=nt>email</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus@rammus.cf</span>
<span class=w>    </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://acme-v02.api.letsencrypt.org/directory</span>
<span class=w>    </span><span class=nt>privateKeySecretRef</span><span class=p>:</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus</span>
<span class=w>    </span><span class=nt>solvers</span><span class=p>:</span>
<span class=w>    </span><span class="l l-Scalar l-Scalar-Plain"><ins class=critic>- http01:</ins></span>
<span class=w>       </span><span class="l l-Scalar l-Scalar-Plain">ingress</span><span class="p p-Indicator">:</span>
<span class=w>         </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class=nn>---</span>
<span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cert-manager.io/v1alpha2</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Certificate</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus-tls</span>
<span class=w>  </span><span class=nt>issuerRef</span><span class=p>:</span>
<span class=w>    </span><span class=c1># The issuer created previously</span>
<span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Issuer</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus</span>
<span class=w>  </span><span class=nt>dnsNames</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&#39;rammus.cf&#39;</span>
<span class=w>  </span><span class="l l-Scalar l-Scalar-Plain"><del class=critic>- &#39;*.rammus.cf&#39;</del></span>
<span class=w>  </span><span class="l l-Scalar l-Scalar-Plain"><ins class=critic>- &#39;api.rammus.cf&#39;</ins></span>
</code></pre></div> <h2 id=2020-06-05>2020-06-05<a class=headerlink href=#2020-06-05 title="Permanent link">&para;</a></h2> <h3 id=gsutil-verify-a-google-service-account-with-docker-and-a-environment-variable>gsutil - Verify a google service account with docker and a environment variable<a class=headerlink href=#gsutil-verify-a-google-service-account-with-docker-and-a-environment-variable title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>docker<span class=w> </span>run<span class=w> </span>-it<span class=w> </span>--rm<span class=w> </span>--entrypoint<span class=w> </span>bash<span class=w> </span>gcr.io/cloud-builders/gsutil
<span class=nv>sa</span><span class=o>=</span><span class=s1>&#39;{key.json,....}&#39;</span>
gcloud<span class=w> </span>auth<span class=w> </span>activate-service-account<span class=w> </span>--key-file<span class=o>=</span>&lt;<span class=o>(</span><span class=nb>echo</span><span class=w> </span><span class=nv>$sa</span><span class=o>)</span>
gsutil<span class=w> </span>ls<span class=w> </span>gs://rammus.dev
</code></pre></div> <h2 id=2020-06-02>2020-06-02<a class=headerlink href=#2020-06-02 title="Permanent link">&para;</a></h2> <h3 id=kubernetes-get-client-ip-from-google-network-load-balancer>Kubernetes - Get client ip from Google Network Load Balancer<a class=headerlink href=#kubernetes-get-client-ip-from-google-network-load-balancer title="Permanent link">&para;</a></h3> <p><a href=https://kubernetes.io/docs/tutorials/services/source-ip/#source-ip-for-services-with-typeloadbalancer>https://kubernetes.io/docs/tutorials/services/source-ip/#source-ip-for-services-with-typeloadbalancer</a> <div class=highlight><pre><span></span><code><span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>externalTrafficPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Local</span>
<span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
</code></pre></div></p> <p>kubernetes issue: <a href=https://github.com/kubernetes/kubernetes/issues/10921>https://github.com/kubernetes/kubernetes/issues/10921</a></p> <h3 id=direct-server-return-dsr>Direct server return (DSR)<a class=headerlink href=#direct-server-return-dsr title="Permanent link">&para;</a></h3> <p><a href=https://blog.envoyproxy.io/introduction-to-modern-network-load-balancing-and-proxying-a57f6ff80236>https://blog.envoyproxy.io/introduction-to-modern-network-load-balancing-and-proxying-a57f6ff80236</a></p> <h2 id=2020-05-26>2020-05-26<a class=headerlink href=#2020-05-26 title="Permanent link">&para;</a></h2> <h3 id=nginx-get-request-connection-id>Nginx - get request connection id<a class=headerlink href=#nginx-get-request-connection-id title="Permanent link">&para;</a></h3> <p>ref: - <a href=https://stackoverflow.com/questions/17748735/setting-a-trace-id-in-nginx-load-balancer>https://stackoverflow.com/questions/17748735/setting-a-trace-id-in-nginx-load-balancer</a> - <a href=http://nginx.org/en/docs/http/ngx_http_upstream_module.html#keepalive>http://nginx.org/en/docs/http/ngx_http_upstream_module.html#keepalive</a> <div class=highlight><pre><span></span><code>    server {
      listen                          80 default_server deferred;

        set  $trace_id  $connection-$connection_requests;

        location / {
            proxy_set_header          Host &#39;api.swag.live&#39;;
            proxy_pass                https://api$request_uri;
            proxy_cache_key           api$request_uri;
            proxy_set_header X-Request-Id $trace_id;
        }
    }
</code></pre></div></p> <h3 id=nginx-proxy_set_header-will-diable-persistent-connection>Nginx - proxy_set_header will diable persistent connection<a class=headerlink href=#nginx-proxy_set_header-will-diable-persistent-connection title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>proxy_set_header
</code></pre></div> <div class=highlight><pre><span></span><code>      upstream swaglive {
        server                        swaglive.web;
        keepalive                     16;
        keepalive_requests            100000;
      }

      proxy_http_version              1.1;
      proxy_set_header                Connection &quot;&quot;;
</code></pre></div> <h3 id=html-expires-and-cache-control>HTML - Expires and Cache-Control<a class=headerlink href=#html-expires-and-cache-control title="Permanent link">&para;</a></h3> <p>Cache-Control &gt; Expires</p> <ul> <li>Expires: HTTP 1.0</li> <li>Cache-Control: HTTP 1.1</li> </ul> <p>ref: <a href=https://blog.techbridge.cc/2017/06/17/cache-introduction/ >https://blog.techbridge.cc/2017/06/17/cache-introduction/</a></p> <h2 id=2020-05-22>2020-05-22<a class=headerlink href=#2020-05-22 title="Permanent link">&para;</a></h2> <h3 id=nginx-use-http-header-as-variable>Nginx - use http header as variable<a class=headerlink href=#nginx-use-http-header-as-variable title="Permanent link">&para;</a></h3> <p><div class=highlight><pre><span></span><code>$http_name
</code></pre></div> ex: <div class=highlight><pre><span></span><code>$http_referer
$http_user_agent
$http_x_forwarded_for
</code></pre></div></p> <h3 id=nginx-ssl_do_handshake-failed-ssl-error1408f10bssl-routinesssl3_get_recordwrong-version-number-while-ssl-handshaking-to-upstream>Nginx - SSL_do_handshake() failed (SSL: error:1408F10B:SSL routines:SSL3_GET_RECORD:wrong version number) while SSL handshaking to upstream<a class=headerlink href=#nginx-ssl_do_handshake-failed-ssl-error1408f10bssl-routinesssl3_get_recordwrong-version-number-while-ssl-handshaking-to-upstream title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>       proxy_ssl_session_reuse off;
</code></pre></div> <h3 id=nginx-server-listen-80-default-deferred>Nginx - server listen 80 default deferred<a class=headerlink href=#nginx-server-listen-80-default-deferred title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>server {
  listen 80 default deferred;
  ...
}
</code></pre></div> <p>ref: <a href=https://stackoverflow.com/questions/8449058/what-does-the-deferred-option-mean-in-nginxs-listen-directive>https://stackoverflow.com/questions/8449058/what-does-the-deferred-option-mean-in-nginxs-listen-directive</a></p> <p>TCP_DEFER_ACCEPT can help boost performance by reducing the amount of preliminary formalities that happen between the server and client.</p> <blockquote> <p>"deferred" is Linux-only. For example on FreeBSD it won't work</p> </blockquote> <h3 id=nginx-print-cache-status-log>Nginx - Print cache status log<a class=headerlink href=#nginx-print-cache-status-log title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>    log_format  main  &#39;$remote_addr - $remote_user - $upstream_cache_status [$time_local] &quot;$request&quot; &#39;
                     &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;
                     &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;


    access_log  logs/access.log  main;
</code></pre></div> <h2 id=2020-05-20>2020-05-20<a class=headerlink href=#2020-05-20 title="Permanent link">&para;</a></h2> <h3 id=nginx-proxy_pass-cache-prority>Nginx - proxy_pass cache prority<a class=headerlink href=#nginx-proxy_pass-cache-prority title="Permanent link">&para;</a></h3> <ol> <li>proxy_cache_path inactive=10m</li> <li>Cache-Control: s-maxage</li> <li>Cache-Control: max-age</li> <li>proxy_cache_valid 200 2s;</li> </ol> <p><a href=https://github.com/RammusXu/toolkit/tree/master/docker/two-layer-nginx>https://github.com/RammusXu/toolkit/tree/master/docker/two-layer-nginx</a></p> <h2 id=2020-05-13>2020-05-13<a class=headerlink href=#2020-05-13 title="Permanent link">&para;</a></h2> <h3 id=probot-update-file-and-create-pull-request>Probot - update file and create pull request<a class=headerlink href=#probot-update-file-and-create-pull-request title="Permanent link">&para;</a></h3> <p><a href=https://github.com/octokit/rest.js/issues/845#issuecomment-386108187>https://github.com/octokit/rest.js/issues/845#issuecomment-386108187</a></p> <h2 id=2020-05-05>2020-05-05<a class=headerlink href=#2020-05-05 title="Permanent link">&para;</a></h2> <h3 id=got-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket-at-unixvarrundockersock-get-http2fvar2frun2fdockersockv140containersjson-dial-unix-varrundockersock-connect-permission-denied>Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.40/containers/json: dial unix /var/run/docker.sock: connect: permission denied<a class=headerlink href=#got-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket-at-unixvarrundockersock-get-http2fvar2frun2fdockersockv140containersjson-dial-unix-varrundockersock-connect-permission-denied title="Permanent link">&para;</a></h3> <div class="admonition solution"> <p class=admonition-title>Solution</p> <div class=highlight><pre><span></span><code>sudo chmod 777 /var/run/docker.sock
</code></pre></div> </div> <h3 id=install-docker-on-debian-linux>Install docker on Debian Linux<a class=headerlink href=#install-docker-on-debian-linux title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>apt-get<span class=w> </span>install<span class=w>     </span>apt-transport-https<span class=w>     </span>ca-certificates<span class=w>     </span>curl<span class=w>     </span>gnupg-agent<span class=w>     </span>software-properties-common
sudo<span class=w> </span>apt-key<span class=w> </span>fingerprint<span class=w> </span>0EBFCD88
sudo<span class=w> </span>add-apt-repository<span class=w>    </span><span class=s2>&quot;deb [arch=amd64] https://download.docker.com/linux/debian \</span>
<span class=s2>  </span><span class=k>$(</span>lsb_release<span class=w> </span>-cs<span class=k>)</span><span class=s2> \</span>
<span class=s2>  stable&quot;</span>
sudo<span class=w> </span>apt-get<span class=w> </span>update
sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>docker-ce<span class=w> </span>docker-ce-cli<span class=w> </span>containerd.io
docker<span class=w> </span>run<span class=w> </span>hello-world
</code></pre></div> <h3 id=ab-benchmark-is-using-1-core>ab benchmark is using 1 core<a class=headerlink href=#ab-benchmark-is-using-1-core title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>docker<span class=w> </span>run<span class=w> </span>--rm<span class=w> </span>russmckendrick/ab<span class=w> </span>ab<span class=w> </span>-k<span class=w> </span>-n<span class=w> </span><span class=m>20000</span><span class=w> </span>-c<span class=w> </span><span class=m>2000</span><span class=w> </span>https://rammus.cf/
</code></pre></div> <p>Better to use multi-thread benchmark tool <div class=highlight><pre><span></span><code>docker<span class=w> </span>run<span class=w> </span>--rm<span class=w> </span>williamyeh/wrk<span class=w> </span>-t10<span class=w> </span>-c500<span class=w> </span>-d30<span class=w> </span>--latency<span class=w> </span>https://rammus.cf
</code></pre></div></p> <div class=highlight><pre><span></span><code>apk add wrk
wrk -t10 -c500 -d30 --latency http://localhost:3000
</code></pre></div> <p>Can monitor this behavior with: <div class=highlight><pre><span></span><code>docker<span class=w> </span>stats
</code></pre></div></p> <p>ab will never over 100%, also need to care about how much resource you give it to docker machine.</p> <h2 id=2020-05-04>2020-05-04<a class=headerlink href=#2020-05-04 title="Permanent link">&para;</a></h2> <h3 id=pemission-denied-when-volumemounts-configmap-as-file>Pemission denied when volumeMounts configmap as file<a class=headerlink href=#pemission-denied-when-volumemounts-configmap-as-file title="Permanent link">&para;</a></h3> <p><a href=https://github.com/kubernetes/kubernetes/issues/71356>https://github.com/kubernetes/kubernetes/issues/71356</a></p> <div class=highlight><pre><span></span><code>     subprocess.call([&#39;./demo.sh&#39;])
   File &quot;/usr/local/lib/python3.8/subprocess.py&quot;, line 340, in call
     with Popen(*popenargs, **kwargs) as p:
   File &quot;/usr/local/lib/python3.8/subprocess.py&quot;, line 854, in __init__
     self._execute_child(args, executable, preexec_fn, close_fds,
   File &quot;/usr/local/lib/python3.8/subprocess.py&quot;, line 1702, in _execute_child
     raise child_exception_type(errno_num, err_msg, err_filename)
 PermissionError: [Errno 13] Permission denied: &#39;./demo.sh&#39;
</code></pre></div> <div class=highlight><pre><span></span><code><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tls-watch-config</span>
<span class=nt>data</span><span class=p>:</span>
<span class=w>  </span><span class=nt>app.py</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
<span class=w>    </span><span class=no>import subprocess</span>
<span class=w>        </span><span class=no>subprocess.call([&#39;./update-cert.sh&#39;, filename, target_proxy])</span>

<span class=w>  </span><span class=nt>update-cert.sh</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
<span class=w>    </span><span class=no>echo &#39;update&#39;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">workspace</span>
<span class=w>        </span><span class=nt>configMap</span><span class=p>:</span>
<span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tls-watcher-config</span>
<span class=w>          </span><span class=nt>defaultMode</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0555</span>

<span class=w>      </span><span class=nt>containers</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tls-watcher</span>
<span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">python:3.8-alpine3.11</span>
<span class=w>        </span><span class=nt>volumeMounts</span><span class=p>:</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">workspace</span>
<span class=w>          </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/workspace</span>
<span class=w>        </span><span class=nt>workingDir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/workspace</span>
<span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;sh&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;-c&quot;</span><span class="p p-Indicator">]</span>
<span class=w>        </span><span class=nt>args</span><span class=p>:</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="p p-Indicator">|</span>
<span class=w>          </span><span class=no>python -u app.py</span>
</code></pre></div> <h2 id=2020-04-30>2020-04-30<a class=headerlink href=#2020-04-30 title="Permanent link">&para;</a></h2> <h3 id=generate-an-unique-sha-from-multiple-file-in-mac>Generate an unique sha from multiple file in Mac<a class=headerlink href=#generate-an-unique-sha-from-multiple-file-in-mac title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>shasum *.json| shasum | cut -d&#39; &#39; -f1
</code></pre></div> <h2 id=2020-04-24>2020-04-24<a class=headerlink href=#2020-04-24 title="Permanent link">&para;</a></h2> <h3 id=nginx-could-not-find-named-location>Nginx: could not find named location<a class=headerlink href=#nginx-could-not-find-named-location title="Permanent link">&para;</a></h3> <blockquote> <p>2020/04/24 09:34:31 [error] 7#7: *58 could not find named location "@gcsfiles" while sending to client, client: 10.4.4.2, server:</p> </blockquote> <div class=highlight><pre><span></span><code>location ~* &#39;^/(js|img|locale)/&#39; {
  proxy_pass                      http://backend/$uri;
  proxy_cache_key                 rammus.cf$uri;
  add_header                      &quot;Cache-Control&quot; &quot;public, max-age=3600&quot;;
  add_header                      Strict-Transport-Security &quot;max-age=86400; includeSubDomains&quot; always;

  proxy_intercept_errors on;
  error_page                      404 = @gcsfiles;
}

location = @gcsfiles {
  proxy_pass                      http://gcs/rammus.cf$uri;
  proxy_cache_key                 $http_host$uri;

  # Enabled HSTS
  add_header                      Strict-Transport-Security &quot;max-age=86400; includeSubDomains&quot; always;
  add_header                      &quot;Cache-Control&quot; &quot;public, max-age=2592300&quot;;
}
</code></pre></div> <p>It should be <div class=highlight><pre><span></span><code><del class=critic>location = @gcsfiles {</del>
<ins class=critic>location @gcsfiles {</ins>
</code></pre></div> without <code>=</code></p> <h2 id=2020-04-17>2020-04-17<a class=headerlink href=#2020-04-17 title="Permanent link">&para;</a></h2> <h3 id=gke-ingress-with-managed-certificates>GKE ingress with managed-certificates<a class=headerlink href=#gke-ingress-with-managed-certificates title="Permanent link">&para;</a></h3> <p><div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1beta1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class=w>  </span><span class=nt>annotations</span><span class=p>:</span>
<span class=w>    </span><span class=c1># gcloud compute addresses create gclb-web --global</span>
<span class=w>    </span><span class=c1># gcloud compute addresses list</span>
<span class=w>    </span><span class=nt>networking.gke.io/static-ip</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span>

<span class=w>    </span><span class=c1># kubectl apply -f certificate.yaml</span>
<span class=w>    </span><span class=c1># gcloud compute ssl-certificates list</span>
<span class=w>    </span><span class=nt>networking.gke.io/managed-certificates</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus-cf</span>

<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>rules</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus.cf</span>
<span class=w>    </span><span class=nt>http</span><span class=p>:</span>
<span class=w>      </span><span class=nt>paths</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>backend</span><span class=p>:</span>
<span class=w>          </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-svc</span>
<span class=w>          </span><span class=nt>servicePort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>http</span><span class=p>:</span>
<span class=w>      </span><span class=nt>paths</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>backend</span><span class=p>:</span>
<span class=w>          </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-svc</span>
<span class=w>          </span><span class=nt>servicePort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">networking.gke.io/v1beta1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ManagedCertificate</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rammus-cf</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>domains</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;rammus.cf&quot;</span>
</code></pre></div></p> <h2 id=2020-04-07>2020-04-07<a class=headerlink href=#2020-04-07 title="Permanent link">&para;</a></h2> <h3 id=test-a-website-speed>Test a website speed<a class=headerlink href=#test-a-website-speed title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>docker run --rm -v &quot;$(pwd)&quot;:/sitespeed.io sitespeedio/sitespeed.io:12.3.1 https://app.swag.live
</code></pre></div> <h2 id=2020-03-14>2020-03-14<a class=headerlink href=#2020-03-14 title="Permanent link">&para;</a></h2> <h3 id=find-other-lan-users-ip>Find other LAN user's IP<a class=headerlink href=#find-other-lan-users-ip title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>arp -a
</code></pre></div> <h2 id=2020-03-13>2020-03-13<a class=headerlink href=#2020-03-13 title="Permanent link">&para;</a></h2> <h3 id=httpswww17cecom>中國的測速網站 <a href=https://www.17ce.com/ >https://www.17ce.com/</a><a class=headerlink href=#httpswww17cecom title="Permanent link">&para;</a></h3> <p>可以測試 CDN 效果</p> <ul> <li>benchmark</li> <li>warm up</li> </ul> <h2 id=2020-03-12>2020-03-12<a class=headerlink href=#2020-03-12 title="Permanent link">&para;</a></h2> <h3 id=dnsmasq-unsupported-option-check-that-dnsmasq-was-compiled-with-dhcptftpdnssecdbus-support>dnsmasq: unsupported option (check that dnsmasq was compiled with DHCP/TFTP/DNSSEC/DBus support)<a class=headerlink href=#dnsmasq-unsupported-option-check-that-dnsmasq-was-compiled-with-dhcptftpdnssecdbus-support title="Permanent link">&para;</a></h3> <div class="admonition solution"> <p class=admonition-title>Solution</p> <div class=highlight><pre><span></span><code>apk<span class=w> </span>--no-cache<span class=w> </span>add<span class=w> </span>dnsmasq-dnssec
</code></pre></div> </div> <p>這個錯誤發生在:</p> <ul> <li>使用 alpine linux <code>apk add dnsmasq</code></li> <li>Enable dnssec</li> </ul> <div class=highlight><pre><span></span><code><span class=c1># /etc/dnsmasq.conf</span>
dnssec
conf-file<span class=o>=</span>/usr/share/dnsmasq/trust-anchors.conf
dnssec-check-unsigned
</code></pre></div> <p>or <div class=highlight><pre><span></span><code># /etc/dnsmasq.conf
dnssec
trust-anchor=.,19036,8,2,49AAC11D7B6F6446702E54A1607371607A1A41855200FD2CE1CDDE32F24E8FB5
trust-anchor=.,20326,8,2,E06D44B80B8F1D39A95C0B0D7C65D08458E880409BBC683457104237C7F8EC8D
dnssec-check-unsigned
</code></pre></div></p> <div class="admonition success"> <p class=admonition-title>Success</p> <div class=highlight><pre><span></span><code>nsmasq_1<span class=w>  </span><span class=p>|</span><span class=w> </span>dnsmasq:<span class=w> </span>started,<span class=w> </span>version<span class=w> </span><span class=m>2</span>.80<span class=w> </span>cachesize<span class=w> </span><span class=m>150</span>
dnsmasq_1<span class=w>  </span><span class=p>|</span><span class=w> </span>dnsmasq:<span class=w> </span>compile<span class=w> </span><span class=nb>time</span><span class=w> </span>options:<span class=w> </span>IPv6<span class=w> </span>GNU-getopt<span class=w> </span>no-DBus<span class=w> </span>no-i18n<span class=w> </span>no-IDN<span class=w> </span>DHCP<span class=w> </span>DHCPv6<span class=w> </span>no-Lua<span class=w> </span>TFTP<span class=w> </span>no-conntrack<span class=w> </span>ipset<span class=w> </span>auth<span class=w> </span>DNSSEC<span class=w> </span>loop-detect<span class=w> </span>inotify<span class=w> </span>dumpfile
dnsmasq_1<span class=w>  </span><span class=p>|</span><span class=w> </span>dnsmasq:<span class=w> </span>DNSSEC<span class=w> </span>validation<span class=w> </span>enabled
dnsmasq_1<span class=w>  </span><span class=p>|</span><span class=w> </span>dnsmasq:<span class=w> </span>configured<span class=w> </span>with<span class=w> </span>trust<span class=w> </span>anchor<span class=w> </span><span class=k>for</span><span class=w> </span>&lt;root&gt;<span class=w> </span>keytag<span class=w> </span><span class=m>20326</span>
dnsmasq_1<span class=w>  </span><span class=p>|</span><span class=w> </span>dnsmasq:<span class=w> </span>configured<span class=w> </span>with<span class=w> </span>trust<span class=w> </span>anchor<span class=w> </span><span class=k>for</span><span class=w> </span>&lt;root&gt;<span class=w> </span>keytag<span class=w> </span><span class=m>19036</span>
</code></pre></div> </div> <h3 id=parsing-dnssec-anchors-in-shell-scriptbash>Parsing dnssec anchors in shell script(bash)<a class=headerlink href=#parsing-dnssec-anchors-in-shell-scriptbash title="Permanent link">&para;</a></h3> <p>ref:</p> <ul> <li><a href=https://stackoverflow.com/questions/19908777/curl-and-xmllint-pipe>https://stackoverflow.com/questions/19908777/curl-and-xmllint-pipe</a></li> <li><a href=https://data.iana.org/root-anchors/root-anchors.xml>https://data.iana.org/root-anchors/root-anchors.xml</a> <div class=highlight><pre><span></span><code>curl -s https://data.iana.org/root-anchors/root-anchors.xml | \
  xmllint --format --xpath &#39;concat(&quot;trust-anchor=.,&quot;, /TrustAnchor/KeyDigest[1]/KeyTag, &quot;,&quot;, /TrustAnchor/KeyDigest[1]/Algorithm, &quot;,&quot;,/TrustAnchor/KeyDigest[1]//DigestType, &quot;,&quot;, /TrustAnchor/KeyDigest[1]/Digest)&#39; -

curl -s https://data.iana.org/root-anchors/root-anchors.xml | \
  xmllint --format --xpath &#39;concat(&quot;trust-anchor=.,&quot;, /TrustAnchor/KeyDigest[2]/KeyTag, &quot;,&quot;, /TrustAnchor/KeyDigest[2]/Algorithm, &quot;,&quot;,/TrustAnchor/KeyDigest[2]//DigestType, &quot;,&quot;, /TrustAnchor/KeyDigest[2]/Digest)&#39; -
</code></pre></div></li> </ul> <h3 id=commands-of-testing-domain>Commands of testing domain<a class=headerlink href=#commands-of-testing-domain title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>apk<span class=w> </span>add<span class=w> </span>bind-tools
</code></pre></div> <div class=highlight><pre><span></span><code>nslookup<span class=w> </span>swag.live<span class=w> </span>localhost
nslookup<span class=w> </span>swag.live<span class=w> </span><span class=m>127</span>.0.0.1
</code></pre></div> <div class=highlight><pre><span></span><code>dig<span class=w> </span>@localhost<span class=w> </span>swag.live
dig<span class=w> </span>@127.0.0.1<span class=w> </span>swag.live
dig<span class=w> </span>@8.8.8.8<span class=w> </span>swag.live
</code></pre></div> <div class=highlight><pre><span></span><code>dig +trace swag.live
dig +short swag.live ns
</code></pre></div> <div class=highlight><pre><span></span><code>dig @dnsmasq +dnssec swag.live
dig @dnsmasq +dnssec google.com
</code></pre></div> <h2 id=2020-03-11>2020-03-11<a class=headerlink href=#2020-03-11 title="Permanent link">&para;</a></h2> <h3 id=check-multiple-variables-are-not-none-in-python>Check multiple variables are not None in Python<a class=headerlink href=#check-multiple-variables-are-not-none-in-python title="Permanent link">&para;</a></h3> <p>ref: <a href=https://stackoverflow.com/questions/42360956/what-is-the-most-pythonic-way-to-check-if-multiple-variables-are-not-none>https://stackoverflow.com/questions/42360956/what-is-the-most-pythonic-way-to-check-if-multiple-variables-are-not-none</a> <div class=highlight><pre><span></span><code><span class=n>params</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s1>&#39;PARAMS&#39;</span><span class=p>)</span>
<span class=n>sid</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s1>&#39;SID&#39;</span><span class=p>)</span>
<span class=n>skey</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s1>&#39;SKEY&#39;</span><span class=p>)</span>
<span class=k>if</span> <span class=kc>None</span> <span class=ow>in</span> <span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>sid</span><span class=p>,</span> <span class=n>skey</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Must have SID, SKEY, PARAMS&quot;</span><span class=p>)</span>
    <span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div></p> <h2 id=2020-03-10>2020-03-10<a class=headerlink href=#2020-03-10 title="Permanent link">&para;</a></h2> <h3 id=gcs-roles>GCS roles<a class=headerlink href=#gcs-roles title="Permanent link">&para;</a></h3> <p>Storage Object Admin <div class=highlight><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">resourcemanager.projects.get</span>
<span class="l l-Scalar l-Scalar-Plain">resourcemanager.projects.list</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.create</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.delete</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.get</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.getIamPolicy</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.list</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.setIamPolicy</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.update</span>
</code></pre></div></p> <p>Storage Object Creator <div class=highlight><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">resourcemanager.projects.get</span>
<span class="l l-Scalar l-Scalar-Plain">resourcemanager.projects.list</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.create</span>
</code></pre></div></p> <p>Storage Object Viewer <div class=highlight><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">resourcemanager.projects.get</span>
<span class="l l-Scalar l-Scalar-Plain">resourcemanager.projects.list</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.get</span>
<span class="l l-Scalar l-Scalar-Plain">storage.objects.list</span>
</code></pre></div></p> <h2 id=2020-03-09>2020-03-09<a class=headerlink href=#2020-03-09 title="Permanent link">&para;</a></h2> <h3 id=get-nth-line-of-stdout-on-linux>Get nth line of stdout on linux<a class=headerlink href=#get-nth-line-of-stdout-on-linux title="Permanent link">&para;</a></h3> <p>ref: <a href=https://stackoverflow.com/questions/1429556/command-to-get-nth-line-of-stdout>https://stackoverflow.com/questions/1429556/command-to-get-nth-line-of-stdout</a> <div class=highlight><pre><span></span><code>ls<span class=w> </span>-l<span class=w> </span><span class=p>|</span><span class=w> </span>sed<span class=w> </span>-n<span class=w> </span>2p
ls<span class=w> </span>-l<span class=w> </span><span class=p>|</span><span class=w> </span>head<span class=w> </span>-2<span class=w> </span><span class=p>|</span><span class=w> </span>tail<span class=w> </span>-1
</code></pre></div></p> <h3 id=sort-gcs-google-cloud-storage-objects-by-date>Sort GCS (google cloud storage) objects by date<a class=headerlink href=#sort-gcs-google-cloud-storage-objects-by-date title="Permanent link">&para;</a></h3> <p>ref: <a href=https://stackoverflow.com/a/51709554/3854890>https://stackoverflow.com/a/51709554/3854890</a> <div class=highlight><pre><span></span><code>gsutil<span class=w> </span>ls<span class=w> </span>-l<span class=w> </span>gs://<span class=o>[</span>bucket-name<span class=o>]</span>/<span class=w> </span><span class=p>|</span><span class=w> </span>sort<span class=w> </span>-r<span class=w> </span>-k<span class=w> </span><span class=m>2</span>
</code></pre></div> Example: <div class=highlight><pre><span></span><code>~<span class=w> </span>gsutil<span class=w> </span>ls<span class=w> </span>-l<span class=w> </span>gs://rammus.cf/download<span class=w> </span><span class=p>|</span><span class=w> </span>sort<span class=w> </span>-r<span class=w> </span>-k<span class=w> </span><span class=m>2</span>
<span class=w>  </span><span class=m>62786148</span><span class=w>  </span><span class=m>2020</span>-03-06T05:52:53Z<span class=w>  </span>gs://rammus.cf/download/3.0.2.8087.086886.apk
<span class=w>  </span><span class=m>62732280</span><span class=w>  </span><span class=m>2020</span>-03-04T03:07:33Z<span class=w>  </span>gs://rammus.cf/download/3.0.1-8070.apk
<span class=w>  </span><span class=m>62729059</span><span class=w>  </span><span class=m>2020</span>-03-02T16:25:22Z<span class=w>  </span>gs://rammus.cf/download/3_0_1_8ca354.apk
<span class=w>  </span><span class=m>11</span><span class=w>  </span><span class=m>2020</span>-03-02T16:25:03Z<span class=w>  </span>gs://rammus.cf/download/
</code></pre></div></p> <h3 id=measuring-kubernetes-dns>Measuring kubernetes dns<a class=headerlink href=#measuring-kubernetes-dns title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>bash-5.0#<span class=w> </span><span class=nb>time</span><span class=w> </span><span class=o>(</span><span class=k>for</span><span class=w> </span>i<span class=w> </span><span class=k>in</span><span class=w> </span><span class=o>{</span><span class=m>1</span>..100<span class=o>}</span><span class=p>;</span><span class=w> </span><span class=k>do</span><span class=w> </span>host<span class=w> </span>-U<span class=w> </span>echoserver.ops<span class=w> </span>&gt;<span class=w> </span>/dev/null<span class=w> </span><span class=p>;</span><span class=w> </span><span class=k>done</span><span class=o>)</span>

real<span class=w>    </span>0m1.150s
user<span class=w>    </span>0m0.445s
sys<span class=w> </span>0m0.278s
bash-5.0#<span class=w> </span><span class=nb>time</span><span class=w> </span><span class=o>(</span><span class=k>for</span><span class=w> </span>i<span class=w> </span><span class=k>in</span><span class=w> </span><span class=o>{</span><span class=m>1</span>..100<span class=o>}</span><span class=p>;</span><span class=w> </span><span class=k>do</span><span class=w> </span>host<span class=w> </span>-U<span class=w> </span>echoserver.ops.svc.cluster.local<span class=w> </span>&gt;<span class=w> </span>/dev/null<span class=w> </span><span class=p>;</span><span class=w> </span><span class=k>done</span><span class=o>)</span>

real<span class=w>    </span>0m1.762s
user<span class=w>    </span>0m0.463s
sys<span class=w> </span>0m0.362s
</code></pre></div> <div class=highlight><pre><span></span><code>bash-5.0#<span class=w> </span>host<span class=w> </span>-v<span class=w> </span>echoserver.ops
Trying<span class=w> </span><span class=s2>&quot;echoserver.ops.ops.svc.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;echoserver.ops.svc.cluster.local&quot;</span>
bash-5.0#<span class=w> </span>host<span class=w> </span>-v<span class=w> </span>echoserver.ops.svc.cluster.local
Trying<span class=w> </span><span class=s2>&quot;echoserver.ops.svc.cluster.local.ops.svc.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;echoserver.ops.svc.cluster.local.svc.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;echoserver.ops.svc.cluster.local.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;echoserver.ops.svc.cluster.local.google.internal&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;echoserver.ops.svc.cluster.local&quot;</span>

bash-5.0#<span class=w> </span>cat<span class=w> </span>/etc/resolv.conf
nameserver<span class=w> </span><span class=m>10</span>.24.0.10
search<span class=w> </span>ops.svc.cluster.local<span class=w> </span>svc.cluster.local<span class=w> </span>cluster.local<span class=w> </span>google.internal
options<span class=w> </span>ndots:5
</code></pre></div> <h2 id=2020-03-06>2020-03-06<a class=headerlink href=#2020-03-06 title="Permanent link">&para;</a></h2> <h3 id=how-does-udp-request-receiving-responses>How does UDP request receiving responses.<a class=headerlink href=#how-does-udp-request-receiving-responses title="Permanent link">&para;</a></h3> <ul> <li>SOCK_STREAM: TCP</li> <li>SOCK_DGRAM: UDP</li> </ul> <p><a href=https://stackoverflow.com/questions/1815030/receiving-a-response-through-udp>https://stackoverflow.com/questions/1815030/receiving-a-response-through-udp</a></p> <ol> <li>Client emits UDP packet.</li> <li>Router passes UDP packet to the Internet.</li> <li>Router remembers that client sent a UDP packet to server, and establishes a mapping in its memory.</li> <li>Server sends a UDP packet, probably on the same port.</li> <li>Router receives packet, and checks mapping to find client talked to server recently.</li> <li>Router passes packet to client.</li> </ol> <p><a href=https://ns1.com/resources/dns-protocol>https://ns1.com/resources/dns-protocol</a></p> <p>DNS communication occurs via two types of messages: queries and replies. Both DNS query format and reply format consist of the following sections:</p> <ul> <li>The header section contains Identification; Flags; Number of questions; Number of answers; Number of authority resource records (RRs); and Number of additional resource records.</li> <li>The flag field contains sections of one or four bits, indicating type of message, whether the name server is authoritative; whether the query is recursive or not, whether request was truncated, and status.</li> <li>The question section contains the domain name and type of record (A, AAAA, MX, TXT, etc.) being resolved. Each label in the domain name is prefixed by its length.</li> <li>The answer section has the resource records of the queried name.</li> </ul> <p><a href=http://www-inf.int-evry.fr/~hennequi/CoursDNS/NOTES-COURS_eng/msg.html>http://www-inf.int-evry.fr/~hennequi/CoursDNS/NOTES-COURS_eng/msg.html</a></p> <h3 id=weave-scope-kubernetes>Weave Scope - 監控 kubernetes 的工具<a class=headerlink href=#weave-scope-kubernetes title="Permanent link">&para;</a></h3> <p>ref: <a href=https://www.weave.works/docs/scope/latest/installing/#kubernetes>https://www.weave.works/docs/scope/latest/installing/#kubernetes</a></p> <p>安裝 Weave Scope <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span><span class=s2>&quot;https://cloud.weave.works/k8s/scope.yaml?k8s-version=</span><span class=k>$(</span>kubectl<span class=w> </span>version<span class=w> </span><span class=p>|</span><span class=w> </span>base64<span class=w> </span><span class=p>|</span><span class=w> </span>tr<span class=w> </span>-d<span class=w> </span><span class=s1>&#39;\n&#39;</span><span class=k>)</span><span class=s2>&quot;</span>
</code></pre></div> Expose 服務到 localhost <div class=highlight><pre><span></span><code>kubectl port-forward -n weave service/weave-scope-app 4040:80
open -a &quot;Google Chrome&quot; &quot;http://localhost:4040&quot;
</code></pre></div></p> <h2 id=2020-03-05>2020-03-05<a class=headerlink href=#2020-03-05 title="Permanent link">&para;</a></h2> <h3 id=try-to-resolve-a-domain-in-kubernetes>Try to resolve a domain in kubernetes<a class=headerlink href=#try-to-resolve-a-domain-in-kubernetes title="Permanent link">&para;</a></h3> <p>Default <code>/etc/resolv.conf</code> is like: <div class=highlight><pre><span></span><code>nameserver 10.24.0.10
search default.svc.cluster.local svc.cluster.local cluster.local google.internal
options ndots:5
</code></pre></div></p> <p>少於 5 個 dot (.) 將會先搜尋 <strong>search</strong> <code>default.svc.cluster.local svc.cluster.local cluster.local google.internal</code> <div class=highlight><pre><span></span><code>&gt;<span class=w> </span>host<span class=w> </span>-v<span class=w> </span>a.a.a.www.google.com
Trying<span class=w> </span><span class=s2>&quot;a.a.a.www.google.com&quot;</span>

&gt;<span class=w> </span>host<span class=w> </span>-v<span class=w> </span>a.a.www.google.com
Trying<span class=w> </span><span class=s2>&quot;a.a.www.google.com.ops.svc.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;a.a.www.google.com.svc.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;a.a.www.google.com.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;a.a.www.google.com.google.internal&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;a.a.www.google.com&quot;</span>

&gt;<span class=w> </span>host<span class=w> </span>-v<span class=w> </span>www.google.com
Trying<span class=w> </span><span class=s2>&quot;www.google.com.ops.svc.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;www.google.com.svc.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;www.google.com.cluster.local&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;www.google.com.google.internal&quot;</span>
Trying<span class=w> </span><span class=s2>&quot;www.google.com&quot;</span>
</code></pre></div></p> <h2 id=2020-03-04>2020-03-04<a class=headerlink href=#2020-03-04 title="Permanent link">&para;</a></h2> <h3 id=how-to-perform-ddos-test-as-a-pentester>how-to-perform-ddos-test-as-a-pentester<a class=headerlink href=#how-to-perform-ddos-test-as-a-pentester title="Permanent link">&para;</a></h3> <p><a href=https://pentest.blog/how-to-perform-ddos-test-as-a-pentester/ >https://pentest.blog/how-to-perform-ddos-test-as-a-pentester/</a></p> <h3 id=install-netstress-on-kali-linux>Install netstress on kali linux<a class=headerlink href=#install-netstress-on-kali-linux title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>apt-get<span class=w> </span>update
apt-get<span class=w> </span>install<span class=w> </span>netstress
</code></pre></div> <h3 id=run-kali-linux-on-kubernetes>Run kali linux on Kubernetes<a class=headerlink href=#run-kali-linux-on-kubernetes title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kali</span>
<span class=w>  </span><span class=nt>labels</span><span class=p>:</span>
<span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kali</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=c1>## Select node pool in GKE</span>
<span class=w>  </span><span class=c1># affinity:</span>
<span class=w>  </span><span class=c1>#   nodeAffinity:</span>
<span class=w>  </span><span class=c1>#     requiredDuringSchedulingIgnoredDuringExecution:</span>
<span class=w>  </span><span class=c1>#       nodeSelectorTerms:</span>
<span class=w>  </span><span class=c1>#       - matchExpressions:</span>
<span class=w>  </span><span class=c1>#         - key: cloud.google.com/gke-nodepool</span>
<span class=w>  </span><span class=c1>#           operator: In</span>
<span class=w>  </span><span class=c1>#           values:</span>
<span class=w>  </span><span class=c1>#           - &quot;pool-1&quot;</span>
<span class=w>  </span><span class=nt>containers</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kalilinux/kali</span>
<span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;/bin/sh&quot;</span><span class="p p-Indicator">,</span><span class=s>&quot;-c&quot;</span><span class="p p-Indicator">]</span>
<span class=w>    </span><span class=nt>args</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="p p-Indicator">|</span>
<span class=w>      </span><span class=no>tail -f /dev/null</span>
<span class=w>    </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kali</span>
<span class=w>  </span><span class=nt>restartPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Never</span>
</code></pre></div> <h3 id=gke-nodelocal-dnscache>GKE NodeLocal DNSCache<a class=headerlink href=#gke-nodelocal-dnscache title="Permanent link">&para;</a></h3> <p><a href=https://cloud.google.com/kubernetes-engine/docs/how-to/nodelocal-dns-cache>https://cloud.google.com/kubernetes-engine/docs/how-to/nodelocal-dns-cache</a></p> <ul> <li>Base on CoreDNS</li> </ul> <h3 id=install-dnsperf-on-alpine>Install dnsperf on alpine<a class=headerlink href=#install-dnsperf-on-alpine title="Permanent link">&para;</a></h3> <p>ref: - <a href=https://github.com/ssro/dnsperf/blob/master/Dockerfile>https://github.com/ssro/dnsperf/blob/master/Dockerfile</a> - <a href=https://github.com/guessi/docker-dnsperf/blob/master/bench/k8s-dnsperf-bench.yaml>https://github.com/guessi/docker-dnsperf/blob/master/bench/k8s-dnsperf-bench.yaml</a> <div class=highlight><pre><span></span><code><span class=nv>DNSPERF</span><span class=o>=</span>dnsperf-2.3.2
apk<span class=w> </span>add<span class=w> </span>--update<span class=w> </span>--no-cache<span class=w> </span>--virtual<span class=w> </span>deps<span class=w> </span>wget<span class=w> </span>g++<span class=w> </span>make<span class=w> </span>bind-dev<span class=w> </span>openssl-dev<span class=w> </span>libxml2-dev<span class=w> </span>libcap-dev<span class=w> </span>json-c-dev<span class=w> </span>krb5-dev<span class=w> </span>protobuf-c-dev<span class=w> </span>fstrm-dev<span class=w> </span><span class=se>\</span>
<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apk<span class=w> </span>add<span class=w> </span>--update<span class=w> </span>--no-cache<span class=w> </span><span class=nb>bind</span><span class=w> </span>libcrypto1.1<span class=w> </span><span class=se>\</span>
<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>wget<span class=w> </span>https://www.dns-oarc.net/files/dnsperf/<span class=nv>$DNSPERF</span>.tar.gz<span class=w> </span><span class=se>\</span>
<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>zxvf<span class=w> </span><span class=nv>$DNSPERF</span>.tar.gz<span class=w> </span><span class=se>\</span>
<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span><span class=nv>$DNSPERF</span><span class=w> </span><span class=se>\</span>
<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>sh<span class=w> </span>configure<span class=w> </span><span class=se>\</span>
<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w> </span><span class=se>\</span>
<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>strip<span class=w> </span>./src/dnsperf<span class=w> </span>./src/resperf<span class=w> </span><span class=se>\</span>
<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w> </span>install
</code></pre></div></p> <div class=highlight><pre><span></span><code><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;kube-dns.kube-system.svc.cluster.local A&quot;</span><span class=w> </span>&gt;<span class=w> </span>records.txt
<span class=nb>echo</span><span class=w> </span><span class=s2>&quot;echoserver.ops.svc.cluster.local A&quot;</span><span class=w> </span>&gt;<span class=w> </span>records.txt
</code></pre></div> <div class=highlight><pre><span></span><code>dnsperf<span class=w> </span>-l<span class=w> </span><span class=m>10</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-s<span class=w> </span><span class=m>10</span>.140.0.53<span class=w> </span><span class=se>\</span>
<span class=w>        </span>-T<span class=w> </span><span class=m>20</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-c<span class=w> </span><span class=m>20</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-q<span class=w> </span><span class=m>10000</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-Q<span class=w> </span><span class=m>10000</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-S<span class=w> </span><span class=m>5</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-d<span class=w> </span>records.txt

dnsperf<span class=w> </span>-l<span class=w> </span><span class=m>10</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-T<span class=w> </span><span class=m>20</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-c<span class=w> </span><span class=m>20</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-q<span class=w> </span><span class=m>10000</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-Q<span class=w> </span><span class=m>10000</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-S<span class=w> </span><span class=m>5</span><span class=w> </span><span class=se>\</span>
<span class=w>        </span>-d<span class=w> </span>records.txt
</code></pre></div> <div class=highlight><pre><span></span><code>  -l run for at most this many seconds
  -s the server
  -T the number of threads to run
  -c the number of clients to act as to query (default: 127.0.0.1)
  -q the maximum number of queries outstanding (default: 100)
  -Q limit the number of queries per second
  -S print qps statistics every N seconds
  -d the input data file (default: stdin)
</code></pre></div> <h2 id=2020-03-03>2020-03-03<a class=headerlink href=#2020-03-03 title="Permanent link">&para;</a></h2> <h3 id=open-google-chrome-browser-in-mac-terminal>Open Google Chrome browser in Mac terminal<a class=headerlink href=#open-google-chrome-browser-in-mac-terminal title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>open<span class=w> </span>-a<span class=w> </span><span class=s2>&quot;Google Chrome&quot;</span><span class=w> </span><span class=s2>&quot;http://localhost:5601&quot;</span>
</code></pre></div> <h2 id=2020-03-02>2020-03-02<a class=headerlink href=#2020-03-02 title="Permanent link">&para;</a></h2> <h3 id=create-a-temporary-pod-to-debug-and-kill-itself-after-an-hour>Create a temporary pod to debug and kill itself after an hour<a class=headerlink href=#create-a-temporary-pod-to-debug-and-kill-itself-after-an-hour title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">busybox1</span>
<span class=w>  </span><span class=nt>labels</span><span class=p>:</span>
<span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">busybox1</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>containers</span><span class=p>:</span>
<span class=w>  </span><span class=c1># - image: busybox</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">alpine:3.11</span>
<span class=w>    </span><span class=nt>command</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">sleep</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;3600&quot;</span>
<span class=w>    </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class=w>  </span><span class=nt>restartPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Never</span>
</code></pre></div> <h3 id=dns-load-testing-in-alpine>DNS load testing in Alpine<a class=headerlink href=#dns-load-testing-in-alpine title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>apk<span class=w> </span>add<span class=w> </span>gcc<span class=w> </span>g++<span class=w> </span>make<span class=w> </span>libffi-dev<span class=w> </span>openssl-dev<span class=w> </span>git
git<span class=w> </span>clone<span class=w> </span>https://github.com/jedisct1/dnsblast.git
<span class=nb>cd</span><span class=w> </span>dnsblast<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>make
<span class=c1>#./dnsblast [host] [times] [request per second]</span>
./dnsblast<span class=w> </span>kube-dns.kube-system<span class=w> </span><span class=m>10000</span><span class=w> </span><span class=m>1000</span>
./dnsblast<span class=w> </span><span class=m>127</span>.0.0.1<span class=w> </span><span class=m>10000</span><span class=w> </span><span class=m>1000</span>
</code></pre></div> <ul> <li>The command above will break kube-dns.</li> <li>There are 5 kube-dns pods, but only one is receiving request.<ul> <li>Caused by iptable and UDP.</li> </ul> </li> </ul> <div class=highlight><pre><span></span><code>dnsmasq<span class=w> </span>I0302<span class=w> </span><span class=m>08</span>:47:01.002440<span class=w>       </span><span class=m>1</span><span class=w> </span>nanny.go:146<span class=o>[]</span><span class=w> </span>dnsmasq<span class=o>[</span><span class=m>23</span><span class=o>]</span>:<span class=w> </span>Maximum<span class=w> </span>number<span class=w> </span>of<span class=w> </span>concurrent<span class=w> </span>DNS<span class=w> </span>queries<span class=w> </span>reached<span class=w> </span><span class=o>(</span>max:<span class=w> </span><span class=m>1500</span><span class=o>)</span>
sidecar<span class=w> </span>W0302<span class=w> </span><span class=m>08</span>:47:01.248582<span class=w>       </span><span class=m>1</span><span class=w> </span>server.go:64<span class=o>[]</span><span class=w> </span>Error<span class=w> </span>getting<span class=w> </span>metrics<span class=w> </span>from<span class=w> </span>dnsmasq:<span class=w> </span><span class=nb>read</span><span class=w> </span>udp<span class=w> </span><span class=m>127</span>.0.0.1:37986-&gt;127.0.0.1:53:<span class=w> </span>i/o<span class=w> </span>timeout
</code></pre></div> <h3 id=gke-v113x-uses-kube-dns-rather-than-core-dns>GKE v1.13.x uses kube-dns rather than core-dns.<a class=headerlink href=#gke-v113x-uses-kube-dns-rather-than-core-dns title="Permanent link">&para;</a></h3> <p>ref: <a href=https://cloud.google.com/kubernetes-engine/docs/release-notes#new_features_6>https://cloud.google.com/kubernetes-engine/docs/release-notes#new_features_6</a></p> <p>GKE is using kube- rather than core-dns. No idea why they are doing this.</p> <h3 id=install-gcc-compiler-in-alpine>Install gcc compiler in Alpine<a class=headerlink href=#install-gcc-compiler-in-alpine title="Permanent link">&para;</a></h3> <p>ref: <a href=https://github.com/nange/blog/issues/3>https://github.com/nange/blog/issues/3</a> <div class=highlight><pre><span></span><code>apk<span class=w> </span>add<span class=w> </span>gcc<span class=w> </span>g++<span class=w> </span>make<span class=w> </span>libffi-dev<span class=w> </span>openssl-dev
</code></pre></div></p> <h3 id=echo-n>echo -n<a class=headerlink href=#echo-n title="Permanent link">&para;</a></h3> <p><a href=https://linux.die.net/man/1/echo>https://linux.die.net/man/1/echo</a> <div class=highlight><pre><span></span><code>-n
<span class=k>do</span><span class=w> </span>not<span class=w> </span>output<span class=w> </span>the<span class=w> </span>trailing<span class=w> </span>newline
</code></pre></div></p> <h2 id=2020-02-27>2020-02-27<a class=headerlink href=#2020-02-27 title="Permanent link">&para;</a></h2> <h3 id=get-github-user-info>Get GitHub user info<a class=headerlink href=#get-github-user-info title="Permanent link">&para;</a></h3> <p><a href=https://developer.github.com/v3/#authentication>https://developer.github.com/v3/#authentication</a> <div class=highlight><pre><span></span><code>curl<span class=w> </span>-u<span class=w> </span><span class=s2>&quot;username&quot;</span><span class=w> </span>https://api.github.com/user
curl<span class=w> </span>-H<span class=w> </span><span class=s2>&quot;Authorization: token </span><span class=nv>$PAT</span><span class=s2>&quot;</span><span class=w> </span>https://api.github.com/user
</code></pre></div></p> <h2 id=2020-02-26>2020-02-26<a class=headerlink href=#2020-02-26 title="Permanent link">&para;</a></h2> <h3 id=use-cloudflare-warp-as-vpn-on-macpc>Use CloudFlare WARP as VPN on Mac/PC<a class=headerlink href=#use-cloudflare-warp-as-vpn-on-macpc title="Permanent link">&para;</a></h3> <p><a href="https://community.cloudflare.com/t/tutorial-how-to-use-cloudflare-warp-on-your-mac/129919?fbclid=IwAR3OlvJrv2EW3KoH3GlDA-gURM5BgPKiaP5RDjjlgBHyYpKWbryZzbrPDGw">https://community.cloudflare.com/t/tutorial-how-to-use-cloudflare-warp-on-your-mac/129919?fbclid=IwAR3OlvJrv2EW3KoH3GlDA-gURM5BgPKiaP5RDjjlgBHyYpKWbryZzbrPDGw</a></p> <p>WARP (CloudFlare VPN) is made from Wireguard. Therefore we can generate a Wirrguard config from CloudFlare and use it on PC.</p> <h3 id=refreshclean-cdn-cache-on-tencent-cloud>Refresh/Clean CDN cache on Tencent Cloud<a class=headerlink href=#refreshclean-cdn-cache-on-tencent-cloud title="Permanent link">&para;</a></h3> <p><a href=https://console.cloud.tencent.com/cdn/refresh>https://console.cloud.tencent.com/cdn/refresh</a></p> <p>Just type what url you want to refresh.</p> <h3 id=you-might-have-to-verify-by-doing-a-request-from-a-location-with-a-cloudflare-edge>You might have to verify by doing a request from a location with a Cloudflare edge<a class=headerlink href=#you-might-have-to-verify-by-doing-a-request-from-a-location-with-a-cloudflare-edge title="Permanent link">&para;</a></h3> <p>I tested it on <a href=https://tools.pingdom.com/ >https://tools.pingdom.com/</a></p> <ul> <li>test in Tokyo</li> <li>CloudFlare/Google CDN both have edges</li> <li>GCS hosting need more DNS time: 40 ms</li> </ul> <h2 id=2020-02-24>2020-02-24<a class=headerlink href=#2020-02-24 title="Permanent link">&para;</a></h2> <h3 id=cloudflare-worker-cant-resovlefind-domain>CloudFlare worker - Can't resovle/find domain<a class=headerlink href=#cloudflare-worker-cant-resovlefind-domain title="Permanent link">&para;</a></h3> <p>Need to manully add this record to route worker. ref: <a href=https://community.cloudflare.com/t/a-record-name-for-worker/98841>https://community.cloudflare.com/t/a-record-name-for-worker/98841</a></p> <div class="admonition solution"> <p class=admonition-title>Solution</p> <p>Add an A record to 192.0.2.1</p> </div> <h3 id=cloudflare-worker-how-to-handle-spa>CloudFlare worker - how to handle SPA<a class=headerlink href=#cloudflare-worker-how-to-handle-spa title="Permanent link">&para;</a></h3> <p>I found there's 404 when I tried to refresh in other page like /faq.</p> <p>ref: <a href=https://stackoverflow.com/questions/58432345/cloudflare-workers-spa-with-vuejs>https://stackoverflow.com/questions/58432345/cloudflare-workers-spa-with-vuejs</a> <div class=highlight><pre><span></span><code><span class=nx>options</span><span class=p>.</span><span class=nx>mapRequestToAsset</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>req</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// First let&#39;s apply the default handler, which we imported from</span>
<span class=w>    </span><span class=c1>// &#39;@cloudflare/kv-asset-handler&#39; at the top of the file. We do</span>
<span class=w>    </span><span class=c1>// this because the default handler already has logic to detect</span>
<span class=w>    </span><span class=c1>// paths that should map to HTML files, for which it appends</span>
<span class=w>    </span><span class=c1>// `/index.html` to the path.</span>
<span class=w>    </span><span class=nx>req</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>mapRequestToAsset</span><span class=p>(</span><span class=nx>req</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Now we can detect if the default handler decided to map to</span>
<span class=w>    </span><span class=c1>// index.html in some specific directory.</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>url</span><span class=p>.</span><span class=nx>endsWith</span><span class=p>(</span><span class=s1>&#39;/index.html&#39;</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=c1>// Indeed. Let&#39;s change it to instead map to the root `/index.html`.</span>
<span class=w>      </span><span class=c1>// This avoids the need to do a redundant lookup that we know will</span>
<span class=w>      </span><span class=c1>// fail.</span>
<span class=w>      </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>Request</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=ow>new</span><span class=w> </span><span class=nx>URL</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>url</span><span class=p>).</span><span class=nx>origin</span><span class=si>}</span><span class=sb>/index.html`</span><span class=p>,</span><span class=w> </span><span class=nx>req</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=c1>// The default handler decided this is not an HTML page. It&#39;s probably</span>
<span class=w>      </span><span class=c1>// an image, CSS, or JS file. Leave it as-is.</span>
<span class=w>      </span><span class=k>return</span><span class=w> </span><span class=nx>req</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
</code></pre></div></p> <h2 id=2020-02-21>2020-02-21<a class=headerlink href=#2020-02-21 title="Permanent link">&para;</a></h2> <h3 id=multiple-static-ip-in-a-load-balancer>Multiple static IP in a load balancer<a class=headerlink href=#multiple-static-ip-in-a-load-balancer title="Permanent link">&para;</a></h3> <p>Steps:</p> <ol> <li>Manual create ip addresses.</li> <li>Assign ip addresses to load balancer frontend</li> <li>Use <code>externalIPs</code> instead of <code>loadBalancerIP</code> <div class=highlight><pre><span></span><code><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dnsmasq</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>selector</span><span class=p>:</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dnsmasq</span>
<span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
<span class=hll><span class=w>  </span><span class=nt>externalIPs</span><span class=p>:</span>
</span><span class=hll><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">a.a.a.a</span>
</span><span class=hll><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">a.a.a.b</span>
</span><span class=w>  </span><span class=nt>ports</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dnsmasq-udp</span>
<span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">53</span>
<span class=w>    </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">UDP</span>
<span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dnsmasq-udp</span>
<span class=hll><span class=w>  </span><span class=c1># loadBalancerIP: a.a.a.a</span>
</span></code></pre></div></li> </ol> <h3 id=testing-hpa-high-memory>Testing HPA high memory<a class=headerlink href=#testing-hpa-high-memory title="Permanent link">&para;</a></h3> <p>ref: <a href=https://github.com/feiskyer/kubernetes-handbook/blob/master/examples/hpa-memory.yaml>https://github.com/feiskyer/kubernetes-handbook/blob/master/examples/hpa-memory.yaml</a></p> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling/v2beta1</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">HorizontalPodAutoscaler</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">nginx-hpa</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>scaleTargetRef</span><span class=p>:</span>
<span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">extensions/v1beta1</span>
<span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dnsmasq</span>
<span class=w>  </span><span class=nt>minReplicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class=w>  </span><span class=nt>maxReplicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class=w>  </span><span class=nt>metrics</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Resource</span>
<span class=w>    </span><span class=nt>resource</span><span class=p>:</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">memory</span>
<span class=w>      </span><span class=nt>targetAverageUtilization</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</code></pre></div> <p>and get in a container <div class=highlight><pre><span></span><code>$<span class=w> </span>kubectl<span class=w> </span><span class=nb>exec</span><span class=w> </span>-it<span class=w> </span>dnsmasq-5964d6fdc-2ktt8<span class=w> </span>sh
</code></pre></div></p> <p>generate high memory usage <div class=highlight><pre><span></span><code>$<span class=w> </span>yes<span class=w> </span><span class=p>|</span><span class=w> </span>tr<span class=w> </span><span class=se>\\</span>n<span class=w> </span>x<span class=w> </span><span class=p>|</span><span class=w> </span>head<span class=w> </span>-c<span class=w> </span>100m<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>n
</code></pre></div></p> <h3 id=about-kubernetes-hpahorizontal-pod-autoscaler>About Kubernetes HPA(Horizontal Pod Autoscaler)<a class=headerlink href=#about-kubernetes-hpahorizontal-pod-autoscaler title="Permanent link">&para;</a></h3> <p>ref: <a href=https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale>https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale</a></p> <ul> <li>desiredReplicas = ceil[currentReplicas * ( currentMetricValue / desiredMetricValue )]</li> <li><a href=https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/#how-does-the-horizontal-pod-autoscaler-work>每 15 秒檢查一次</a></li> <li><a href=https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/#support-for-cooldown-delay>預設 downscale: 5m</a></li> </ul> <h2 id=2020-02-19>2020-02-19<a class=headerlink href=#2020-02-19 title="Permanent link">&para;</a></h2> <h3 id=use-environment-from-parent-process-in-nginxopenresty>Use environment from parent process in Nginx(OpenResty)<a class=headerlink href=#use-environment-from-parent-process-in-nginxopenresty title="Permanent link">&para;</a></h3> <p>在 nginx 讀取環境變數的正確方法:</p> <ul> <li>先在 root block export 變數</li> <li>使用 lua <code>os.getenv("MY_ENV"))</code> <div class=highlight><pre><span></span><code>env MY_ENV;
env PATH;
http {
    server {
        location / {
            content_by_lua_block {
                ngx.say(os.getenv(&quot;MY_ENV&quot;));
                ngx.say(os.getenv(&quot;PATH&quot;));
            }
        }
    }
}
</code></pre></div></li> </ul> <h3 id=cannot-create-an-external-load-balancer-with-mix-protocols>cannot create an external load balancer with mix protocols<a class=headerlink href=#cannot-create-an-external-load-balancer-with-mix-protocols title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>The<span class=w> </span>Service<span class=w> </span><span class=s2>&quot;dnsmasq&quot;</span><span class=w> </span>is<span class=w> </span>invalid:<span class=w> </span>spec.ports:<span class=w> </span>Invalid<span class=w> </span>value:<span class=w> </span><span class=o>[]</span>core.ServicePort<span class=o>{</span>core.ServicePort<span class=o>{</span>Name:<span class=s2>&quot;dnsmasq&quot;</span>,<span class=w> </span>Protocol:<span class=s2>&quot;TCP&quot;</span>,<span class=w> </span>Port:53,<span class=w> </span>TargetPort:intstr.IntOrString<span class=o>{</span>Type:1,<span class=w> </span>IntVal:0,<span class=w> </span>StrVal:<span class=s2>&quot;dnsmasq&quot;</span><span class=o>}</span>,<span class=w> </span>NodePort:0<span class=o>}</span>,<span class=w> </span>core.ServicePort<span class=o>{</span>Name:<span class=s2>&quot;dnsmasq-udp&quot;</span>,<span class=w> </span>Protocol:<span class=s2>&quot;UDP&quot;</span>,<span class=w> </span>Port:53,<span class=w> </span>TargetPort:intstr.IntOrString<span class=o>{</span>Type:1,<span class=w> </span>IntVal:0,<span class=w> </span>StrVal:<span class=s2>&quot;dnsmasq-udp&quot;</span><span class=o>}</span>,<span class=w> </span>NodePort:0<span class=o>}}</span>:<span class=w> </span>cannot<span class=w> </span>create<span class=w> </span>an<span class=w> </span>external<span class=w> </span>load<span class=w> </span>balancer<span class=w> </span>with<span class=w> </span>mix<span class=w> </span>protocols
</code></pre></div> <h2 id=2020-02-18>2020-02-18<a class=headerlink href=#2020-02-18 title="Permanent link">&para;</a></h2> <h3 id=try-docker-compose-health-check>Try docker-compose health check<a class=headerlink href=#try-docker-compose-health-check title="Permanent link">&para;</a></h3> <p><a href=https://github.com/peter-evans/docker-compose-healthcheck>https://github.com/peter-evans/docker-compose-healthcheck</a> <div class=highlight><pre><span></span><code>healthcheck:
  test: [&quot;CMD-SHELL&quot;, &quot;pg_isready -U postgres&quot;]
  interval: 10s
  timeout: 5s
  retries: 5
</code></pre></div></p> <h3 id=docker-docker-credential-osxkeychain-ci-db>Docker 更新後跳出 docker-credential-osxkeychain 想使用鑰匙圈 ci-db<a class=headerlink href=#docker-docker-credential-osxkeychain-ci-db title="Permanent link">&para;</a></h3> <p><a href=https://github.com/docker/for-mac/issues/3805#issuecomment-518619953>https://github.com/docker/for-mac/issues/3805#issuecomment-518619953</a></p> <div class="admonition solution"> <p class=admonition-title>Solution</p> <p>Open <code>~/.docker/config.json</code></p> <p>Set <code>"credsStore":""</code></p> </div> <h3 id=how-to-use-cc-by-sa-license>How to use cc-by-sa license<a class=headerlink href=#how-to-use-cc-by-sa-license title="Permanent link">&para;</a></h3> <ul> <li> <p>Plain text: <a href=https://creativecommons.org/licenses/by-sa/4.0/legalcode.txt>https://creativecommons.org/licenses/by-sa/4.0/legalcode.txt</a></p> </li> <li> <p>Image: <a href=http://creativecommons.org/licenses/by-sa/4.0/ ><img alt src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png></a> <div class=highlight><pre><span></span><code>&lt;a rel=&quot;license&quot; href=&quot;http://creativecommons.org/licenses/by-sa/4.0/&quot;&gt;&lt;img alt=&quot;Creative Commons License&quot; style=&quot;border-width:0&quot; src=&quot;https://i.creativecommons.org/l/by-sa/4.0/88x31.png&quot; /&gt;&lt;/a&gt;
</code></pre></div> <div class=highlight><pre><span></span><code>[![](https://i.creativecommons.org/l/by-sa/4.0/88x31.png)](http://creativecommons.org/licenses/by-sa/4.0/)
</code></pre></div></p> </li> </ul> <h3 id=print-a-colorful-text-in-terminal>Print a colorful text in terminal<a class=headerlink href=#print-a-colorful-text-in-terminal title="Permanent link">&para;</a></h3> <p><a href=../../snippets/bash#ansi->ANSI - 輸出文字變色</a> <div class=highlight><pre><span></span><code><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;\e[1;31mHello\e[0m World&quot;</span>
</code></pre></div></p> <h3 id=render-a-chart-inside-markdown-with-canvasjs>Render a chart inside markdown with canvasjs<a class=headerlink href=#render-a-chart-inside-markdown-with-canvasjs title="Permanent link">&para;</a></h3> <script>
window.onload = function () {

  var limit = 50000;
  var y = 100;
  var data = [];
  var dataSeries = { type: "line" };
  var dataPoints = [];
  for (var i = 0; i < limit; i += 1) {
    y += Math.round(Math.random() * 10 - 5);
    dataPoints.push({
      x: i,
      y: y
    });
  }
  dataSeries.dataPoints = dataPoints;
  data.push(dataSeries);

  //Better to construct options first and then pass it as a parameter
  var options = {
    zoomEnabled: true,
    animationEnabled: true,
    title: {
      text: "Try Zooming - Panning"
    },
    axisY: {
      includeZero: false,
      lineThickness: 1
    },
    data: data  // random data
  };

  var chart = new CanvasJS.Chart("chartContainer", options);
  chart.render();
}
</script> <div id=chartContainer style="height: 370px; width: 100%;"></div> <script src=https://canvasjs.com/assets/script/canvasjs.min.js></script> <h2 id=2020-02-15>2020-02-15<a class=headerlink href=#2020-02-15 title="Permanent link">&para;</a></h2> <h3 id=restart-a-kubernetes-resource-without-down-time-and-using-same-configyaml>Restart a kubernetes resource without down time and using same config(yaml)<a class=headerlink href=#restart-a-kubernetes-resource-without-down-time-and-using-same-configyaml title="Permanent link">&para;</a></h3> <p>Kubernetes &gt;= 1.15</p> <p>ref: <a href=https://github.com/kubernetes/kubernetes/issues/33664#issuecomment-497242094>https://github.com/kubernetes/kubernetes/issues/33664#issuecomment-497242094</a></p> <p>Gracefully rolling restart deployment. <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>rollout<span class=w> </span>restart<span class=w> </span>deployment/my-sites<span class=w> </span>--namespace<span class=o>=</span>default
</code></pre></div></p> <h3 id=run-commnad-withoutignoring-output>Run commnad without(ignoring) output<a class=headerlink href=#run-commnad-withoutignoring-output title="Permanent link">&para;</a></h3> <p><a href=https://askubuntu.com/questions/474556/hiding-output-of-a-command>https://askubuntu.com/questions/474556/hiding-output-of-a-command</a></p> <div class=highlight><pre><span></span><code><span class=nb>command</span><span class=w> </span>&gt;<span class=w> </span>/dev/null<span class=w> </span><span class=m>2</span>&gt;<span class=p>&amp;</span><span class=m>1</span>
<span class=nb>command</span><span class=w> </span>&gt;<span class=p>&amp;</span><span class=w> </span>/dev/null
</code></pre></div> <p>Example: Still show errors when command failed. <div class=highlight><pre><span></span><code>$<span class=w> </span>edho<span class=w> </span>hi<span class=w> </span>&gt;<span class=w> </span>/dev/null
zsh:<span class=w> </span><span class=nb>command</span><span class=w> </span>not<span class=w> </span>found:<span class=w> </span>edho
</code></pre></div> Don't show error even when command failed. <div class=highlight><pre><span></span><code>$<span class=w> </span>edho<span class=w> </span>hi<span class=w> </span>&gt;<span class=p>&amp;</span><span class=w> </span>/dev/null
</code></pre></div></p> <h2 id=2020-02-13>2020-02-13<a class=headerlink href=#2020-02-13 title="Permanent link">&para;</a></h2> <h3 id=docker-compose>在 docker-compose 中的容器互相溝通<a class=headerlink href=#docker-compose title="Permanent link">&para;</a></h3> <p>service name 會被綁到 DNS，可以直接使用 service name 當作 host</p> <div class=highlight><pre><span></span><code><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s>&#39;3&#39;</span>
<span class=nt>services</span><span class=p>:</span>
<span class=w>  </span><span class=nt>redis</span><span class=p>:</span>
<span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s>&quot;redis:alpine&quot;</span>
<span class=w>    </span><span class=nt>ports</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;6379:6379&quot;</span>
<span class=w>  </span><span class=nt>celery</span><span class=p>:</span>
<span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s>&quot;celery:4.0.2&quot;</span>
<span class=w>    </span><span class=nt>environment</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CELERY_BROKER_URL=redis://redis</span>
<span class=w>  </span><span class=nt>celery-2</span><span class=p>:</span>
<span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s>&quot;celery:4.0.2&quot;</span>
<span class=w>    </span><span class=nt>environment</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CELERY_BROKER_URL=redis://redis</span>
</code></pre></div> <div class=highlight><pre><span></span><code>$<span class=w> </span>docker<span class=w> </span>network<span class=w> </span>ls
NETWORK<span class=w> </span>ID<span class=w>          </span>NAME<span class=w>                        </span>DRIVER<span class=w>              </span>SCOPE
01681ec52fea<span class=w>        </span>celery_default<span class=w>              </span>bridge<span class=w>              </span><span class=nb>local</span>
</code></pre></div> <div class=highlight><pre><span></span><code>$<span class=w> </span>docker<span class=w> </span><span class=nb>exec</span><span class=w> </span>-it<span class=w> </span>celery_celery_1<span class=w> </span>bash
user@dcd8cf4a9d04:~$<span class=w> </span>ping<span class=w> </span>celery-2
PING<span class=w> </span>celery-2<span class=w> </span><span class=o>(</span><span class=m>192</span>.168.0.4<span class=o>)</span>:<span class=w> </span><span class=m>56</span><span class=w> </span>data<span class=w> </span>bytes
<span class=m>64</span><span class=w> </span>bytes<span class=w> </span>from<span class=w> </span><span class=m>192</span>.168.0.4:<span class=w> </span><span class=nv>icmp_seq</span><span class=o>=</span><span class=m>0</span><span class=w> </span><span class=nv>ttl</span><span class=o>=</span><span class=m>64</span><span class=w> </span><span class=nv>time</span><span class=o>=</span><span class=m>0</span>.162<span class=w> </span>ms
<span class=m>64</span><span class=w> </span>bytes<span class=w> </span>from<span class=w> </span><span class=m>192</span>.168.0.4:<span class=w> </span><span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span><span class=w> </span><span class=nv>ttl</span><span class=o>=</span><span class=m>64</span><span class=w> </span><span class=nv>time</span><span class=o>=</span><span class=m>0</span>.223<span class=w> </span>ms
^C---<span class=w> </span>celery-2<span class=w> </span>ping<span class=w> </span>statistics<span class=w> </span>---
<span class=m>2</span><span class=w> </span>packets<span class=w> </span>transmitted,<span class=w> </span><span class=m>2</span><span class=w> </span>packets<span class=w> </span>received,<span class=w> </span><span class=m>0</span>%<span class=w> </span>packet<span class=w> </span>loss
round-trip<span class=w> </span>min/avg/max/stddev<span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0</span>.162/0.193/0.223/0.031<span class=w> </span>ms
user@dcd8cf4a9d04:~$<span class=w> </span>ping<span class=w> </span>celery-3
ping:<span class=w> </span>unknown<span class=w> </span>host
</code></pre></div> <h3 id=mkdocs-minify-html-got-error>mkdocs minify html got error<a class=headerlink href=#mkdocs-minify-html-got-error title="Permanent link">&para;</a></h3> <p>mkdocs.yaml <div class=highlight><pre><span></span><code><span class=nt>plugins</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>minify</span><span class=p>:</span>
<span class=w>      </span><span class=nt>minify_html</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div></p> <div class="admonition bug"> <p class=admonition-title>Bug</p> <div class=highlight><pre><span></span><code><span class=w>    </span>print<span class=w> </span><span class=s2>&quot;htmlmin option &quot;</span><span class=w> </span>+<span class=w> </span>key<span class=w> </span>+<span class=w> </span><span class=s2>&quot; not recognized&quot;</span>
<span class=w>                        </span>^
SyntaxError:<span class=w> </span>Missing<span class=w> </span>parentheses<span class=w> </span><span class=k>in</span><span class=w> </span>call<span class=w> </span>to<span class=w> </span><span class=s1>&#39;print&#39;</span>.<span class=w> </span>Did<span class=w> </span>you<span class=w> </span>mean<span class=w> </span>print<span class=o>(</span><span class=s2>&quot;htmlmin option &quot;</span><span class=w> </span>+<span class=w> </span>key<span class=w> </span>+<span class=w> </span><span class=s2>&quot; not recognized&quot;</span><span class=o>)</span>?
</code></pre></div> </div> <div class="admonition solution"> <p class=admonition-title>Solution</p> <p>ref: <a href=https://github.com/byrnereese/mkdocs-minify-plugin/issues/8>https://github.com/byrnereese/mkdocs-minify-plugin/issues/8</a></p> <p>Upgrade mkdocs-minify-plugin&gt;= <mark>0.2.3</mark></p> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 8, 2024</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 8, 2024</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> <a href=http://creativecommons.org/licenses/by-nc-nd/4.0/ rel=license><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png></a> <br> Copyright © 2015- Rammus Xu </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/rammusxu target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://www.linkedin.com/in/rammusxu target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.fe8b6f2b.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../javascripts/tablesort.js></script> </body> </html>